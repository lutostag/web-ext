{"version":3,"sources":["webpack:///webpack/bootstrap b2039aba1e9b0c1b8d38","webpack:///./tests/unit/runner.js","webpack:///external \"babel-polyfill\"","webpack:///./tests/unit .*","webpack:///./tests/unit/test-cmd/test.build.js","webpack:///external \"path\"","webpack:///external \"mz\"","webpack:///external \"mocha\"","webpack:///external \"chai\"","webpack:///external \"sinon\"","webpack:///./src/cmd/build.js","webpack:///./~/babel-runtime/regenerator/index.js","webpack:///external \"regenerator-runtime\"","webpack:///./~/babel-runtime/helpers/asyncToGenerator.js","webpack:///./~/babel-runtime/core-js/promise.js","webpack:///./~/core-js/library/fn/promise.js","webpack:///./~/core-js/library/modules/es6.string.iterator.js","webpack:///./~/core-js/library/modules/_string-at.js","webpack:///./~/core-js/library/modules/_to-integer.js","webpack:///./~/core-js/library/modules/_defined.js","webpack:///./~/core-js/library/modules/_iter-define.js","webpack:///./~/core-js/library/modules/_library.js","webpack:///./~/core-js/library/modules/_export.js","webpack:///./~/core-js/library/modules/_global.js","webpack:///./~/core-js/library/modules/_core.js","webpack:///./~/core-js/library/modules/_ctx.js","webpack:///./~/core-js/library/modules/_a-function.js","webpack:///./~/core-js/library/modules/_hide.js","webpack:///./~/core-js/library/modules/_object-dp.js","webpack:///./~/core-js/library/modules/_an-object.js","webpack:///./~/core-js/library/modules/_is-object.js","webpack:///./~/core-js/library/modules/_ie8-dom-define.js","webpack:///./~/core-js/library/modules/_descriptors.js","webpack:///./~/core-js/library/modules/_fails.js","webpack:///./~/core-js/library/modules/_dom-create.js","webpack:///./~/core-js/library/modules/_to-primitive.js","webpack:///./~/core-js/library/modules/_property-desc.js","webpack:///./~/core-js/library/modules/_redefine.js","webpack:///./~/core-js/library/modules/_has.js","webpack:///./~/core-js/library/modules/_iterators.js","webpack:///./~/core-js/library/modules/_iter-create.js","webpack:///./~/core-js/library/modules/_object-create.js","webpack:///./~/core-js/library/modules/_object-dps.js","webpack:///./~/core-js/library/modules/_object-keys.js","webpack:///./~/core-js/library/modules/_object-keys-internal.js","webpack:///./~/core-js/library/modules/_to-iobject.js","webpack:///./~/core-js/library/modules/_iobject.js","webpack:///./~/core-js/library/modules/_cof.js","webpack:///./~/core-js/library/modules/_array-includes.js","webpack:///./~/core-js/library/modules/_to-length.js","webpack:///./~/core-js/library/modules/_to-index.js","webpack:///./~/core-js/library/modules/_shared-key.js","webpack:///./~/core-js/library/modules/_shared.js","webpack:///./~/core-js/library/modules/_uid.js","webpack:///./~/core-js/library/modules/_enum-bug-keys.js","webpack:///./~/core-js/library/modules/_html.js","webpack:///./~/core-js/library/modules/_set-to-string-tag.js","webpack:///./~/core-js/library/modules/_wks.js","webpack:///./~/core-js/library/modules/_object-gpo.js","webpack:///./~/core-js/library/modules/_to-object.js","webpack:///./~/core-js/library/modules/web.dom.iterable.js","webpack:///./~/core-js/library/modules/es6.array.iterator.js","webpack:///./~/core-js/library/modules/_add-to-unscopables.js","webpack:///./~/core-js/library/modules/_iter-step.js","webpack:///./~/core-js/library/modules/es6.promise.js","webpack:///./~/core-js/library/modules/_classof.js","webpack:///./~/core-js/library/modules/_an-instance.js","webpack:///./~/core-js/library/modules/_for-of.js","webpack:///./~/core-js/library/modules/_iter-call.js","webpack:///./~/core-js/library/modules/_is-array-iter.js","webpack:///./~/core-js/library/modules/core.get-iterator-method.js","webpack:///./~/core-js/library/modules/_species-constructor.js","webpack:///./~/core-js/library/modules/_task.js","webpack:///./~/core-js/library/modules/_invoke.js","webpack:///./~/core-js/library/modules/_microtask.js","webpack:///./~/core-js/library/modules/_redefine-all.js","webpack:///./~/core-js/library/modules/_set-species.js","webpack:///./~/core-js/library/modules/_iter-detect.js","webpack:///external \"fs\"","webpack:///external \"parse-json\"","webpack:///external \"event-to-promise\"","webpack:///./src/watcher.js","webpack:///external \"watchpack\"","webpack:///external \"debounce\"","webpack:///./src/util/logger.js","webpack:///./~/babel-runtime/helpers/classCallCheck.js","webpack:///./~/babel-runtime/helpers/createClass.js","webpack:///./~/babel-runtime/core-js/object/define-property.js","webpack:///./~/core-js/library/fn/object/define-property.js","webpack:///./~/core-js/library/modules/es6.object.define-property.js","webpack:///external \"bunyan\"","webpack:///./src/util/zip-dir.js","webpack:///external \"zip-dir\"","webpack:///external \"es6-promisify\"","webpack:///./src/util/manifest.js","webpack:///./src/errors.js","webpack:///./~/babel-runtime/helpers/possibleConstructorReturn.js","webpack:///./~/babel-runtime/helpers/typeof.js","webpack:///./~/babel-runtime/core-js/symbol/iterator.js","webpack:///./~/core-js/library/fn/symbol/iterator.js","webpack:///./~/core-js/library/modules/_wks-ext.js","webpack:///./~/babel-runtime/core-js/symbol.js","webpack:///./~/core-js/library/fn/symbol/index.js","webpack:///./~/core-js/library/modules/es6.symbol.js","webpack:///./~/core-js/library/modules/_meta.js","webpack:///./~/core-js/library/modules/_wks-define.js","webpack:///./~/core-js/library/modules/_keyof.js","webpack:///./~/core-js/library/modules/_enum-keys.js","webpack:///./~/core-js/library/modules/_object-gops.js","webpack:///./~/core-js/library/modules/_object-pie.js","webpack:///./~/core-js/library/modules/_is-array.js","webpack:///./~/core-js/library/modules/_object-gopn-ext.js","webpack:///./~/core-js/library/modules/_object-gopn.js","webpack:///./~/core-js/library/modules/_object-gopd.js","webpack:///./~/core-js/library/modules/es7.symbol.async-iterator.js","webpack:///./~/core-js/library/modules/es7.symbol.observable.js","webpack:///./~/babel-runtime/helpers/inherits.js","webpack:///./~/babel-runtime/core-js/object/set-prototype-of.js","webpack:///./~/core-js/library/fn/object/set-prototype-of.js","webpack:///./~/core-js/library/modules/es6.object.set-prototype-of.js","webpack:///./~/core-js/library/modules/_set-proto.js","webpack:///./~/babel-runtime/core-js/object/create.js","webpack:///./~/core-js/library/fn/object/create.js","webpack:///./~/core-js/library/modules/es6.object.create.js","webpack:///external \"es6-error\"","webpack:///./src/util/artifacts.js","webpack:///external \"mkdirp\"","webpack:///./src/util/file-filter.js","webpack:///external \"minimatch\"","webpack:///./src/util/temp-dir.js","webpack:///./~/babel-runtime/helpers/slicedToArray.js","webpack:///./~/babel-runtime/core-js/is-iterable.js","webpack:///./~/core-js/library/fn/is-iterable.js","webpack:///./~/core-js/library/modules/core.is-iterable.js","webpack:///./~/babel-runtime/core-js/get-iterator.js","webpack:///./~/core-js/library/fn/get-iterator.js","webpack:///./~/core-js/library/modules/core.get-iterator.js","webpack:///external \"tmp\"","webpack:///./tests/unit/helpers.js","webpack:///external \"yauzl\"","webpack:///./tests/unit/test-util/test.manifest.js","webpack:///external \"deepcopy\"","webpack:///./tests/unit/test-cmd/test.docs.js","webpack:///./src/cmd/docs.js","webpack:///external \"open\"","webpack:///./tests/unit/test-cmd/test.lint.js","webpack:///./~/babel-runtime/helpers/extends.js","webpack:///./~/babel-runtime/core-js/object/assign.js","webpack:///./~/core-js/library/fn/object/assign.js","webpack:///./~/core-js/library/modules/es6.object.assign.js","webpack:///./~/core-js/library/modules/_object-assign.js","webpack:///./src/cmd/lint.js","webpack:///external \"addons-linter\"","webpack:///./tests/unit/test-cmd/test.run.js","webpack:///./~/babel-runtime/helpers/objectWithoutProperties.js","webpack:///external \"events\"","webpack:///./src/cmd/run.js","webpack:///./src/util/desktop-notifier.js","webpack:///external \"node-notifier\"","webpack:///./src/firefox/index.js","webpack:///external \"fx-runner\"","webpack:///external \"firefox-profile\"","webpack:///./src/util/is-directory.js","webpack:///./src/firefox/preferences.js","webpack:///./src/firefox/remote.js","webpack:///external \"node-firefox-connect\"","webpack:///./tests/unit/test-cmd/test.sign.js","webpack:///external \"copy-dir\"","webpack:///./src/cmd/sign.js","webpack:///external \"sign-addon\"","webpack:///./tests/unit/test-firefox/test.firefox.js","webpack:///./tests/unit/test-firefox/test.preferences.js","webpack:///./tests/unit/test-firefox/test.remote.js","webpack:///./tests/unit/test-util/test.artifacts.js","webpack:///./tests/unit/test-util/test.desktop-notifier.js","webpack:///./tests/unit/test-util/test.file-filter.js","webpack:///./tests/unit/test-util/test.is-directory.js","webpack:///./tests/unit/test-util/test.logger.js","webpack:///external \"tty\"","webpack:///./tests/unit/test-util/test.temp-dir.js","webpack:///./tests/unit/test-util/test.updates.js","webpack:///./src/util/updates.js","webpack:///external \"update-notifier\"","webpack:///./tests/unit/test.config.js","webpack:///./src/program.js","webpack:///external \"git-rev-sync\"","webpack:///external \"yargs\"","webpack:///external \"camelcase\"","webpack:///./src/cmd/index.js","webpack:///./src/config.js","webpack:///external \"require-uncached\"","webpack:///external \"decamelize\"","webpack:///./tests/unit/test.errors.js","webpack:///./tests/unit/test.program.js","webpack:///./tests/unit/test.setup.js","webpack:///./tests/unit/test.watcher.js"],"names":["context","keys","forEach","log","__filename","zipFile","tmpDir","sourceDir","artifactsDir","path","then","buildResult","match","extensionPath","open","extractFilenames","fileNames","sort","deepEqual","close","packageCreator","spy","fileFilter","wantFile","createFileFilter","params","ignoreFiles","ok","called","firstCall","args","equal","messageFileName","join","writeFileSync","manifestWithRepeatingPattern","name","version","messageFile","manifestData","result","catch","error","instanceOf","message","include","basicLocalizedManifest","info","stat","stats","isDirectory","baseIgnoredPatterns","notInclude","onSourceChange","asNeeded","typeOf","onChange","shouldWatchFile","unlink","isFile","packageResult","Promise","resolve","callCount","reject","Error","messageData","messageContents","extensionName","readFile","replace","messageName","getDefaultLocalizedName","showReadyMessage","id","debug","filter","buffer","default_locale","packageName","safeFileName","stream","write","end","defaultPackageCreator","toLowerCase","rebuildAsNeeded","createPackage","stack","build","proxyFileChanges","watcher","executeImmediately","on","filePath","watch","Date","now","process","indexOf","toTimeString","createLogger","ConsoleStream","verbose","isCapturing","capturedMessages","msg","level","prefix","packet","localProcess","thisLevel","TRACE","INFO","format","push","stdout","consoleStream","filename","createBunyanLog","streams","type","zipDir","getManifestId","manifestFile","manifestContents","errors","applications","gecko","length","getValidatedManifest","undefined","onlyInstancesOf","onlyErrorsWithCode","isErrorWithCode","WebExtError","UsageError","InvalidManifest","RemoteTempInstallNotSupported","predicate","errorHandler","codeWanted","throwError","Array","isArray","code","errno","asyncMkdirp","defaultAsyncMkdirp","access","W_OK","prepareArtifactsDir","isSubPath","src","target","relate","relative","startsWith","sep","FileFilter","filesToIgnore","addToIgnoreList","file","resolvedPath","files","resolveWithSourceDir","test","withTempDir","makePromise","TempDir","create","successHandler","_path","_removeTempDir","createTempDir","dir","multiArgs","unsafeCleanup","tmpPath","removeTempDir","remove","promiseResult","fixturePath","makeSureItFails","fake","fakeFirefoxClient","ZipFile","_zip","_close","zip","once","onRead","entry","readEach","fileName","pathParts","__dirname","original","methods","stub","props","obj","concat","Object","getOwnPropertyNames","getPrototypeOf","proto","key","hasOwnProperty","definition","warn","requestResult","requestError","makeRequestResult","makeRequestError","disconnect","request","callback","client","makeRequest","TCPConnectError","ErrorWithCode","basicManifest","manifestWithoutApps","writeManifest","nonExistentDir","badManifest","writeFile","noNameManifest","noVersionManifest","incompleteManifest","strictEqual","manifestWithErrors","destDir","JSON","stringify","openUrl","urlToOpen","docs","url","setUp","createLinter","lintResult","runLinter","run","lint","actualLintResult","runAsBinary","config","_","warningsAsErrors","logLevel","pretty","metadata","output","boring","selfHosted","shouldScanFile","linter","Boolean","defaultFirefoxApp","tempInstallResult","addon","tempInstallResultMissingAddonId","prepareRun","fakeInstallResult","argv","noReload","keepProfileChanges","options","firefoxApp","getFakeFirefox","firefoxClient","prototype","installTemporaryAddon","reloadStrategy","customArgv","customOpt","implementations","profile","allImplementations","createProfile","copyProfile","useProfile","installExtension","cmd","install","firefox","firefoxBinary","expectedBinaryArgs","startUrl","binaryArgs","browserConsole","marionette","firefoxProfile","fakeProfile","preInstall","asProxy","addonId","prepare","reloadAddon","desktopNotifications","createWatcher","customConfig","callArgs","createdWatcher","reloadArgs","lastCall","StubChildProcess","stderr","firefoxProcess","argOverride","optOverride","emit","sentArgs","receivedArgs","opt","maxRetries","retryInterval","tryCount","connectToFirefox","defaultWatcherCreator","defaultReloadStrategy","defaultFirefoxClient","title","retries","setTimeout","lastError","establishConnection","customPrefs","requiresRemote","installed","runner","ExtensionRunner","profilePath","getProfile","installAsProxy","runningFirefox","installAsTemporaryAddon","installResult","urls","showDesktopNotification","defaultLog","icon","notifier","notify","err","res","portToTry","retriesLeft","defaultRemotePortFinder","fxRunner","findRemotePort","remotePort","env","defaultFirefoxEnv","results","binary","data","toString","trim","app","configureThisProfile","configureProfile","destinationDirectory","profileDirectory","copyFromUserProfile","copy","copyByName","dirExists","extensionsDir","mkdir","isDir","destPath","writeStream","createWriteStream","readStream","createReadStream","pipe","all","XPCOM_DEBUG_BREAK","NS_TRACE_MALLOC_DISABLE_STACKS","getPrefs","prefs","pref","setPreference","customPrefsStr","custom","updatePreferences","coerceCLICustomPreference","nonOverridablePreferences","prefsCommon","prefsFennec","prefsFirefox","common","fennec","appPrefs","cliPrefs","prefsAry","split","value","slice","parseInt","includes","REMOTE_PORT","RemoteFirefox","checkedForAddonReloading","to","actor","response","addonPath","tabsResponse","addonsActor","installResponse","addons","map","a","addonRequest","requestTypes","supportedRequestTypes","getInstalledAddon","checkForAddonReloading","port","connect","getStubs","signingConfig","apiKey","apiSecret","apiUrlPrefix","apiProxy","timeout","signingResult","success","downloadedFiles","signAddon","preValidatedManifest","sign","stubs","extraArgs","extraOptions","copyDirAsPromised","xpiPath","customId","_sign","realResult","signedAddonCall","downloadDir","content","savedId","extensionId","extensionIdFile","lines","line","getIdFromSourceDir","saveIdToSourceDir","idFromSourceDir","manifestId","withBaseProfile","baseProfile","fakeFirefoxProcess","eventName","createFakeFxRunner","firefoxOverrides","fxProcess","runFirefox","listen","_WEB_EXT_FIREFOX_ENV_TEST","declaredEnv","someError","event","handler","writeStdout","writeStderr","userPrefs","cb","profileToCopy","defaultPreferences","thing","prefFile","withTempProfile","fakePrefGetter","returns","configuredProfile","testPromise","profileDir","installBasicExt","readdir","proxyFile","proxyData","isNumber","throws","isObject","nonChangeablePrefs","prop","isUndefined","prepareConnection","fakeAddon","makeInstance","listener","secondCall","thirdCall","conn","stubResponse","someAddonId","returnedAddon","checkedAddon","finalAddon","addonToCheck","requestArgs","someFile","resolvedDir","platform","skip","parentDir","fakeAsyncMkdirp","expectedNotification","fakeNotifier","expectedError","fakeLog","newFileFilter","defaultFilter","overrides","fakeProcess","FakeWritableStream","fakeWritableStream","makeVerbose","DEBUG","startCapturing","flushCapturedLogs","stopCapturing","tmpPathExisted","tmp","updateNotifierStub","updateNotifier","pkg","updateCheckInterval","checkForUpdates","makeArgv","userCmd","command","commandDesc","commandExecutor","commandOpt","globalOpt","program","setGlobalOptions","yargs","exitProcess","defaultValues","commandExecuted","applyConf","configFileName","cmdLineSrcDir","requiresArg","demand","configObject","newArgv","default","overwriteFiles","numberOfRetries","cmdApiKey","apiUrl","configFilePath","configObj","defaultVersionGetter","main","envPrefix","Program","absolutePackageDir","cwd","yargsInstance","shouldExitProgram","strict","commands","description","executor","commandOptions","setDefaultValues","yargsForCmd","demandCommand","global","systemProcess","logStream","getVersion","globalEnv","runCommand","exit","camelCasedKey","packageData","parse","branch","long","runOptions","usage","help","alias","describe","coerce","normalize","choices","execute","applyConfigToArgv","loadJSConfigFile","option","wasValueSetOnCLI","resolvedFilePath","SyntaxError","TypeError","ErrorWithErrno","execProgram","someOption","globalOption","WEB_EXT_SOME_OPT","valueReceived","someOpt","projectRoot","mainOptions","fakeCommands","fakeVersionGetter","prop2","pkgFile","pkgData","testBuildEnv","APPVEYOR","commit","currentTest","state","resolveChange","whenFilesChanged","utimes","defaults","conf"],"mappings":"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AACA;;AAEA,6BAA4B,aAAa;;AAEzC;AACA;AACA;AACA;AACA;AACA,yCAAwC,oCAAoC;AAC5E,6CAA4C,oCAAoC;AAChF,MAAK,2BAA2B,oCAAoC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,mBAAmB;AACnC;AACA;AACA,kCAAiC,2BAA2B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,G;;;;;;ACrEA,uB;;;;;;ACAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAmE;AACnE;AACA,sFAAqF;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX,UAAS;AACT;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,gDAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,eAAc;AACd,eAAc;AACd,eAAc;AACd,eAAc;AACd,gBAAe;AACf,gBAAe;AACf,gBAAe;AACf,iBAAgB;AAChB,0B;;;;;;AC5DA;AACA;AACA;AACA,wCAAuC,gC;;;;;;ACHvC,8BAA6B;AAC7B,sCAAqC,gC;;;;;;ACDrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACnBA;AACA;AACA;AACA,G;;;;;;ACHA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA,G;;;;;;ACPA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG,UAAU;AACb;AACA;AACA;AACA,G;;;;;;ACfA;AACA;AACA;AACA;AACA,G;;;;;;ACJA;AACA;AACA,G;;;;;;ACFA;AACA,sEAAsE,gBAAgB,UAAU,GAAG;AACnG,EAAC,E;;;;;;ACFD;AACA;AACA,kCAAiC,QAAQ,gBAAgB,UAAU,GAAG;AACtE,EAAC,E;;;;;;ACHD;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,G;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACPA,0C;;;;;;ACAA,wBAAuB;AACvB;AACA;AACA,G;;;;;;ACHA,qB;;;;;;ACAA;AACA;AACA;AACA;AACA;;AAEA;AACA,4FAAgF,aAAa,EAAE;;AAE/F;AACA,sDAAqD,0BAA0B;AAC/E;AACA,G;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;;;;;;ACxCA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACZA;AACA;AACA;;AAEA;AACA;AACA,G;;;;;;ACNA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;AChBA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACLA;AACA;AACA;AACA;AACA,G;;;;;;ACJA,kBAAiB;;AAEjB;AACA;AACA,G;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK,WAAW,eAAe;AAC/B;AACA,MAAK;AACL;AACA,G;;;;;;ACpBA;AACA;AACA;AACA;AACA,4DAA2D;AAC3D,G;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACNA;AACA;AACA;AACA;AACA,G;;;;;;ACJA;AACA;AACA,oDAAmD;AACnD;AACA,wCAAuC;AACvC,G;;;;;;ACLA;AACA;AACA;AACA;AACA,G;;;;;;ACJA;AACA;AACA;AACA,c;;;;;;ACHA,+E;;;;;;ACAA;AACA;AACA;;AAEA;AACA,mEAAkE,+BAA+B;AACjG,G;;;;;;ACNA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,wB;;;;;;ACVA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,G;;;;;;ACZA;AACA;AACA;AACA;AACA,G;;;;;;ACJA;AACA;AACA;AACA;AACA;;AAEA,yGAAwG,OAAO;AAC/G;AACA;AACA;AACA;AACA;AACA,E;;;;;;ACZA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iCAAgC;AAChC,eAAc;AACd,kBAAiB;AACjB;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;;AAEA;AACA;AACA,6B;;;;;;ACjCA,6BAA4B,e;;;;;;ACA5B;AACA,WAAU;AACV,G;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC;AACpC;;AAEA;AACA;AACA;AACA;AACA,gDAA+C,uDAAiD,oBAAoB;AACpH;AACA;AACA,IAAG,UAAU;AACb,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA,YAAW;AACX,UAAS;AACT,QAAO;AACP;AACA;AACA;AACA,4CAA2C;AAC3C;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,oBAAmB,gCAAgC;AACnD,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,gBAAe,qCAAqC;AACpD;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,mCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC;AAClC;AACA;AACA;AACA;AACA,wBAAuB,wBAAwB;AAC/C;AACA;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP,MAAK;AACL;AACA;AACA;AACA;AACA,IAAG;AACH,mBAAkB,uBAAuB,KAAK;AAC9C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,kBAAiB;AACjB,yBAAwB;AACxB,iBAAgB;AAChB,qBAAoB;AACpB,yBAAwB;AACxB,iBAAgB;AAChB,qBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,2DAA0D,kBAAkB;AAC5E;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,QAAO;AACP;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,MAAK;AACL;AACA;AACA;AACA,EAAC,E;;;;;;AC1SD;AACA;AACA;AACA;AACA,0BAAyB,kBAAkB,EAAE;;AAE7C;AACA;AACA;AACA;AACA,IAAG,UAAU;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACtBA;AACA;AACA;AACA,IAAG;AACH,G;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC,iBAAiB,EAAE;AACxD;AACA;AACA;AACA;AACA;AACA,iEAAgE,gBAAgB;AAChF;AACA;AACA,IAAG,2CAA2C,gCAAgC;AAC9E;AACA;AACA;AACA;AACA;AACA,yB;;;;;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,G;;;;;;ACXA;AACA;AACA;AACA;;AAEA;AACA;AACA,G;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,G;;;;;;ACfA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,wCAAuC,oBAAoB,EAAE;AAC7D;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,G;;;;;;ACnEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,G;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAoB,aAAa;AACjC,IAAG;AACH,G;;;;;;ACbA;AACA;;AAEA;AACA;AACA,gCAA+B,qBAAqB;AACpD,gCAA+B,SAAS,EAAE;AAC1C,EAAC,UAAU;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,SAAS,mBAAmB;AACvD,gCAA+B,aAAa;AAC5C;AACA,IAAG,UAAU;AACb;AACA,G;;;;;;ACpBA,gC;;;;;;ACAA,wC;;;;;;ACAA,8C;;;;;;;;;;;mBC+BwBpC,c;SAgCRqC,gB,GAAAA,gB;;AA9DhB;;;;AACA;;;;AAEA;;;;AAGA,KAAMvF,MAAM,0BAAaC,UAAb,CAAZ;;AAGA;;AAaA;AACA;AACA;AACA;;AAKe,UAASiD,cAAT,OAEF;AAAA,OADV9C,SACU,QADVA,SACU;AAAA,OADCC,YACD,QADCA,YACD;AAAA,OADegD,QACf,QADeA,QACf;AAAA,OADyBC,eACzB,QADyBA,eACzB;;AACX;AACA,OAAMkC,UAAU,yBAAhB;;AAEA,OAAMC,qBAAqB,IAA3B;AACApC,cAAW,wBAASA,QAAT,EAAmB,IAAnB,EAAyBoC,kBAAzB,CAAX;;AAEAD,WAAQE,EAAR,CAAW,QAAX,EAAqB,U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SAAS,IAAI;AACxD,IAAG;AACH,EAAC;AACD;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAC;AACD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAAyD;AACzD;AACA,MAAK;AACL;AACA,uBAAsB,iCAAiC;AACvD,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA8D,8BAA8B;AAC5F;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,2DAA0D,gBAAgB;;AAE1E;AACA;AACA;AACA,qBAAoB,oBAAoB;;AAExC,2CAA0C,oBAAoB;;AAE9D;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,IAAG;AACH,yBAAwB,eAAe,EAAE;AACzC,yBAAwB,gBAAgB;AACxC,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,qDAAoD,KAAK,QAAQ,iCAAiC;AAClG,EAAC;AACD;AACA,gDAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2C;;;;;;AC1OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAiD;AACjD,EAAC;AACD;AACA,sBAAqB;AACrB;AACA,UAAS;AACT,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA0D,sBAAsB;AAChF,iFAAgF,sBAAsB;AACtG,G;;;;;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,G;;;;;;ACdA,0C;;;;;;ACAA,eAAc,sB;;;;;;ACAd;AACA;AACA;AACA;AACA,G;;;;;;ACJA;AACA;AACA;AACA,mBAAkB;;AAElB;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;;;;;;AClBA;AACA;AACA;;AAEA;AACA;AACA,G;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG,UAAU;AACb;AACA,G;;;;;;ACfA,2C;;;;;;ACAA,wC;;;;;;ACAA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,uCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,G;;;;;;AChCA,mBAAkB,yD;;;;;;ACAlB;AACA,gE;;;;;;ACDA;AACA;AACA,+BAA8B,6CAA4C,E;;;;;;ACF1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA,QAAO,UAAU,cAAc;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,MAAK,GAAG;AACR;AACA,G;;;;;;ACxBA,mBAAkB,yD;;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","file":"unit-tests.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b2039aba1e9b0c1b8d38","// Webpack tests entry point. Bundles all the test files\n// into a single file.\n\nimport 'babel-polyfill';\n\nvar context = require.context('.', true, /.*?test\\..*?.js$/);\ncontext.keys().forEach(context);\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/runner.js","module.exports = require(\"babel-polyfill\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-polyfill\"\n// module id = 1\n// module chunks = 0","var map = {\n\t\"./test-cmd/test.build.js\": 3,\n\t\"./test-cmd/test.docs.js\": 142,\n\t\"./test-cmd/test.lint.js\": 145,\n\t\"./test-cmd/test.run.js\": 153,\n\t\"./test-cmd/test.sign.js\": 166,\n\t\"./test-firefox/test.firefox.js\": 170,\n\t\"./test-firefox/test.preferences.js\": 171,\n\t\"./test-firefox/test.remote.js\": 172,\n\t\"./test-util/test.artifacts.js\": 173,\n\t\"./test-util/test.desktop-notifier.js\": 174,\n\t\"./test-util/test.file-filter.js\": 175,\n\t\"./test-util/test.is-directory.js\": 176,\n\t\"./test-util/test.logger.js\": 177,\n\t\"./test-util/test.manifest.js\": 140,\n\t\"./test-util/test.temp-dir.js\": 179,\n\t\"./test-util/test.updates.js\": 180,\n\t\"./test.config.js\": 183,\n\t\"./test.errors.js\": 192,\n\t\"./test.program.js\": 193,\n\t\"./test.setup.js\": 194,\n\t\"./test.watcher.js\": 195\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\treturn map[req] || (function() { throw new Error(\"Cannot find module '\" + req + \"'.\") }());\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 2;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./tests/unit .*?test\\..*?.js$\n// module id = 2\n// module chunks = 0","/* @flow */\nimport path from 'path';\n\nimport {fs} from 'mz';\nimport {it, describe} from 'mocha';\nimport {assert} from 'chai';\nimport sinon from 'sinon';\n\nimport build, {\n  safeFileName,\n  getDefaultLocalizedName,\n} from '../../../src/cmd/build';\nimport {FileFilter} from '../../../src/util/file-filter';\nimport {withTempDir} from '../../../src/util/temp-dir';\nimport {fixturePath, makeSureItFails, ZipFile} from '../helpers';\nimport {\n  basicManifest,\n  manifestWithoutApps,\n} from '../test-util/test.manifest';\nimport {UsageError} from '../../../src/errors';\nimport {createLogger} from '../../../src/util/logger';\n\nconst log = createLogger(__filename);\n\ndescribe('build', () => {\n\n  it('zips a package', () => {\n    const zipFile = new ZipFile();\n\n    return withTempDir(\n      (tmpDir) =>\n        build({\n          sourceDir: fixturePath('minimal-web-ext'),\n          artifactsDir: tmpDir.path(),\n        })\n          .then((buildResult) => {\n            assert.match(buildResult.extensionPath,\n                         /minimal_extension-1\\.0\\.zip$/);\n            return buildResult.extensionPath;\n          })\n          .then((extensionPath) => zipFile.open(extensionPath))\n          .then(() => zipFile.extractFilenames())\n          .then((fileNames) => {\n            fileNames.sort();\n            assert.deepEqual(fileNames,\n                             ['background-script.js', 'manifest.json']);\n            return zipFile.close();\n          })\n    );\n  });\n\n  it('configures a build command with the expected fileFilter', () => {\n    const packageCreator = sinon.spy(\n      () => ({extensionPath: 'extension/path'})\n    );\n    const fileFilter = {wantFile: () => true};\n    const createFileFilter = sinon.spy(() => fileFilter);\n    const params = {\n      sourceDir: '/src',\n      artifactsDir: 'artifacts',\n      ignoreFiles: ['**/*.log'],\n    };\n    return build(params, {packageCreator, createFileFilter}).then(() => {\n      // ensure sourceDir, artifactsDir, ignoreFiles is used\n      assert.ok(createFileFilter.called);\n      assert.deepEqual(createFileFilter.firstCall.args[0], params);\n      // ensure packageCreator received correct fileFilter\n      assert.ok(packageCreator.called);\n      assert.equal(packageCreator.firstCall.args[0].fileFilter, fileFilter);\n    });\n  });\n\n  it('gives the correct name to a localized extension', () => {\n    return withTempDir(\n      (tmpDir) =>\n        build({\n          sourceDir: fixturePath('minimal-localizable-web-ext'),\n          artifactsDir: tmpDir.path(),\n        })\n          .then((buildResult) => {\n            assert.match(buildResult.extensionPath,\n                         /name_of_the_extension-1\\.0\\.zip$/);\n            return buildResult.extensionPath;\n          })\n    );\n  });\n\n  it('handles repeating localization keys', () => {\n    return withTempDir(\n      (tmpDir) => {\n        const messageFileName = path.join(tmpDir.path(), 'messages.json');\n        fs.writeFileSync(messageFileName,\n          `{\"extensionName\": {\n              \"message\": \"example extension\",\n              \"description\": \"example description\"\n            }\n          }`);\n\n        const manifestWithRepeatingPattern = {\n          name: '__MSG_extensionName__ __MSG_extensionName__',\n          version: '0.0.1',\n        };\n\n        return getDefaultLocalizedName({\n          messageFile: messageFileName,\n          manifestData: manifestWithRepeatingPattern,\n        })\n          .then((result) => {\n            assert.match(result, /example extension example extension/);\n          });\n      }\n    );\n  });\n\n  it('checks locale file for malformed json', () => {\n    return withTempDir(\n      (tmpDir) => {\n        const messageFileName = path.join(tmpDir.path(), 'messages.json');\n        fs.writeFileSync(messageFileName,\n          '{\"simulated:\" \"json syntax error\"');\n        return getDefaultLocalizedName({\n          messageFile: messageFileName,\n          manifestData: manifestWithoutApps,\n        })\n          .then(makeSureItFails())\n          .catch((error) => {\n            assert.instanceOf(error, UsageError);\n            assert.match(error.message, /Unexpected token '\"' at 1:15/);\n            assert.match(error.message, /^Error parsing messages.json/);\n            assert.include(error.message, messageFileName);\n          });\n      }\n    );\n  });\n\n  it('checks locale file for incorrect format', () => {\n    return withTempDir(\n      (tmpDir) => {\n        const messageFileName = path.join(tmpDir.path(), 'messages.json');\n        //This is missing the 'message' key\n        fs.writeFileSync(messageFileName,\n          `{\"extensionName\": {\n              \"description\": \"example extension\"\n              }\n          }`);\n        const basicLocalizedManifest = {\n          name: '__MSG_extensionName__',\n          version: '0.0.1',\n        };\n        return getDefaultLocalizedName({\n          messageFile: messageFileName,\n          manifestData: basicLocalizedManifest,\n        })\n          .then(makeSureItFails())\n          .catch((error) => {\n            assert.instanceOf(error, UsageError);\n            assert.match(\n              error.message,\n              /The locale file .*messages\\.json is missing key: extensionName/);\n          });\n      }\n    );\n  });\n\n  it('throws an error if the locale file does not exist', () => {\n    return getDefaultLocalizedName({\n      messageFile: '/path/to/non-existent-dir/messages.json',\n      manifestData: manifestWithoutApps,\n    })\n      .then(makeSureItFails())\n      .catch((error) => {\n        log.info(error);\n        assert.instanceOf(error, UsageError);\n        assert.match(\n          error.message,\n          /Error: ENOENT: no such file or directory, open .*messages.json/);\n        assert.match(error.message, /^Error reading messages.json/);\n        assert.include(error.message,\n          '/path/to/non-existent-dir/messages.json');\n      });\n  });\n\n  it('can build an extension without an ID', () => {\n    return withTempDir(\n      (tmpDir) => {\n        // Make sure a manifest without an ID doesn't throw an error.\n        return build({\n          sourceDir: fixturePath('minimal-web-ext'),\n          artifactsDir: tmpDir.path(),\n        }, {manifestData: manifestWithoutApps});\n      }\n    );\n  });\n\n  it('prepares the artifacts dir', () => withTempDir(\n    (tmpDir) => {\n      const artifactsDir = path.join(tmpDir.path(), 'artifacts');\n      return build({\n        sourceDir: fixturePath('minimal-web-ext'),\n        artifactsDir,\n      })\n        .then(() => fs.stat(artifactsDir))\n        .then((stats) => {\n          assert.equal(stats.isDirectory(), true);\n        });\n    }\n  ));\n\n  it('lets you specify a manifest', () => withTempDir(\n    (tmpDir) =>\n      build({\n        sourceDir: fixturePath('minimal-web-ext'),\n        artifactsDir: tmpDir.path(),\n      }, {\n        manifestData: basicManifest,\n      })\n        .then((buildResult) => {\n          assert.match(buildResult.extensionPath,\n                       /the_extension-0\\.0\\.1\\.zip$/);\n          return buildResult.extensionPath;\n        })\n  ));\n\n  it('asks FileFilter what files to include in the ZIP', () => {\n    const zipFile = new ZipFile();\n    const fileFilter = new FileFilter({\n      sourceDir: '.',\n      baseIgnoredPatterns: ['**/background-script.js'],\n    });\n\n    return withTempDir(\n      (tmpDir) =>\n        build({\n          sourceDir: fixturePath('minimal-web-ext'),\n          artifactsDir: tmpDir.path(),\n        }, {fileFilter})\n          .then((buildResult) => zipFile.open(buildResult.extensionPath))\n          .then(() => zipFile.extractFilenames())\n          .then((fileNames) => {\n            assert.notInclude(fileNames, 'background-script.js');\n            return zipFile.close();\n          })\n    );\n  });\n\n  it('lets you rebuild when files change', () => withTempDir(\n    (tmpDir) => {\n      const sourceDir = fixturePath('minimal-web-ext');\n      const artifactsDir = tmpDir.path();\n      const fileFilter = new FileFilter({sourceDir, artifactsDir});\n      sinon.spy(fileFilter, 'wantFile');\n      const onSourceChange = sinon.spy(() => {});\n      return build({\n        sourceDir, artifactsDir, asNeeded: true,\n      }, {\n        manifestData: basicManifest, onSourceChange, fileFilter,\n      })\n        .then((buildResult) => {\n          // Make sure we still have a build result.\n          assert.match(buildResult.extensionPath, /\\.zip$/);\n          return buildResult;\n        })\n        .then((buildResult) => {\n          assert.equal(onSourceChange.called, true);\n          const args = onSourceChange.firstCall.args[0];\n          assert.equal(args.sourceDir, sourceDir);\n          assert.equal(args.artifactsDir, artifactsDir);\n          assert.typeOf(args.onChange, 'function');\n\n          // Make sure it uses the file filter.\n          assert.typeOf(args.shouldWatchFile, 'function');\n          args.shouldWatchFile('/some/path');\n          assert.equal(fileFilter.wantFile.called, true);\n\n          // Remove the built extension.\n          return fs.unlink(buildResult.extensionPath)\n            // Execute the onChange handler to make sure it gets built\n            // again. This simulates what happens when the file watcher\n            // executes the callback.\n            .then(() => args.onChange());\n        })\n        .then((buildResult) => {\n          assert.match(buildResult.extensionPath, /\\.zip$/);\n          return fs.stat(buildResult.extensionPath);\n        })\n        .then((stat) => {\n          assert.equal(stat.isFile(), true);\n        });\n    }\n  ));\n\n  it('throws errors when rebuilding in source watcher', () => withTempDir(\n    (tmpDir) => {\n      var packageResult = Promise.resolve({});\n      const packageCreator = sinon.spy(() => packageResult);\n      const onSourceChange = sinon.spy(() => {});\n      return build({\n        sourceDir: fixturePath('minimal-web-ext'),\n        artifactsDir: tmpDir.path(),\n        asNeeded: true,\n      }, {\n        manifestData: basicManifest, onSourceChange, packageCreator,\n      })\n        .then(() => {\n          assert.equal(onSourceChange.called, true);\n          assert.equal(packageCreator.callCount, 1);\n\n          const {onChange} = onSourceChange.firstCall.args[0];\n          packageResult = Promise.reject(new Error(\n            'Simulate an error on the second call to packageCreator()'));\n          // Invoke the stub packageCreator() again which should throw an error\n          return onChange();\n        })\n        .then(makeSureItFails())\n        .catch((error) => {\n          assert.include(\n            error.message,\n            'Simulate an error on the second call to packageCreator()');\n        });\n    }\n  ));\n\n  describe('safeFileName', () => {\n\n    it('makes names safe for writing to a file system', () => {\n      assert.equal(safeFileName('Bob Loblaw\\'s 2005 law-blog.net'),\n                   'bob_loblaw_s_2005_law-blog.net');\n    });\n\n  });\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-cmd/test.build.js","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"mz\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mz\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"mocha\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mocha\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"chai\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"chai\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"sinon\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sinon\"\n// module id = 8\n// module chunks = 0","/* @flow */\nimport path from 'path';\nimport {createWriteStream} from 'fs';\n\nimport {fs} from 'mz';\nimport parseJSON from 'parse-json';\nimport eventToPromise from 'event-to-promise';\n\nimport defaultSourceWatcher from '../watcher';\nimport {zipDir} from '../util/zip-dir';\nimport getValidatedManifest, {getManifestId} from '../util/manifest';\nimport {prepareArtifactsDir} from '../util/artifacts';\nimport {createLogger} from '../util/logger';\nimport {UsageError} from '../errors';\nimport {\n  createFileFilter as defaultFileFilterCreator,\n  FileFilter,\n} from '../util/file-filter';\n// Import flow types.\nimport type {OnSourceChangeFn} from '../watcher';\nimport type {ExtensionManifest} from '../util/manifest';\nimport type {FileFilterCreatorFn} from '../util/file-filter';\n\nconst log = createLogger(__filename);\n\n\nexport function safeFileName(name: string): string {\n  return name.toLowerCase().replace(/[^a-z0-9\\.-]+/g, '_');\n}\n\n\n// defaultPackageCreator types and implementation.\n\nexport type ExtensionBuildResult = {|\n  extensionPath: string,\n|};\n\nexport type PackageCreatorParams = {|\n  manifestData?: ExtensionManifest,\n  sourceDir: string,\n  fileFilter: FileFilter,\n  artifactsDir: string,\n  showReadyMessage: boolean\n|};\n\nexport type LocalizedNameParams = {|\n  messageFile: string,\n  manifestData: ExtensionManifest,\n|}\n\n// This defines the _locales/messages.json type. See:\n// https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Internationalization#Providing_localized_strings_in__locales\ntype LocalizedMessageData = {|\n  [messageName: string]: {|\n    description: string,\n    message: string,\n  |},\n|}\n\nexport async function getDefaultLocalizedName(\n  {messageFile, manifestData}: LocalizedNameParams\n): Promise<string> {\n\n  let messageData: LocalizedMessageData;\n  let messageContents: string | Buffer;\n  let extensionName: string = manifestData.name;\n\n  try {\n    messageContents = await fs.readFile(messageFile);\n  } catch (error) {\n    throw new UsageError(\n      `Error reading messages.json file at ${messageFile}: ${error}`);\n  }\n\n  try {\n    messageData = parseJSON(messageContents, messageFile);\n  } catch (error) {\n    throw new UsageError(\n      `Error parsing messages.json ${error}`);\n  }\n\n  extensionName = manifestData.name.replace(/__MSG_([A-Za-z0-9@_]+?)__/g,\n    (match, messageName) => {\n      if (!(messageData[messageName]\n            && messageData[messageName].message)) {\n        const error = new UsageError(\n          `The locale file ${messageFile} ` +\n            `is missing key: ${messageName}`);\n        throw error;\n      } else {\n        return messageData[messageName].message;\n      }\n    });\n  return Promise.resolve(extensionName);\n}\n\nexport type PackageCreatorFn =\n    (params: PackageCreatorParams) => Promise<ExtensionBuildResult>;\n\nasync function defaultPackageCreator({\n  manifestData, sourceDir, fileFilter, artifactsDir, showReadyMessage,\n}: PackageCreatorParams): Promise<ExtensionBuildResult> {\n  let id;\n  if (manifestData) {\n    id = getManifestId(manifestData);\n    log.debug(`Using manifest id=${id || '[not specified]'}`);\n  } else {\n    manifestData = await getValidatedManifest(sourceDir);\n  }\n\n  const buffer = await zipDir(sourceDir, {\n    filter: (...args) => fileFilter.wantFile(...args),\n  });\n\n  let extensionName: string = manifestData.name;\n\n  if (manifestData.default_locale) {\n    const messageFile = path.join(sourceDir, '_locales',\n      manifestData.default_locale, 'messages.json');\n    log.debug('Manifest declared default_locale, localizing extension name');\n    extensionName = await getDefaultLocalizedName(\n      {messageFile, manifestData});\n  }\n  const packageName = safeFileName(\n    `${extensionName}-${manifestData.version}.zip`);\n  const extensionPath = path.join(artifactsDir, packageName);\n  const stream = createWriteStream(extensionPath);\n\n  stream.write(buffer, () => stream.end());\n\n  await eventToPromise(stream, 'close');\n\n  if (showReadyMessage) {\n    log.info(`Your web extension is ready: ${extensionPath}`);\n  }\n  return {extensionPath};\n}\n\n\n// Build command types and implementation.\n\nexport type BuildCmdParams = {|\n  sourceDir: string,\n  artifactsDir: string,\n  asNeeded?: boolean,\n  ignoreFiles?: Array<string>,\n|};\n\nexport type BuildCmdOptions = {|\n  manifestData?: ExtensionManifest,\n  fileFilter?: FileFilter,\n  onSourceChange?: OnSourceChangeFn,\n  packageCreator?: PackageCreatorFn,\n  showReadyMessage?: boolean,\n  createFileFilter?: FileFilterCreatorFn,\n|};\n\nexport default async function build(\n  {sourceDir, artifactsDir, asNeeded = false, ignoreFiles = []}: BuildCmdParams,\n  {\n    manifestData,\n    createFileFilter = defaultFileFilterCreator,\n    fileFilter = createFileFilter({\n      sourceDir,\n      artifactsDir,\n      ignoreFiles,\n    }),\n    onSourceChange = defaultSourceWatcher,\n    packageCreator = defaultPackageCreator,\n    showReadyMessage = true,\n  }: BuildCmdOptions = {}\n): Promise<ExtensionBuildResult> {\n\n  const rebuildAsNeeded = asNeeded; // alias for `build --as-needed`\n  log.info(`Building web extension from ${sourceDir}`);\n\n  const createPackage = () => packageCreator({\n    manifestData, sourceDir, fileFilter, artifactsDir, showReadyMessage,\n  });\n\n  await prepareArtifactsDir(artifactsDir);\n  const result = await createPackage();\n\n  if (rebuildAsNeeded) {\n    log.info('Rebuilding when files change...');\n    onSourceChange({\n      sourceDir,\n      artifactsDir,\n      onChange: () => {\n        return createPackage().catch((error) => {\n          log.error(error.stack);\n          throw error;\n        });\n      },\n      shouldWatchFile: (...args) => fileFilter.wantFile(...args),\n    });\n  }\n\n  return result;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/cmd/build.js","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/regenerator/index.js\n// module id = 10\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 11\n// module chunks = 0","\"use strict\";\n\nexports.__esModule = true;\n\nvar _promise = require(\"../core-js/promise\");\n\nvar _promise2 = _interopRequireDefault(_promise);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (fn) {\n  return function () {\n    var gen = fn.apply(this, arguments);\n    return new _promise2.default(function (resolve, reject) {\n      function step(key, arg) {\n        try {\n          var info = gen[key](arg);\n          var value = info.value;\n        } catch (error) {\n          reject(error);\n          return;\n        }\n\n        if (info.done) {\n          resolve(value);\n        } else {\n          return _promise2.default.resolve(value).then(function (value) {\n            step(\"next\", value);\n          }, function (err) {\n            step(\"throw\", err);\n          });\n        }\n      }\n\n      return step(\"next\");\n    });\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/asyncToGenerator.js\n// module id = 12\n// module chunks = 0","module.exports = { \"default\": require(\"core-js/library/fn/promise\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/promise.js\n// module id = 13\n// module chunks = 0","require('../modules/es6.object.to-string');\nrequire('../modules/es6.string.iterator');\nrequire('../modules/web.dom.iterable');\nrequire('../modules/es6.promise');\nmodule.exports = require('../modules/_core').Promise;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/promise.js\n// module id = 14\n// module chunks = 0","'use strict';\nvar $at  = require('./_string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\nrequire('./_iter-define')(String, 'String', function(iterated){\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function(){\n  var O     = this._t\n    , index = this._i\n    , point;\n  if(index >= O.length)return {value: undefined, done: true};\n  point = $at(O, index);\n  this._i += point.length;\n  return {value: point, done: false};\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es6.string.iterator.js\n// module id = 16\n// module chunks = 0","var toInteger = require('./_to-integer')\n  , defined   = require('./_defined');\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function(TO_STRING){\n  return function(that, pos){\n    var s = String(defined(that))\n      , i = toInteger(pos)\n      , l = s.length\n      , a, b;\n    if(i < 0 || i >= l)return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_string-at.js\n// module id = 17\n// module chunks = 0","// 7.1.4 ToInteger\nvar ceil  = Math.ceil\n  , floor = Math.floor;\nmodule.exports = function(it){\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_to-integer.js\n// module id = 18\n// module chunks = 0","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function(it){\n  if(it == undefined)throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_defined.js\n// module id = 19\n// module chunks = 0","'use strict';\nvar LIBRARY        = require('./_library')\n  , $export        = require('./_export')\n  , redefine       = require('./_redefine')\n  , hide           = require('./_hide')\n  , has            = require('./_has')\n  , Iterators      = require('./_iterators')\n  , $iterCreate    = require('./_iter-create')\n  , setToStringTag = require('./_set-to-string-tag')\n  , getPrototypeOf = require('./_object-gpo')\n  , ITERATOR       = require('./_wks')('iterator')\n  , BUGGY          = !([].keys && 'next' in [].keys()) // Safari has buggy iterators w/o `next`\n  , FF_ITERATOR    = '@@iterator'\n  , KEYS           = 'keys'\n  , VALUES         = 'values';\n\nvar returnThis = function(){ return this; };\n\nmodule.exports = function(Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED){\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function(kind){\n    if(!BUGGY && kind in proto)return proto[kind];\n    switch(kind){\n      case KEYS: return function keys(){ return new Constructor(this, kind); };\n      case VALUES: return function values(){ return new Constructor(this, kind); };\n    } return function entries(){ return new Constructor(this, kind); };\n  };\n  var TAG        = NAME + ' Iterator'\n    , DEF_VALUES = DEFAULT == VALUES\n    , VALUES_BUG = false\n    , proto      = Base.prototype\n    , $native    = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT]\n    , $default   = $native || getMethod(DEFAULT)\n    , $entries   = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined\n    , $anyNative = NAME == 'Array' ? proto.entries || $native : $native\n    , methods, key, IteratorPrototype;\n  // Fix native\n  if($anyNative){\n    IteratorPrototype = getPrototypeOf($anyNative.call(new Base));\n    if(IteratorPrototype !== Object.prototype){\n      // Set @@toStringTag to native iterators\n      setToStringTag(IteratorPrototype, TAG, true);\n      // fix for some old engines\n      if(!LIBRARY && !has(IteratorPrototype, ITERATOR))hide(IteratorPrototype, ITERATOR, returnThis);\n    }\n  }\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if(DEF_VALUES && $native && $native.name !== VALUES){\n    VALUES_BUG = true;\n    $default = function values(){ return $native.call(this); };\n  }\n  // Define iterator\n  if((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])){\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG]  = returnThis;\n  if(DEFAULT){\n    methods = {\n      values:  DEF_VALUES ? $default : getMethod(VALUES),\n      keys:    IS_SET     ? $default : getMethod(KEYS),\n      entries: $entries\n    };\n    if(FORCED)for(key in methods){\n      if(!(key in proto))redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_iter-define.js\n// module id = 20\n// module chunks = 0","module.exports = true;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_library.js\n// module id = 21\n// module chunks = 0","var global    = require('./_global')\n  , core      = require('./_core')\n  , ctx       = require('./_ctx')\n  , hide      = require('./_hide')\n  , PROTOTYPE = 'prototype';\n\nvar $export = function(type, name, source){\n  var IS_FORCED = type & $export.F\n    , IS_GLOBAL = type & $export.G\n    , IS_STATIC = type & $export.S\n    , IS_PROTO  = type & $export.P\n    , IS_BIND   = type & $export.B\n    , IS_WRAP   = type & $export.W\n    , exports   = IS_GLOBAL ? core : core[name] || (core[name] = {})\n    , expProto  = exports[PROTOTYPE]\n    , target    = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE]\n    , key, own, out;\n  if(IS_GLOBAL)source = name;\n  for(key in source){\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    if(own && key in exports)continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]\n    // bind timers to global for call from export context\n    : IS_BIND && own ? ctx(out, global)\n    // wrap global constructors for prevent change them in library\n    : IS_WRAP && target[key] == out ? (function(C){\n      var F = function(a, b, c){\n        if(this instanceof C){\n          switch(arguments.length){\n            case 0: return new C;\n            case 1: return new C(a);\n            case 2: return new C(a, b);\n          } return new C(a, b, c);\n        } return C.apply(this, arguments);\n      };\n      F[PROTOTYPE] = C[PROTOTYPE];\n      return F;\n    // make static versions for prototype methods\n    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%\n    if(IS_PROTO){\n      (exports.virtual || (exports.virtual = {}))[key] = out;\n      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%\n      if(type & $export.R && expProto && !expProto[key])hide(expProto, key, out);\n    }\n  }\n};\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library` \nmodule.exports = $export;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_export.js\n// module id = 22\n// module chunks = 0","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self : Function('return this')();\nif(typeof __g == 'number')__g = global; // eslint-disable-line no-undef\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_global.js\n// module id = 23\n// module chunks = 0","var core = module.exports = {version: '2.4.0'};\nif(typeof __e == 'number')__e = core; // eslint-disable-line no-undef\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_core.js\n// module id = 24\n// module chunks = 0","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function(fn, that, length){\n  aFunction(fn);\n  if(that === undefined)return fn;\n  switch(length){\n    case 1: return function(a){\n      return fn.call(that, a);\n    };\n    case 2: return function(a, b){\n      return fn.call(that, a, b);\n    };\n    case 3: return function(a, b, c){\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function(/* ...args */){\n    return fn.apply(that, arguments);\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_ctx.js\n// module id = 25\n// module chunks = 0","module.exports = function(it){\n  if(typeof it != 'function')throw TypeError(it + ' is not a function!');\n  return it;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_a-function.js\n// module id = 26\n// module chunks = 0","var dP         = require('./_object-dp')\n  , createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function(object, key, value){\n  return dP.f(object, key, createDesc(1, value));\n} : function(object, key, value){\n  object[key] = value;\n  return object;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_hide.js\n// module id = 27\n// module chunks = 0","var anObject       = require('./_an-object')\n  , IE8_DOM_DEFINE = require('./_ie8-dom-define')\n  , toPrimitive    = require('./_to-primitive')\n  , dP             = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes){\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if(IE8_DOM_DEFINE)try {\n    return dP(O, P, Attributes);\n  } catch(e){ /* empty */ }\n  if('get' in Attributes || 'set' in Attributes)throw TypeError('Accessors not supported!');\n  if('value' in Attributes)O[P] = Attributes.value;\n  return O;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-dp.js\n// module id = 28\n// module chunks = 0","var isObject = require('./_is-object');\nmodule.exports = function(it){\n  if(!isObject(it))throw TypeError(it + ' is not an object!');\n  return it;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_an-object.js\n// module id = 29\n// module chunks = 0","module.exports = function(it){\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_is-object.js\n// module id = 30\n// module chunks = 0","module.exports = !require('./_descriptors') && !require('./_fails')(function(){\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', {get: function(){ return 7; }}).a != 7;\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_ie8-dom-define.js\n// module id = 31\n// module chunks = 0","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function(){\n  return Object.defineProperty({}, 'a', {get: function(){ return 7; }}).a != 7;\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_descriptors.js\n// module id = 32\n// module chunks = 0","module.exports = function(exec){\n  try {\n    return !!exec();\n  } catch(e){\n    return true;\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_fails.js\n// module id = 33\n// module chunks = 0","var isObject = require('./_is-object')\n  , document = require('./_global').document\n  // in old IE typeof document.createElement is 'object'\n  , is = isObject(document) && isObject(document.createElement);\nmodule.exports = function(it){\n  return is ? document.createElement(it) : {};\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_dom-create.js\n// module id = 34\n// module chunks = 0","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function(it, S){\n  if(!isObject(it))return it;\n  var fn, val;\n  if(S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it)))return val;\n  if(typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it)))return val;\n  if(!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it)))return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_to-primitive.js\n// module id = 35\n// module chunks = 0","module.exports = function(bitmap, value){\n  return {\n    enumerable  : !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable    : !(bitmap & 4),\n    value       : value\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_property-desc.js\n// module id = 36\n// module chunks = 0","module.exports = require('./_hide');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_redefine.js\n// module id = 37\n// module chunks = 0","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function(it, key){\n  return hasOwnProperty.call(it, key);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_has.js\n// module id = 38\n// module chunks = 0","module.exports = {};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_iterators.js\n// module id = 39\n// module chunks = 0","'use strict';\nvar create         = require('./_object-create')\n  , descriptor     = require('./_property-desc')\n  , setToStringTag = require('./_set-to-string-tag')\n  , IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nrequire('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function(){ return this; });\n\nmodule.exports = function(Constructor, NAME, next){\n  Constructor.prototype = create(IteratorPrototype, {next: descriptor(1, next)});\n  setToStringTag(Constructor, NAME + ' Iterator');\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_iter-create.js\n// module id = 40\n// module chunks = 0","// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject    = require('./_an-object')\n  , dPs         = require('./_object-dps')\n  , enumBugKeys = require('./_enum-bug-keys')\n  , IE_PROTO    = require('./_shared-key')('IE_PROTO')\n  , Empty       = function(){ /* empty */ }\n  , PROTOTYPE   = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function(){\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = require('./_dom-create')('iframe')\n    , i      = enumBugKeys.length\n    , lt     = '<'\n    , gt     = '>'\n    , iframeDocument;\n  iframe.style.display = 'none';\n  require('./_html').appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while(i--)delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties){\n  var result;\n  if(O !== null){\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty;\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-create.js\n// module id = 41\n// module chunks = 0","var dP       = require('./_object-dp')\n  , anObject = require('./_an-object')\n  , getKeys  = require('./_object-keys');\n\nmodule.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties){\n  anObject(O);\n  var keys   = getKeys(Properties)\n    , length = keys.length\n    , i = 0\n    , P;\n  while(length > i)dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-dps.js\n// module id = 42\n// module chunks = 0","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys       = require('./_object-keys-internal')\n  , enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O){\n  return $keys(O, enumBugKeys);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-keys.js\n// module id = 43\n// module chunks = 0","var has          = require('./_has')\n  , toIObject    = require('./_to-iobject')\n  , arrayIndexOf = require('./_array-includes')(false)\n  , IE_PROTO     = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function(object, names){\n  var O      = toIObject(object)\n    , i      = 0\n    , result = []\n    , key;\n  for(key in O)if(key != IE_PROTO)has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while(names.length > i)if(has(O, key = names[i++])){\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-keys-internal.js\n// module id = 44\n// module chunks = 0","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject')\n  , defined = require('./_defined');\nmodule.exports = function(it){\n  return IObject(defined(it));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_to-iobject.js\n// module id = 45\n// module chunks = 0","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function(it){\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_iobject.js\n// module id = 46\n// module chunks = 0","var toString = {}.toString;\n\nmodule.exports = function(it){\n  return toString.call(it).slice(8, -1);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_cof.js\n// module id = 47\n// module chunks = 0","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject')\n  , toLength  = require('./_to-length')\n  , toIndex   = require('./_to-index');\nmodule.exports = function(IS_INCLUDES){\n  return function($this, el, fromIndex){\n    var O      = toIObject($this)\n      , length = toLength(O.length)\n      , index  = toIndex(fromIndex, length)\n      , value;\n    // Array#includes uses SameValueZero equality algorithm\n    if(IS_INCLUDES && el != el)while(length > index){\n      value = O[index++];\n      if(value != value)return true;\n    // Array#toIndex ignores holes, Array#includes - not\n    } else for(;length > index; index++)if(IS_INCLUDES || index in O){\n      if(O[index] === el)return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_array-includes.js\n// module id = 48\n// module chunks = 0","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer')\n  , min       = Math.min;\nmodule.exports = function(it){\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_to-length.js\n// module id = 49\n// module chunks = 0","var toInteger = require('./_to-integer')\n  , max       = Math.max\n  , min       = Math.min;\nmodule.exports = function(index, length){\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_to-index.js\n// module id = 50\n// module chunks = 0","var shared = require('./_shared')('keys')\n  , uid    = require('./_uid');\nmodule.exports = function(key){\n  return shared[key] || (shared[key] = uid(key));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_shared-key.js\n// module id = 51\n// module chunks = 0","var global = require('./_global')\n  , SHARED = '__core-js_shared__'\n  , store  = global[SHARED] || (global[SHARED] = {});\nmodule.exports = function(key){\n  return store[key] || (store[key] = {});\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_shared.js\n// module id = 52\n// module chunks = 0","var id = 0\n  , px = Math.random();\nmodule.exports = function(key){\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_uid.js\n// module id = 53\n// module chunks = 0","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_enum-bug-keys.js\n// module id = 54\n// module chunks = 0","module.exports = require('./_global').document && document.documentElement;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_html.js\n// module id = 55\n// module chunks = 0","var def = require('./_object-dp').f\n  , has = require('./_has')\n  , TAG = require('./_wks')('toStringTag');\n\nmodule.exports = function(it, tag, stat){\n  if(it && !has(it = stat ? it : it.prototype, TAG))def(it, TAG, {configurable: true, value: tag});\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_set-to-string-tag.js\n// module id = 56\n// module chunks = 0","var store      = require('./_shared')('wks')\n  , uid        = require('./_uid')\n  , Symbol     = require('./_global').Symbol\n  , USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function(name){\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_wks.js\n// module id = 57\n// module chunks = 0","// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)\nvar has         = require('./_has')\n  , toObject    = require('./_to-object')\n  , IE_PROTO    = require('./_shared-key')('IE_PROTO')\n  , ObjectProto = Object.prototype;\n\nmodule.exports = Object.getPrototypeOf || function(O){\n  O = toObject(O);\n  if(has(O, IE_PROTO))return O[IE_PROTO];\n  if(typeof O.constructor == 'function' && O instanceof O.constructor){\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectProto : null;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-gpo.js\n// module id = 58\n// module chunks = 0","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function(it){\n  return Object(defined(it));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_to-object.js\n// module id = 59\n// module chunks = 0","require('./es6.array.iterator');\nvar global        = require('./_global')\n  , hide          = require('./_hide')\n  , Iterators     = require('./_iterators')\n  , TO_STRING_TAG = require('./_wks')('toStringTag');\n\nfor(var collections = ['NodeList', 'DOMTokenList', 'MediaList', 'StyleSheetList', 'CSSRuleList'], i = 0; i < 5; i++){\n  var NAME       = collections[i]\n    , Collection = global[NAME]\n    , proto      = Collection && Collection.prototype;\n  if(proto && !proto[TO_STRING_TAG])hide(proto, TO_STRING_TAG, NAME);\n  Iterators[NAME] = Iterators.Array;\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/web.dom.iterable.js\n// module id = 60\n// module chunks = 0","'use strict';\nvar addToUnscopables = require('./_add-to-unscopables')\n  , step             = require('./_iter-step')\n  , Iterators        = require('./_iterators')\n  , toIObject        = require('./_to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = require('./_iter-define')(Array, 'Array', function(iterated, kind){\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function(){\n  var O     = this._t\n    , kind  = this._k\n    , index = this._i++;\n  if(!O || index >= O.length){\n    this._t = undefined;\n    return step(1);\n  }\n  if(kind == 'keys'  )return step(0, index);\n  if(kind == 'values')return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es6.array.iterator.js\n// module id = 61\n// module chunks = 0","module.exports = function(){ /* empty */ };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_add-to-unscopables.js\n// module id = 62\n// module chunks = 0","module.exports = function(done, value){\n  return {value: value, done: !!done};\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_iter-step.js\n// module id = 63\n// module chunks = 0","'use strict';\nvar LIBRARY            = require('./_library')\n  , global             = require('./_global')\n  , ctx                = require('./_ctx')\n  , classof            = require('./_classof')\n  , $export            = require('./_export')\n  , isObject           = require('./_is-object')\n  , aFunction          = require('./_a-function')\n  , anInstance         = require('./_an-instance')\n  , forOf              = require('./_for-of')\n  , speciesConstructor = require('./_species-constructor')\n  , task               = require('./_task').set\n  , microtask          = require('./_microtask')()\n  , PROMISE            = 'Promise'\n  , TypeError          = global.TypeError\n  , process            = global.process\n  , $Promise           = global[PROMISE]\n  , process            = global.process\n  , isNode             = classof(process) == 'process'\n  , empty              = function(){ /* empty */ }\n  , Internal, GenericPromiseCapability, Wrapper;\n\nvar USE_NATIVE = !!function(){\n  try {\n    // correct subclassing with @@species support\n    var promise     = $Promise.resolve(1)\n      , FakePromise = (promise.constructor = {})[require('./_wks')('species')] = function(exec){ exec(empty, empty); };\n    // unhandled rejections tracking support, NodeJS Promise without it fails @@species test\n    return (isNode || typeof PromiseRejectionEvent == 'function') && promise.then(empty) instanceof FakePromise;\n  } catch(e){ /* empty */ }\n}();\n\n// helpers\nvar sameConstructor = function(a, b){\n  // with library wrapper special case\n  return a === b || a === $Promise && b === Wrapper;\n};\nvar isThenable = function(it){\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\nvar newPromiseCapability = function(C){\n  return sameConstructor($Promise, C)\n    ? new PromiseCapability(C)\n    : new GenericPromiseCapability(C);\n};\nvar PromiseCapability = GenericPromiseCapability = function(C){\n  var resolve, reject;\n  this.promise = new C(function($$resolve, $$reject){\n    if(resolve !== undefined || reject !== undefined)throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject  = $$reject;\n  });\n  this.resolve = aFunction(resolve);\n  this.reject  = aFunction(reject);\n};\nvar perform = function(exec){\n  try {\n    exec();\n  } catch(e){\n    return {error: e};\n  }\n};\nvar notify = function(promise, isReject){\n  if(promise._n)return;\n  promise._n = true;\n  var chain = promise._c;\n  microtask(function(){\n    var value = promise._v\n      , ok    = promise._s == 1\n      , i     = 0;\n    var run = function(reaction){\n      var handler = ok ? reaction.ok : reaction.fail\n        , resolve = reaction.resolve\n        , reject  = reaction.reject\n        , domain  = reaction.domain\n        , result, then;\n      try {\n        if(handler){\n          if(!ok){\n            if(promise._h == 2)onHandleUnhandled(promise);\n            promise._h = 1;\n          }\n          if(handler === true)result = value;\n          else {\n            if(domain)domain.enter();\n            result = handler(value);\n            if(domain)domain.exit();\n          }\n          if(result === reaction.promise){\n            reject(TypeError('Promise-chain cycle'));\n          } else if(then = isThenable(result)){\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch(e){\n        reject(e);\n      }\n    };\n    while(chain.length > i)run(chain[i++]); // variable length - can't use forEach\n    promise._c = [];\n    promise._n = false;\n    if(isReject && !promise._h)onUnhandled(promise);\n  });\n};\nvar onUnhandled = function(promise){\n  task.call(global, function(){\n    var value = promise._v\n      , abrupt, handler, console;\n    if(isUnhandled(promise)){\n      abrupt = perform(function(){\n        if(isNode){\n          process.emit('unhandledRejection', value, promise);\n        } else if(handler = global.onunhandledrejection){\n          handler({promise: promise, reason: value});\n        } else if((console = global.console) && console.error){\n          console.error('Unhandled promise rejection', value);\n        }\n      });\n      // Browsers should not trigger `rejectionHandled` event if it was handled here, NodeJS - should\n      promise._h = isNode || isUnhandled(promise) ? 2 : 1;\n    } promise._a = undefined;\n    if(abrupt)throw abrupt.error;\n  });\n};\nvar isUnhandled = function(promise){\n  if(promise._h == 1)return false;\n  var chain = promise._a || promise._c\n    , i     = 0\n    , reaction;\n  while(chain.length > i){\n    reaction = chain[i++];\n    if(reaction.fail || !isUnhandled(reaction.promise))return false;\n  } return true;\n};\nvar onHandleUnhandled = function(promise){\n  task.call(global, function(){\n    var handler;\n    if(isNode){\n      process.emit('rejectionHandled', promise);\n    } else if(handler = global.onrejectionhandled){\n      handler({promise: promise, reason: promise._v});\n    }\n  });\n};\nvar $reject = function(value){\n  var promise = this;\n  if(promise._d)return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  promise._v = value;\n  promise._s = 2;\n  if(!promise._a)promise._a = promise._c.slice();\n  notify(promise, true);\n};\nvar $resolve = function(value){\n  var promise = this\n    , then;\n  if(promise._d)return;\n  promise._d = true;\n  promise = promise._w || promise; // unwrap\n  try {\n    if(promise === value)throw TypeError(\"Promise can't be resolved itself\");\n    if(then = isThenable(value)){\n      microtask(function(){\n        var wrapper = {_w: promise, _d: false}; // wrap\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch(e){\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      promise._v = value;\n      promise._s = 1;\n      notify(promise, false);\n    }\n  } catch(e){\n    $reject.call({_w: promise, _d: false}, e); // wrap\n  }\n};\n\n// constructor polyfill\nif(!USE_NATIVE){\n  // 25.4.3.1 Promise(executor)\n  $Promise = function Promise(executor){\n    anInstance(this, $Promise, PROMISE, '_h');\n    aFunction(executor);\n    Internal.call(this);\n    try {\n      executor(ctx($resolve, this, 1), ctx($reject, this, 1));\n    } catch(err){\n      $reject.call(this, err);\n    }\n  };\n  Internal = function Promise(executor){\n    this._c = [];             // <- awaiting reactions\n    this._a = undefined;      // <- checked in isUnhandled reactions\n    this._s = 0;              // <- state\n    this._d = false;          // <- done\n    this._v = undefined;      // <- value\n    this._h = 0;              // <- rejection state, 0 - default, 1 - handled, 2 - unhandled\n    this._n = false;          // <- notify\n  };\n  Internal.prototype = require('./_redefine-all')($Promise.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected){\n      var reaction    = newPromiseCapability(speciesConstructor(this, $Promise));\n      reaction.ok     = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail   = typeof onRejected == 'function' && onRejected;\n      reaction.domain = isNode ? process.domain : undefined;\n      this._c.push(reaction);\n      if(this._a)this._a.push(reaction);\n      if(this._s)notify(this, false);\n      return reaction.promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function(onRejected){\n      return this.then(undefined, onRejected);\n    }\n  });\n  PromiseCapability = function(){\n    var promise  = new Internal;\n    this.promise = promise;\n    this.resolve = ctx($resolve, promise, 1);\n    this.reject  = ctx($reject, promise, 1);\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, {Promise: $Promise});\nrequire('./_set-to-string-tag')($Promise, PROMISE);\nrequire('./_set-species')(PROMISE);\nWrapper = require('./_core')[PROMISE];\n\n// statics\n$export($export.S + $export.F * !USE_NATIVE, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r){\n    var capability = newPromiseCapability(this)\n      , $$reject   = capability.reject;\n    $$reject(r);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * (LIBRARY || !USE_NATIVE), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x){\n    // instanceof instead of internal slot check because we should fix it without replacement native Promise core\n    if(x instanceof $Promise && sameConstructor(x.constructor, this))return x;\n    var capability = newPromiseCapability(this)\n      , $$resolve  = capability.resolve;\n    $$resolve(x);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * !(USE_NATIVE && require('./_iter-detect')(function(iter){\n  $Promise.all(iter)['catch'](empty);\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable){\n    var C          = this\n      , capability = newPromiseCapability(C)\n      , resolve    = capability.resolve\n      , reject     = capability.reject;\n    var abrupt = perform(function(){\n      var values    = []\n        , index     = 0\n        , remaining = 1;\n      forOf(iterable, false, function(promise){\n        var $index        = index++\n          , alreadyCalled = false;\n        values.push(undefined);\n        remaining++;\n        C.resolve(promise).then(function(value){\n          if(alreadyCalled)return;\n          alreadyCalled  = true;\n          values[$index] = value;\n          --remaining || resolve(values);\n        }, reject);\n      });\n      --remaining || resolve(values);\n    });\n    if(abrupt)reject(abrupt.error);\n    return capability.promise;\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable){\n    var C          = this\n      , capability = newPromiseCapability(C)\n      , reject     = capability.reject;\n    var abrupt = perform(function(){\n      forOf(iterable, false, function(promise){\n        C.resolve(promise).then(capability.resolve, reject);\n      });\n    });\n    if(abrupt)reject(abrupt.error);\n    return capability.promise;\n  }\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es6.promise.js\n// module id = 64\n// module chunks = 0","// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = require('./_cof')\n  , TAG = require('./_wks')('toStringTag')\n  // ES3 wrong here\n  , ARG = cof(function(){ return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function(it, key){\n  try {\n    return it[key];\n  } catch(e){ /* empty */ }\n};\n\nmodule.exports = function(it){\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_classof.js\n// module id = 65\n// module chunks = 0","module.exports = function(it, Constructor, name, forbiddenField){\n  if(!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)){\n    throw TypeError(name + ': incorrect invocation!');\n  } return it;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_an-instance.js\n// module id = 66\n// module chunks = 0","var ctx         = require('./_ctx')\n  , call        = require('./_iter-call')\n  , isArrayIter = require('./_is-array-iter')\n  , anObject    = require('./_an-object')\n  , toLength    = require('./_to-length')\n  , getIterFn   = require('./core.get-iterator-method')\n  , BREAK       = {}\n  , RETURN      = {};\nvar exports = module.exports = function(iterable, entries, fn, that, ITERATOR){\n  var iterFn = ITERATOR ? function(){ return iterable; } : getIterFn(iterable)\n    , f      = ctx(fn, that, entries ? 2 : 1)\n    , index  = 0\n    , length, step, iterator, result;\n  if(typeof iterFn != 'function')throw TypeError(iterable + ' is not iterable!');\n  // fast case for arrays with default iterator\n  if(isArrayIter(iterFn))for(length = toLength(iterable.length); length > index; index++){\n    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);\n    if(result === BREAK || result === RETURN)return result;\n  } else for(iterator = iterFn.call(iterable); !(step = iterator.next()).done; ){\n    result = call(iterator, f, step.value, entries);\n    if(result === BREAK || result === RETURN)return result;\n  }\n};\nexports.BREAK  = BREAK;\nexports.RETURN = RETURN;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_for-of.js\n// module id = 67\n// module chunks = 0","// call something on iterator step with safe closing on error\nvar anObject = require('./_an-object');\nmodule.exports = function(iterator, fn, value, entries){\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch(e){\n    var ret = iterator['return'];\n    if(ret !== undefined)anObject(ret.call(iterator));\n    throw e;\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_iter-call.js\n// module id = 68\n// module chunks = 0","// check on default Array iterator\nvar Iterators  = require('./_iterators')\n  , ITERATOR   = require('./_wks')('iterator')\n  , ArrayProto = Array.prototype;\n\nmodule.exports = function(it){\n  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_is-array-iter.js\n// module id = 69\n// module chunks = 0","var classof   = require('./_classof')\n  , ITERATOR  = require('./_wks')('iterator')\n  , Iterators = require('./_iterators');\nmodule.exports = require('./_core').getIteratorMethod = function(it){\n  if(it != undefined)return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/core.get-iterator-method.js\n// module id = 70\n// module chunks = 0","// 7.3.20 SpeciesConstructor(O, defaultConstructor)\nvar anObject  = require('./_an-object')\n  , aFunction = require('./_a-function')\n  , SPECIES   = require('./_wks')('species');\nmodule.exports = function(O, D){\n  var C = anObject(O).constructor, S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? D : aFunction(S);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_species-constructor.js\n// module id = 71\n// module chunks = 0","var ctx                = require('./_ctx')\n  , invoke             = require('./_invoke')\n  , html               = require('./_html')\n  , cel                = require('./_dom-create')\n  , global             = require('./_global')\n  , process            = global.process\n  , setTask            = global.setImmediate\n  , clearTask          = global.clearImmediate\n  , MessageChannel     = global.MessageChannel\n  , counter            = 0\n  , queue              = {}\n  , ONREADYSTATECHANGE = 'onreadystatechange'\n  , defer, channel, port;\nvar run = function(){\n  var id = +this;\n  if(queue.hasOwnProperty(id)){\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listener = function(event){\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif(!setTask || !clearTask){\n  setTask = function setImmediate(fn){\n    var args = [], i = 1;\n    while(arguments.length > i)args.push(arguments[i++]);\n    queue[++counter] = function(){\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id){\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if(require('./_cof')(process) == 'process'){\n    defer = function(id){\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if(MessageChannel){\n    channel = new MessageChannel;\n    port    = channel.port2;\n    channel.port1.onmessage = listener;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if(global.addEventListener && typeof postMessage == 'function' && !global.importScripts){\n    defer = function(id){\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listener, false);\n  // IE8-\n  } else if(ONREADYSTATECHANGE in cel('script')){\n    defer = function(id){\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function(){\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function(id){\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set:   setTask,\n  clear: clearTask\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_task.js\n// module id = 72\n// module chunks = 0","// fast apply, http://jsperf.lnkit.com/fast-apply/5\nmodule.exports = function(fn, args, that){\n  var un = that === undefined;\n  switch(args.length){\n    case 0: return un ? fn()\n                      : fn.call(that);\n    case 1: return un ? fn(args[0])\n                      : fn.call(that, args[0]);\n    case 2: return un ? fn(args[0], args[1])\n                      : fn.call(that, args[0], args[1]);\n    case 3: return un ? fn(args[0], args[1], args[2])\n                      : fn.call(that, args[0], args[1], args[2]);\n    case 4: return un ? fn(args[0], args[1], args[2], args[3])\n                      : fn.call(that, args[0], args[1], args[2], args[3]);\n  } return              fn.apply(that, args);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_invoke.js\n// module id = 73\n// module chunks = 0","var global    = require('./_global')\n  , macrotask = require('./_task').set\n  , Observer  = global.MutationObserver || global.WebKitMutationObserver\n  , process   = global.process\n  , Promise   = global.Promise\n  , isNode    = require('./_cof')(process) == 'process';\n\nmodule.exports = function(){\n  var head, last, notify;\n\n  var flush = function(){\n    var parent, fn;\n    if(isNode && (parent = process.domain))parent.exit();\n    while(head){\n      fn   = head.fn;\n      head = head.next;\n      try {\n        fn();\n      } catch(e){\n        if(head)notify();\n        else last = undefined;\n        throw e;\n      }\n    } last = undefined;\n    if(parent)parent.enter();\n  };\n\n  // Node.js\n  if(isNode){\n    notify = function(){\n      process.nextTick(flush);\n    };\n  // browsers with MutationObserver\n  } else if(Observer){\n    var toggle = true\n      , node   = document.createTextNode('');\n    new Observer(flush).observe(node, {characterData: true}); // eslint-disable-line no-new\n    notify = function(){\n      node.data = toggle = !toggle;\n    };\n  // environments with maybe non-completely correct, but existent Promise\n  } else if(Promise && Promise.resolve){\n    var promise = Promise.resolve();\n    notify = function(){\n      promise.then(flush);\n    };\n  // for other environments - macrotask based on:\n  // - setImmediate\n  // - MessageChannel\n  // - window.postMessag\n  // - onreadystatechange\n  // - setTimeout\n  } else {\n    notify = function(){\n      // strange IE + webpack dev server bug - use .call(global)\n      macrotask.call(global, flush);\n    };\n  }\n\n  return function(fn){\n    var task = {fn: fn, next: undefined};\n    if(last)last.next = task;\n    if(!head){\n      head = task;\n      notify();\n    } last = task;\n  };\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_microtask.js\n// module id = 74\n// module chunks = 0","var hide = require('./_hide');\nmodule.exports = function(target, src, safe){\n  for(var key in src){\n    if(safe && target[key])target[key] = src[key];\n    else hide(target, key, src[key]);\n  } return target;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_redefine-all.js\n// module id = 75\n// module chunks = 0","'use strict';\nvar global      = require('./_global')\n  , core        = require('./_core')\n  , dP          = require('./_object-dp')\n  , DESCRIPTORS = require('./_descriptors')\n  , SPECIES     = require('./_wks')('species');\n\nmodule.exports = function(KEY){\n  var C = typeof core[KEY] == 'function' ? core[KEY] : global[KEY];\n  if(DESCRIPTORS && C && !C[SPECIES])dP.f(C, SPECIES, {\n    configurable: true,\n    get: function(){ return this; }\n  });\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_set-species.js\n// module id = 76\n// module chunks = 0","var ITERATOR     = require('./_wks')('iterator')\n  , SAFE_CLOSING = false;\n\ntry {\n  var riter = [7][ITERATOR]();\n  riter['return'] = function(){ SAFE_CLOSING = true; };\n  Array.from(riter, function(){ throw 2; });\n} catch(e){ /* empty */ }\n\nmodule.exports = function(exec, skipClosing){\n  if(!skipClosing && !SAFE_CLOSING)return false;\n  var safe = false;\n  try {\n    var arr  = [7]\n      , iter = arr[ITERATOR]();\n    iter.next = function(){ return {done: safe = true}; };\n    arr[ITERATOR] = function(){ return iter; };\n    exec(arr);\n  } catch(e){ /* empty */ }\n  return safe;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_iter-detect.js\n// module id = 77\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 78\n// module chunks = 0","module.exports = require(\"parse-json\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"parse-json\"\n// module id = 79\n// module chunks = 0","module.exports = require(\"event-to-promise\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"event-to-promise\"\n// module id = 80\n// module chunks = 0","/* @flow */\nimport Watchpack from 'watchpack';\nimport debounce from 'debounce';\n\nimport {createLogger} from './util/logger';\n\n\nconst log = createLogger(__filename);\n\n\n// onSourceChange types and implementation\n\nexport type ShouldWatchFn = (filePath: string) => boolean;\n\nexport type OnChangeFn = () => any;\n\nexport type OnSourceChangeParams = {|\n  sourceDir: string,\n  artifactsDir: string,\n  onChange: OnChangeFn,\n  shouldWatchFile: ShouldWatchFn,\n|};\n\n// NOTE: this fix an issue with flow and default exports (which currently\n// lose their type signatures) by explicitly declare the default export\n// signature. Reference: https://github.com/facebook/flow/issues/449\n// eslint-disable-next-line no-shadow\ndeclare function exports(params: OnSourceChangeParams): Watchpack;\n\nexport type OnSourceChangeFn = (params: OnSourceChangeParams) => Watchpack;\n\nexport default function onSourceChange(\n  {sourceDir, artifactsDir, onChange, shouldWatchFile}: OnSourceChangeParams\n): Watchpack {\n  // TODO: For network disks, we would need to add {poll: true}.\n  const watcher = new Watchpack();\n\n  const executeImmediately = true;\n  onChange = debounce(onChange, 1000, executeImmediately);\n\n  watcher.on('change', (filePath) => {\n    proxyFileChanges({artifactsDir, onChange, filePath, shouldWatchFile});\n  });\n\n  log.debug(`Watching for file changes in ${sourceDir}`);\n  watcher.watch([], [sourceDir], Date.now());\n\n  // TODO: support interrupting the watcher on Windows.\n  // https://github.com/mozilla/web-ext/issues/225\n  process.on('SIGINT', () => watcher.close());\n  return watcher;\n}\n\n\n// proxyFileChanges types and implementation.\n\nexport type ProxyFileChangesParams = {|\n  artifactsDir: string,\n  onChange: OnChangeFn,\n  filePath: string,\n  shouldWatchFile: ShouldWatchFn,\n|};\n\nexport function proxyFileChanges(\n  {artifactsDir, onChange, filePath, shouldWatchFile}: ProxyFileChangesParams\n): void {\n  if (filePath.indexOf(artifactsDir) === 0 || !shouldWatchFile(filePath)) {\n    log.debug(`Ignoring change to: ${filePath}`);\n  } else {\n    log.debug(`Changed: ${filePath}`);\n    log.debug(`Last change detection: ${(new Date()).toTimeString()}`);\n    onChange();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/watcher.js","module.exports = require(\"watchpack\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"watchpack\"\n// module id = 82\n// module chunks = 0","module.exports = require(\"debounce\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"debounce\"\n// module id = 83\n// module chunks = 0","/* @flow */\nimport bunyan, {nameFromLevel, createLogger as defaultLogCreator}\n  from 'bunyan';\n\n\n// Bunyan-related Flow types\n\nexport type TRACE = 10;\nexport type DEBUG = 20;\nexport type INFO = 30;\nexport type WARN = 40;\nexport type ERROR = 50;\nexport type FATAL = 60;\n\nexport type BunyanLogLevel =\n  TRACE | DEBUG | INFO | WARN | ERROR | FATAL;\n\nexport type BunyanLogEntry = {|\n  name: string,\n  msg: string,\n  level: BunyanLogLevel,\n|};\n\nexport type Logger = {\n  debug: (msg: string) => void,\n  error: (msg: string) => void,\n  info: (msg: string) => void,\n  warn: (msg: string) => void,\n};\n\n\n// ConsoleStream types and implementation.\n\nexport type ConsoleStreamParams = {|\n  verbose?: boolean,\n|};\n\nexport type ConsoleOptions = {|\n  localProcess?: typeof process,\n|};\n\nexport class ConsoleStream {\n  verbose: boolean;\n  isCapturing: boolean;\n  capturedMessages: Array<string>;\n\n  constructor({verbose = false}: ConsoleStreamParams = {}) {\n    this.verbose = verbose;\n    this.isCapturing = false;\n    this.capturedMessages = [];\n  }\n\n  format({name, msg, level}: BunyanLogEntry): string {\n    const prefix = this.verbose ? `[${name}][${nameFromLevel[level]}] ` : '';\n    return `${prefix}${msg}\\n`;\n  }\n\n  makeVerbose() {\n    this.verbose = true;\n  }\n\n  write(\n    packet: BunyanLogEntry,\n    {localProcess = process}: ConsoleOptions = {}\n  ): void {\n    const thisLevel: BunyanLogLevel = this.verbose ? bunyan.TRACE : bunyan.INFO;\n    if (packet.level >= thisLevel) {\n      const msg = this.format(packet);\n      if (this.isCapturing) {\n        this.capturedMessages.push(msg);\n      } else {\n        localProcess.stdout.write(msg);\n      }\n    }\n  }\n\n  startCapturing() {\n    this.isCapturing = true;\n  }\n\n  stopCapturing() {\n    this.isCapturing = false;\n    this.capturedMessages = [];\n  }\n\n  flushCapturedLogs({localProcess = process}: ConsoleOptions = {}) {\n    for (const msg of this.capturedMessages) {\n      localProcess.stdout.write(msg);\n    }\n    this.capturedMessages = [];\n  }\n}\n\nexport const consoleStream = new ConsoleStream();\n\n\n// createLogger types and implementation.\n\nexport type BunyanStreamConfig = {|\n  type: string,\n  stream: ConsoleStream,\n|};\n\nexport type CreateBunyanLogParams = {|\n  name: string,\n  level: BunyanLogLevel,\n  streams: Array<BunyanStreamConfig>,\n|};\n\nexport type CreateBunyanLogFn = (params: CreateBunyanLogParams) => Logger;\n\nexport type CreateLoggerOptions = {|\n  createBunyanLog: CreateBunyanLogFn,\n|};\n\nexport function createLogger(\n  filename: string,\n  {createBunyanLog = defaultLogCreator}: CreateLoggerOptions = {}\n): Logger {\n  return createBunyanLog({\n    // Strip the leading src/ from file names (which is in all file names) to\n    // make the name less redundant.\n    name: filename.replace(/^src\\//, ''),\n    // Capture all log levels and let the stream filter them.\n    level: bunyan.TRACE,\n    streams: [{\n      type: 'raw',\n      stream: consoleStream,\n    }],\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/logger.js","\"use strict\";\n\nexports.__esModule = true;\n\nexports.default = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/classCallCheck.js\n// module id = 85\n// module chunks = 0","\"use strict\";\n\nexports.__esModule = true;\n\nvar _defineProperty = require(\"../core-js/object/define-property\");\n\nvar _defineProperty2 = _interopRequireDefault(_defineProperty);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      (0, _defineProperty2.default)(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/createClass.js\n// module id = 86\n// module chunks = 0","module.exports = { \"default\": require(\"core-js/library/fn/object/define-property\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/define-property.js\n// module id = 87\n// module chunks = 0","require('../../modules/es6.object.define-property');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function defineProperty(it, key, desc){\n  return $Object.defineProperty(it, key, desc);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/object/define-property.js\n// module id = 88\n// module chunks = 0","var $export = require('./_export');\n// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)\n$export($export.S + $export.F * !require('./_descriptors'), 'Object', {defineProperty: require('./_object-dp').f});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es6.object.define-property.js\n// module id = 89\n// module chunks = 0","module.exports = require(\"bunyan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bunyan\"\n// module id = 90\n// module chunks = 0","/* @flow */\nimport zipDirModule from 'zip-dir';\nimport promisify from 'es6-promisify';\n\nexport const zipDir = promisify(zipDirModule);\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/zip-dir.js","module.exports = require(\"zip-dir\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"zip-dir\"\n// module id = 92\n// module chunks = 0","module.exports = require(\"es6-promisify\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"es6-promisify\"\n// module id = 93\n// module chunks = 0","/* @flow */\nimport path from 'path';\n\nimport {fs} from 'mz';\nimport parseJSON from 'parse-json';\n\nimport {InvalidManifest} from '../errors';\nimport {createLogger} from './logger';\n\nconst log = createLogger(__filename);\n\n\n// getValidatedManifest helper types and implementation\n\nexport type ExtensionManifestApplications = {|\n  gecko: {|\n    id?: string,\n    strict_min_version?: string,\n    strict_max_version?: string,\n    update_url?: string,\n  |},\n|};\n\nexport type ExtensionManifest = {|\n  name: string,\n  version: string,\n  default_locale?: string,\n  applications?: ExtensionManifestApplications,\n|};\n\nexport default async function getValidatedManifest(\n  sourceDir: string\n): Promise<ExtensionManifest> {\n  const manifestFile = path.join(sourceDir, 'manifest.json');\n  log.debug(`Validating manifest at ${manifestFile}`);\n\n  let manifestContents;\n\n  try {\n    manifestContents = await fs.readFile(manifestFile);\n  } catch (error) {\n    throw new InvalidManifest(\n      `Could not read manifest.json file at ${manifestFile}: ${error}`);\n  }\n\n  let manifestData;\n\n  try {\n    manifestData = parseJSON(manifestContents, manifestFile);\n  } catch (error) {\n    throw new InvalidManifest(\n      `Error parsing manifest.json at ${manifestFile}: ${error}`);\n  }\n\n  const errors = [];\n  // This is just some basic validation of what web-ext needs, not\n  // what Firefox will need to run the extension.\n  // TODO: integrate with the addons-linter for actual validation.\n  if (!manifestData.name) {\n    errors.push('missing \"name\" property');\n  }\n  if (!manifestData.version) {\n    errors.push('missing \"version\" property');\n  }\n\n  if (manifestData.applications && !manifestData.applications.gecko) {\n    // Since the applications property only applies to gecko, make\n    // sure 'gecko' exists when 'applications' is defined. This should\n    // make introspection of gecko properties easier.\n    errors.push('missing \"applications.gecko\" property');\n  }\n\n  if (errors.length) {\n    throw new InvalidManifest(\n      `Manifest at ${manifestFile} is invalid: ${errors.join('; ')}`);\n  }\n\n  return manifestData;\n}\n\n\nexport function getManifestId(manifestData: ExtensionManifest): string | void {\n  return manifestData.applications ?\n    manifestData.applications.gecko.id : undefined;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/manifest.js","/* @flow */\nimport ExtendableError from 'es6-error';\n\n\n/*\n * Base error for all custom web-ext errors.\n */\nexport class WebExtError extends ExtendableError {\n  constructor(message: string) {\n    super(message);\n  }\n}\n\n\n/*\n * The class for errors that can be fixed by the developer.\n */\nexport class UsageError extends WebExtError {\n  constructor(message: string) {\n    super(message);\n  }\n}\n\n\n/*\n * The manifest for the extension is invalid (or missing).\n */\nexport class InvalidManifest extends UsageError {\n  constructor(message: string) {\n    super(message);\n  }\n}\n\n\n/*\n * The remote Firefox does not support temporary add-on installation.\n */\nexport class RemoteTempInstallNotSupported extends WebExtError {\n  constructor(message: string) {\n    super(message);\n  }\n}\n\n\n/*\n * Sugar-y way to catch only instances of a certain error.\n *\n * Usage:\n *\n *  Promise.reject(SyntaxError)\n *    .catch(onlyInstancesOf(SyntaxError, (error) => {\n *      // error is guaranteed to be an instance of SyntaxError\n *    }))\n *\n * All other errors will be re-thrown.\n *\n */\nexport function onlyInstancesOf(\n  predicate: Function, errorHandler: Function\n): Function {\n  return (error) => {\n    if (error instanceof predicate) {\n      return errorHandler(error);\n    } else {\n      throw error;\n    }\n  };\n}\n\n\n/*\n * Sugar-y way to catch only errors having certain code(s).\n *\n * Usage:\n *\n *  Promise.resolve()\n *    .catch(onlyErrorsWithCode('ENOENT', (error) => {\n *      // error.code is guaranteed to be ENOENT\n *    }))\n *\n *  or:\n *\n *  Promise.resolve()\n *    .catch(onlyErrorsWithCode(['ENOENT', 'ENOTDIR'], (error) => {\n *      // ...\n *    }))\n *\n * All other errors will be re-thrown.\n *\n */\nexport function onlyErrorsWithCode(\n  codeWanted: (string | number) | Array<string | number>,\n  errorHandler: Function\n): Function {\n  return (error) => {\n    let throwError = true;\n\n    if (Array.isArray(codeWanted)) {\n      if (codeWanted.indexOf(error.code) !== -1 ||\n          codeWanted.indexOf(error.errno) !== -1) {\n        throwError = false;\n      }\n    } else if (error.code === codeWanted || error.errno === codeWanted) {\n      throwError = false;\n    }\n\n    if (throwError) {\n      throw error;\n    }\n\n    return errorHandler(error);\n  };\n}\n\nexport function isErrorWithCode(\n  codeWanted: string | Array<string>,\n  error: Object,\n): boolean {\n  if (Array.isArray(codeWanted) && codeWanted.indexOf(error.code) !== -1) {\n    return true;\n  } else if (error.code === codeWanted) {\n    return true;\n  }\n\n  return false;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/errors.js","\"use strict\";\n\nexports.__esModule = true;\n\nvar _typeof2 = require(\"../helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && ((typeof call === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(call)) === \"object\" || typeof call === \"function\") ? call : self;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/possibleConstructorReturn.js\n// module id = 96\n// module chunks = 0","\"use strict\";\n\nexports.__esModule = true;\n\nvar _iterator = require(\"../core-js/symbol/iterator\");\n\nvar _iterator2 = _interopRequireDefault(_iterator);\n\nvar _symbol = require(\"../core-js/symbol\");\n\nvar _symbol2 = _interopRequireDefault(_symbol);\n\nvar _typeof = typeof _symbol2.default === \"function\" && typeof _iterator2.default === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = typeof _symbol2.default === \"function\" && _typeof(_iterator2.default) === \"symbol\" ? function (obj) {\n  return typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n} : function (obj) {\n  return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/typeof.js\n// module id = 97\n// module chunks = 0","module.exports = { \"default\": require(\"core-js/library/fn/symbol/iterator\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/symbol/iterator.js\n// module id = 98\n// module chunks = 0","require('../../modules/es6.string.iterator');\nrequire('../../modules/web.dom.iterable');\nmodule.exports = require('../../modules/_wks-ext').f('iterator');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/symbol/iterator.js\n// module id = 99\n// module chunks = 0","exports.f = require('./_wks');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_wks-ext.js\n// module id = 100\n// module chunks = 0","module.exports = { \"default\": require(\"core-js/library/fn/symbol\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/symbol.js\n// module id = 101\n// module chunks = 0","require('../../modules/es6.symbol');\nrequire('../../modules/es6.object.to-string');\nrequire('../../modules/es7.symbol.async-iterator');\nrequire('../../modules/es7.symbol.observable');\nmodule.exports = require('../../modules/_core').Symbol;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/symbol/index.js\n// module id = 102\n// module chunks = 0","'use strict';\n// ECMAScript 6 symbols shim\nvar global         = require('./_global')\n  , has            = require('./_has')\n  , DESCRIPTORS    = require('./_descriptors')\n  , $export        = require('./_export')\n  , redefine       = require('./_redefine')\n  , META           = require('./_meta').KEY\n  , $fails         = require('./_fails')\n  , shared         = require('./_shared')\n  , setToStringTag = require('./_set-to-string-tag')\n  , uid            = require('./_uid')\n  , wks            = require('./_wks')\n  , wksExt         = require('./_wks-ext')\n  , wksDefine      = require('./_wks-define')\n  , keyOf          = require('./_keyof')\n  , enumKeys       = require('./_enum-keys')\n  , isArray        = require('./_is-array')\n  , anObject       = require('./_an-object')\n  , toIObject      = require('./_to-iobject')\n  , toPrimitive    = require('./_to-primitive')\n  , createDesc     = require('./_property-desc')\n  , _create        = require('./_object-create')\n  , gOPNExt        = require('./_object-gopn-ext')\n  , $GOPD          = require('./_object-gopd')\n  , $DP            = require('./_object-dp')\n  , $keys          = require('./_object-keys')\n  , gOPD           = $GOPD.f\n  , dP             = $DP.f\n  , gOPN           = gOPNExt.f\n  , $Symbol        = global.Symbol\n  , $JSON          = global.JSON\n  , _stringify     = $JSON && $JSON.stringify\n  , PROTOTYPE      = 'prototype'\n  , HIDDEN         = wks('_hidden')\n  , TO_PRIMITIVE   = wks('toPrimitive')\n  , isEnum         = {}.propertyIsEnumerable\n  , SymbolRegistry = shared('symbol-registry')\n  , AllSymbols     = shared('symbols')\n  , OPSymbols      = shared('op-symbols')\n  , ObjectProto    = Object[PROTOTYPE]\n  , USE_NATIVE     = typeof $Symbol == 'function'\n  , QObject        = global.QObject;\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDesc = DESCRIPTORS && $fails(function(){\n  return _create(dP({}, 'a', {\n    get: function(){ return dP(this, 'a', {value: 7}).a; }\n  })).a != 7;\n}) ? function(it, key, D){\n  var protoDesc = gOPD(ObjectProto, key);\n  if(protoDesc)delete ObjectProto[key];\n  dP(it, key, D);\n  if(protoDesc && it !== ObjectProto)dP(ObjectProto, key, protoDesc);\n} : dP;\n\nvar wrap = function(tag){\n  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);\n  sym._k = tag;\n  return sym;\n};\n\nvar isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function(it){\n  return typeof it == 'symbol';\n} : function(it){\n  return it instanceof $Symbol;\n};\n\nvar $defineProperty = function defineProperty(it, key, D){\n  if(it === ObjectProto)$defineProperty(OPSymbols, key, D);\n  anObject(it);\n  key = toPrimitive(key, true);\n  anObject(D);\n  if(has(AllSymbols, key)){\n    if(!D.enumerable){\n      if(!has(it, HIDDEN))dP(it, HIDDEN, createDesc(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if(has(it, HIDDEN) && it[HIDDEN][key])it[HIDDEN][key] = false;\n      D = _create(D, {enumerable: createDesc(0, false)});\n    } return setSymbolDesc(it, key, D);\n  } return dP(it, key, D);\n};\nvar $defineProperties = function defineProperties(it, P){\n  anObject(it);\n  var keys = enumKeys(P = toIObject(P))\n    , i    = 0\n    , l = keys.length\n    , key;\n  while(l > i)$defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\nvar $create = function create(it, P){\n  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n};\nvar $propertyIsEnumerable = function propertyIsEnumerable(key){\n  var E = isEnum.call(this, key = toPrimitive(key, true));\n  if(this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key))return false;\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n};\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key){\n  it  = toIObject(it);\n  key = toPrimitive(key, true);\n  if(it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key))return;\n  var D = gOPD(it, key);\n  if(D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key]))D.enumerable = true;\n  return D;\n};\nvar $getOwnPropertyNames = function getOwnPropertyNames(it){\n  var names  = gOPN(toIObject(it))\n    , result = []\n    , i      = 0\n    , key;\n  while(names.length > i){\n    if(!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META)result.push(key);\n  } return result;\n};\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it){\n  var IS_OP  = it === ObjectProto\n    , names  = gOPN(IS_OP ? OPSymbols : toIObject(it))\n    , result = []\n    , i      = 0\n    , key;\n  while(names.length > i){\n    if(has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true))result.push(AllSymbols[key]);\n  } return result;\n};\n\n// 19.4.1.1 Symbol([description])\nif(!USE_NATIVE){\n  $Symbol = function Symbol(){\n    if(this instanceof $Symbol)throw TypeError('Symbol is not a constructor!');\n    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);\n    var $set = function(value){\n      if(this === ObjectProto)$set.call(OPSymbols, value);\n      if(has(this, HIDDEN) && has(this[HIDDEN], tag))this[HIDDEN][tag] = false;\n      setSymbolDesc(this, tag, createDesc(1, value));\n    };\n    if(DESCRIPTORS && setter)setSymbolDesc(ObjectProto, tag, {configurable: true, set: $set});\n    return wrap(tag);\n  };\n  redefine($Symbol[PROTOTYPE], 'toString', function toString(){\n    return this._k;\n  });\n\n  $GOPD.f = $getOwnPropertyDescriptor;\n  $DP.f   = $defineProperty;\n  require('./_object-gopn').f = gOPNExt.f = $getOwnPropertyNames;\n  require('./_object-pie').f  = $propertyIsEnumerable;\n  require('./_object-gops').f = $getOwnPropertySymbols;\n\n  if(DESCRIPTORS && !require('./_library')){\n    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n  }\n\n  wksExt.f = function(name){\n    return wrap(wks(name));\n  }\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, {Symbol: $Symbol});\n\nfor(var symbols = (\n  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14\n  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'\n).split(','), i = 0; symbols.length > i; )wks(symbols[i++]);\n\nfor(var symbols = $keys(wks.store), i = 0; symbols.length > i; )wksDefine(symbols[i++]);\n\n$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {\n  // 19.4.2.1 Symbol.for(key)\n  'for': function(key){\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // 19.4.2.5 Symbol.keyFor(sym)\n  keyFor: function keyFor(key){\n    if(isSymbol(key))return keyOf(SymbolRegistry, key);\n    throw TypeError(key + ' is not a symbol!');\n  },\n  useSetter: function(){ setter = true; },\n  useSimple: function(){ setter = false; }\n});\n\n$export($export.S + $export.F * !USE_NATIVE, 'Object', {\n  // 19.1.2.2 Object.create(O [, Properties])\n  create: $create,\n  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n  defineProperty: $defineProperty,\n  // 19.1.2.3 Object.defineProperties(O, Properties)\n  defineProperties: $defineProperties,\n  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n  // 19.1.2.7 Object.getOwnPropertyNames(O)\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// 24.3.2 JSON.stringify(value [, replacer [, space]])\n$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function(){\n  var S = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  // WebKit converts symbol values to JSON as null\n  // V8 throws on boxed symbols\n  return _stringify([S]) != '[null]' || _stringify({a: S}) != '{}' || _stringify(Object(S)) != '{}';\n})), 'JSON', {\n  stringify: function stringify(it){\n    if(it === undefined || isSymbol(it))return; // IE8 returns string on undefined\n    var args = [it]\n      , i    = 1\n      , replacer, $replacer;\n    while(arguments.length > i)args.push(arguments[i++]);\n    replacer = args[1];\n    if(typeof replacer == 'function')$replacer = replacer;\n    if($replacer || !isArray(replacer))replacer = function(key, value){\n      if($replacer)value = $replacer.call(this, key, value);\n      if(!isSymbol(value))return value;\n    };\n    args[1] = replacer;\n    return _stringify.apply($JSON, args);\n  }\n});\n\n// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)\n$Symbol[PROTOTYPE][TO_PRIMITIVE] || require('./_hide')($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n// 19.4.3.5 Symbol.prototype[@@toStringTag]\nsetToStringTag($Symbol, 'Symbol');\n// 20.2.1.9 Math[@@toStringTag]\nsetToStringTag(Math, 'Math', true);\n// 24.3.3 JSON[@@toStringTag]\nsetToStringTag(global.JSON, 'JSON', true);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es6.symbol.js\n// module id = 103\n// module chunks = 0","var META     = require('./_uid')('meta')\n  , isObject = require('./_is-object')\n  , has      = require('./_has')\n  , setDesc  = require('./_object-dp').f\n  , id       = 0;\nvar isExtensible = Object.isExtensible || function(){\n  return true;\n};\nvar FREEZE = !require('./_fails')(function(){\n  return isExtensible(Object.preventExtensions({}));\n});\nvar setMeta = function(it){\n  setDesc(it, META, {value: {\n    i: 'O' + ++id, // object ID\n    w: {}          // weak collections IDs\n  }});\n};\nvar fastKey = function(it, create){\n  // return primitive with prefix\n  if(!isObject(it))return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if(!has(it, META)){\n    // can't set metadata to uncaught frozen object\n    if(!isExtensible(it))return 'F';\n    // not necessary to add metadata\n    if(!create)return 'E';\n    // add missing metadata\n    setMeta(it);\n  // return object ID\n  } return it[META].i;\n};\nvar getWeak = function(it, create){\n  if(!has(it, META)){\n    // can't set metadata to uncaught frozen object\n    if(!isExtensible(it))return true;\n    // not necessary to add metadata\n    if(!create)return false;\n    // add missing metadata\n    setMeta(it);\n  // return hash weak collections IDs\n  } return it[META].w;\n};\n// add metadata on freeze-family methods calling\nvar onFreeze = function(it){\n  if(FREEZE && meta.NEED && isExtensible(it) && !has(it, META))setMeta(it);\n  return it;\n};\nvar meta = module.exports = {\n  KEY:      META,\n  NEED:     false,\n  fastKey:  fastKey,\n  getWeak:  getWeak,\n  onFreeze: onFreeze\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_meta.js\n// module id = 104\n// module chunks = 0","var global         = require('./_global')\n  , core           = require('./_core')\n  , LIBRARY        = require('./_library')\n  , wksExt         = require('./_wks-ext')\n  , defineProperty = require('./_object-dp').f;\nmodule.exports = function(name){\n  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});\n  if(name.charAt(0) != '_' && !(name in $Symbol))defineProperty($Symbol, name, {value: wksExt.f(name)});\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_wks-define.js\n// module id = 105\n// module chunks = 0","var getKeys   = require('./_object-keys')\n  , toIObject = require('./_to-iobject');\nmodule.exports = function(object, el){\n  var O      = toIObject(object)\n    , keys   = getKeys(O)\n    , length = keys.length\n    , index  = 0\n    , key;\n  while(length > index)if(O[key = keys[index++]] === el)return key;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_keyof.js\n// module id = 106\n// module chunks = 0","// all enumerable object keys, includes symbols\nvar getKeys = require('./_object-keys')\n  , gOPS    = require('./_object-gops')\n  , pIE     = require('./_object-pie');\nmodule.exports = function(it){\n  var result     = getKeys(it)\n    , getSymbols = gOPS.f;\n  if(getSymbols){\n    var symbols = getSymbols(it)\n      , isEnum  = pIE.f\n      , i       = 0\n      , key;\n    while(symbols.length > i)if(isEnum.call(it, key = symbols[i++]))result.push(key);\n  } return result;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_enum-keys.js\n// module id = 107\n// module chunks = 0","exports.f = Object.getOwnPropertySymbols;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-gops.js\n// module id = 108\n// module chunks = 0","exports.f = {}.propertyIsEnumerable;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-pie.js\n// module id = 109\n// module chunks = 0","// 7.2.2 IsArray(argument)\nvar cof = require('./_cof');\nmodule.exports = Array.isArray || function isArray(arg){\n  return cof(arg) == 'Array';\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_is-array.js\n// module id = 110\n// module chunks = 0","// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIObject = require('./_to-iobject')\n  , gOPN      = require('./_object-gopn').f\n  , toString  = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function(it){\n  try {\n    return gOPN(it);\n  } catch(e){\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.f = function getOwnPropertyNames(it){\n  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-gopn-ext.js\n// module id = 111\n// module chunks = 0","// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys      = require('./_object-keys-internal')\n  , hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O){\n  return $keys(O, hiddenKeys);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-gopn.js\n// module id = 112\n// module chunks = 0","var pIE            = require('./_object-pie')\n  , createDesc     = require('./_property-desc')\n  , toIObject      = require('./_to-iobject')\n  , toPrimitive    = require('./_to-primitive')\n  , has            = require('./_has')\n  , IE8_DOM_DEFINE = require('./_ie8-dom-define')\n  , gOPD           = Object.getOwnPropertyDescriptor;\n\nexports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P){\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if(IE8_DOM_DEFINE)try {\n    return gOPD(O, P);\n  } catch(e){ /* empty */ }\n  if(has(O, P))return createDesc(!pIE.f.call(O, P), O[P]);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-gopd.js\n// module id = 113\n// module chunks = 0","require('./_wks-define')('asyncIterator');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es7.symbol.async-iterator.js\n// module id = 114\n// module chunks = 0","require('./_wks-define')('observable');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es7.symbol.observable.js\n// module id = 115\n// module chunks = 0","\"use strict\";\n\nexports.__esModule = true;\n\nvar _setPrototypeOf = require(\"../core-js/object/set-prototype-of\");\n\nvar _setPrototypeOf2 = _interopRequireDefault(_setPrototypeOf);\n\nvar _create = require(\"../core-js/object/create\");\n\nvar _create2 = _interopRequireDefault(_create);\n\nvar _typeof2 = require(\"../helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + (typeof superClass === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(superClass)));\n  }\n\n  subClass.prototype = (0, _create2.default)(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf2.default ? (0, _setPrototypeOf2.default)(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/inherits.js\n// module id = 116\n// module chunks = 0","module.exports = { \"default\": require(\"core-js/library/fn/object/set-prototype-of\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/set-prototype-of.js\n// module id = 117\n// module chunks = 0","require('../../modules/es6.object.set-prototype-of');\nmodule.exports = require('../../modules/_core').Object.setPrototypeOf;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/object/set-prototype-of.js\n// module id = 118\n// module chunks = 0","// 19.1.3.19 Object.setPrototypeOf(O, proto)\nvar $export = require('./_export');\n$export($export.S, 'Object', {setPrototypeOf: require('./_set-proto').set});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es6.object.set-prototype-of.js\n// module id = 119\n// module chunks = 0","// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nvar isObject = require('./_is-object')\n  , anObject = require('./_an-object');\nvar check = function(O, proto){\n  anObject(O);\n  if(!isObject(proto) && proto !== null)throw TypeError(proto + \": can't set as prototype!\");\n};\nmodule.exports = {\n  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line\n    function(test, buggy, set){\n      try {\n        set = require('./_ctx')(Function.call, require('./_object-gopd').f(Object.prototype, '__proto__').set, 2);\n        set(test, []);\n        buggy = !(test instanceof Array);\n      } catch(e){ buggy = true; }\n      return function setPrototypeOf(O, proto){\n        check(O, proto);\n        if(buggy)O.__proto__ = proto;\n        else set(O, proto);\n        return O;\n      };\n    }({}, false) : undefined),\n  check: check\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_set-proto.js\n// module id = 120\n// module chunks = 0","module.exports = { \"default\": require(\"core-js/library/fn/object/create\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/create.js\n// module id = 121\n// module chunks = 0","require('../../modules/es6.object.create');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function create(P, D){\n  return $Object.create(P, D);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/object/create.js\n// module id = 122\n// module chunks = 0","var $export = require('./_export')\n// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\n$export($export.S, 'Object', {create: require('./_object-create')});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es6.object.create.js\n// module id = 123\n// module chunks = 0","module.exports = require(\"es6-error\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"es6-error\"\n// module id = 124\n// module chunks = 0","/* @flow */\nimport {fs} from 'mz';\nimport mkdirp from 'mkdirp';\nimport promisify from 'es6-promisify';\n\nimport {UsageError, isErrorWithCode} from '../errors';\nimport {createLogger} from './logger';\n\nconst log = createLogger(__filename);\nconst defaultAsyncMkdirp = promisify(mkdirp);\n\ntype PrepareArtifactsDirOptions = {\n  asyncMkdirp?: typeof defaultAsyncMkdirp,\n}\n\nexport async function prepareArtifactsDir(\n  artifactsDir: string,\n  {asyncMkdirp = defaultAsyncMkdirp}: PrepareArtifactsDirOptions = {},\n): Promise<string> {\n  try {\n    const stats = await fs.stat(artifactsDir);\n    if (!stats.isDirectory()) {\n      throw new UsageError(\n        `--artifacts-dir=\"${artifactsDir}\" exists but it is not a directory.`);\n    }\n    // If the artifactsDir already exists, check that we have the write permissions on it.\n    try {\n      await fs.access(artifactsDir, fs.W_OK);\n    } catch (accessErr) {\n      if (isErrorWithCode('EACCES', accessErr)) {\n        throw new UsageError(\n          `--artifacts-dir=\"${artifactsDir}\" exists but the user lacks ` +\n          'permissions on it.');\n      } else {\n        throw accessErr;\n      }\n    }\n  } catch (error) {\n    if (isErrorWithCode('EACCES', error)) {\n      // Handle errors when the artifactsDir cannot be accessed.\n      throw new UsageError(\n        `Cannot access --artifacts-dir=\"${artifactsDir}\" because the user ` +\n        `lacks permissions: ${error}`);\n    } else if (isErrorWithCode('ENOENT', error)) {\n      // Create the artifact dir if it doesn't exist yet.\n      try {\n        log.debug(`Creating artifacts directory: ${artifactsDir}`);\n        await asyncMkdirp(artifactsDir);\n      } catch (mkdirErr) {\n        if (isErrorWithCode('EACCES', mkdirErr)) {\n          // Handle errors when the artifactsDir cannot be created for lack of permissions.\n          throw new UsageError(\n            `Cannot create --artifacts-dir=\"${artifactsDir}\" because the ` +\n            `user lacks permissions: ${mkdirErr}`);\n        } else {\n          throw mkdirErr;\n        }\n      }\n    } else {\n      throw error;\n    }\n  }\n\n  return artifactsDir;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/artifacts.js","module.exports = require(\"mkdirp\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mkdirp\"\n// module id = 126\n// module chunks = 0","/* @flow */\nimport path from 'path';\n\nimport minimatch from 'minimatch';\n\nimport {createLogger} from './logger';\n\nconst log = createLogger(__filename);\n\n// check if target is a sub directory of src\nexport const isSubPath = (src: string, target: string): boolean => {\n  const relate = path.relative(src, target);\n  // same dir\n  if (!relate) {\n    return false;\n  }\n  if (relate === '..') {\n    return false;\n  }\n  return !relate.startsWith(`..${path.sep}`);\n};\n\n// FileFilter types and implementation.\n\nexport type FileFilterOptions = {|\n  baseIgnoredPatterns?: Array<string>,\n  ignoreFiles?: Array<string>,\n  sourceDir: string,\n  artifactsDir?: string,\n|};\n\n/*\n * Allows or ignores files.\n */\nexport class FileFilter {\n  filesToIgnore: Array<string>;\n  sourceDir: string;\n\n  constructor({\n    baseIgnoredPatterns = [\n      '**/*.xpi',\n      '**/*.zip',\n      '**/.*', // any hidden file and folder\n      '**/.*/**/*', // and the content inside hidden folder\n      '**/node_modules',\n      '**/node_modules/**/*',\n    ],\n    ignoreFiles = [],\n    sourceDir,\n    artifactsDir,\n  }: FileFilterOptions = {}) {\n    sourceDir = path.resolve(sourceDir);\n\n    this.filesToIgnore = [];\n    this.sourceDir = sourceDir;\n\n    this.addToIgnoreList(baseIgnoredPatterns);\n    if (ignoreFiles) {\n      this.addToIgnoreList(ignoreFiles);\n    }\n    if (artifactsDir && isSubPath(sourceDir, artifactsDir)) {\n      artifactsDir = path.resolve(artifactsDir);\n      log.debug(\n        `Ignoring artifacts directory \"${artifactsDir}\" ` +\n        'and all its subdirectories'\n      );\n      this.addToIgnoreList([\n        artifactsDir,\n        path.join(artifactsDir, '**', '*'),\n      ]);\n    }\n  }\n\n  /**\n   *  Resolve relative path to absolute path with sourceDir.\n   */\n  resolveWithSourceDir(file: string): string {\n    const resolvedPath = path.resolve(this.sourceDir, file);\n    log.debug(\n      `Resolved path ${file} with sourceDir ${this.sourceDir} ` +\n      `to ${resolvedPath}`\n    );\n    return resolvedPath;\n  }\n\n  /**\n   *  Insert more files into filesToIgnore array.\n   */\n  addToIgnoreList(files: Array<string>) {\n    for (const file of files) {\n      this.filesToIgnore.push(this.resolveWithSourceDir(file));\n    }\n  }\n\n  /*\n   * Returns true if the file is wanted.\n   *\n   * If filePath does not start with a slash, it will be treated as a path\n   * relative to sourceDir when matching it against all configured\n   * ignore-patterns.\n   *\n   * Example: this is called by zipdir as wantFile(filePath) for each\n   * file in the folder that is being archived.\n   */\n  wantFile(filePath: string): boolean {\n    const resolvedPath = this.resolveWithSourceDir(filePath);\n    for (const test of this.filesToIgnore) {\n      if (minimatch(resolvedPath, test)) {\n        log.debug(\n          `FileFilter: ignoring file ${resolvedPath} (it matched ${test})`);\n        return false;\n      }\n    }\n    return true;\n  }\n}\n\n// a helper function to make mocking easier\n\nexport const createFileFilter = (\n  (params: FileFilterOptions): FileFilter => new FileFilter(params)\n);\n\nexport type FileFilterCreatorFn = typeof createFileFilter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/file-filter.js","module.exports = require(\"minimatch\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"minimatch\"\n// module id = 128\n// module chunks = 0","/* @flow */\nimport tmp from 'tmp';\nimport promisify from 'es6-promisify';\n\nimport {createLogger} from './logger';\n\nconst log = createLogger(__filename);\n\n\n/*\n * Work with a self-destructing temporary directory in a promise chain.\n *\n * The directory will be destroyed when the promise chain is finished\n * (whether there was an error or not).\n *\n * Usage:\n *\n * withTempDir(\n *   (tmpDir) =>\n *     doSomething(tmpDir.path())\n *     .then(...)\n * );\n *\n */\nexport function withTempDir(makePromise: Function): Promise<any> {\n  const tmpDir = new TempDir();\n  return tmpDir.create()\n    .then(() => {\n      return makePromise(tmpDir);\n    })\n    .catch(tmpDir.errorHandler())\n    .then(tmpDir.successHandler());\n}\n\n\n/*\n * Work with a self-destructing temporary directory object.\n *\n * It is safer to use withTempDir() instead but if you know\n * what you're doing you can use it directly like:\n *\n * let tmpDir = new TempDir();\n * tmpDir.create()\n *   .then(() => {\n *     // work with tmpDir.path()\n *   })\n *   .catch(tmpDir.errorHandler())\n *   .then(tmpDir.successHandler());\n *\n */\nexport class TempDir {\n  _path: string | void;\n  _removeTempDir: Function | void;\n\n  constructor() {\n    this._path = undefined;\n    this._removeTempDir = undefined;\n  }\n\n  /*\n   * Returns a promise that is fulfilled when the temp directory has\n   * been created.\n   */\n  create(): Promise<TempDir> {\n    const createTempDir = promisify(tmp.dir, {multiArgs: true});\n    return createTempDir(\n      {\n        prefix: 'tmp-web-ext-',\n        // This allows us to remove a non-empty tmp dir.\n        unsafeCleanup: true,\n      })\n      .then((args) => {\n        const [tmpPath, removeTempDir] = args;\n        this._path = tmpPath;\n        this._removeTempDir = removeTempDir;\n        log.debug(`Created temporary directory: ${this.path()}`);\n        return this;\n      });\n  }\n\n  /*\n   * Get the absolute path of the temp directory.\n   */\n  path(): string {\n    if (!this._path) {\n      throw new Error('You cannot access path() before calling create()');\n    }\n    return this._path;\n  }\n\n  /*\n   * Returns a callback that will catch an error, remove\n   * the temporary directory, and throw the error.\n   *\n   * This is intended for use in a promise like\n   * Promise().catch(tmp.errorHandler())\n   */\n  errorHandler(): Function {\n    return (error) => {\n      this.remove();\n      throw error;\n    };\n  }\n\n  /*\n   * Returns a callback that will remove the temporary direcotry.\n   *\n   * This is intended for use in a promise like\n   * Promise().then(tmp.successHandler())\n   */\n  successHandler(): Function {\n    return (promiseResult) => {\n      this.remove();\n      return promiseResult;\n    };\n  }\n\n  /*\n   * Remove the temp directory.\n   */\n  remove() {\n    if (!this._removeTempDir) {\n      return;\n    }\n    log.debug(`Removing temporary directory: ${this.path()}`);\n    this._removeTempDir && this._removeTempDir();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/temp-dir.js","\"use strict\";\n\nexports.__esModule = true;\n\nvar _isIterable2 = require(\"../core-js/is-iterable\");\n\nvar _isIterable3 = _interopRequireDefault(_isIterable2);\n\nvar _getIterator2 = require(\"../core-js/get-iterator\");\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = (0, _getIterator3.default)(arr), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if ((0, _isIterable3.default)(Object(arr))) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/slicedToArray.js\n// module id = 130\n// module chunks = 0","module.exports = { \"default\": require(\"core-js/library/fn/is-iterable\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/is-iterable.js\n// module id = 131\n// module chunks = 0","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.is-iterable');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/is-iterable.js\n// module id = 132\n// module chunks = 0","var classof   = require('./_classof')\n  , ITERATOR  = require('./_wks')('iterator')\n  , Iterators = require('./_iterators');\nmodule.exports = require('./_core').isIterable = function(it){\n  var O = Object(it);\n  return O[ITERATOR] !== undefined\n    || '@@iterator' in O\n    || Iterators.hasOwnProperty(classof(O));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/core.is-iterable.js\n// module id = 133\n// module chunks = 0","module.exports = { \"default\": require(\"core-js/library/fn/get-iterator\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/get-iterator.js\n// module id = 134\n// module chunks = 0","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.get-iterator');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/get-iterator.js\n// module id = 135\n// module chunks = 0","var anObject = require('./_an-object')\n  , get      = require('./core.get-iterator-method');\nmodule.exports = require('./_core').getIterator = function(it){\n  var iterFn = get(it);\n  if(typeof iterFn != 'function')throw TypeError(it + ' is not iterable!');\n  return anObject(iterFn.call(it));\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/core.get-iterator.js\n// module id = 136\n// module chunks = 0","module.exports = require(\"tmp\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"tmp\"\n// module id = 137\n// module chunks = 0","/* @flow */\nimport path from 'path';\n\nimport sinon from 'sinon';\nimport yauzl from 'yauzl';\nimport ExtendableError from 'es6-error';\nimport promisify from 'es6-promisify';\n\nimport {createLogger} from '../../src/util/logger';\n\nconst log = createLogger(__filename);\n\n\n/*\n * A way to read zip files using promises for all the things.\n */\nexport class ZipFile {\n  _zip: any;\n  _close: Promise<void> | null;\n\n  constructor() {\n    this._zip = null;\n    this._close = null;\n  }\n\n  /*\n   * Open a zip file and return a promise that resolves to a yauzl\n   * zipfile object.\n   */\n  open(...args: Array<any>): Promise<void> {\n    return promisify(yauzl.open)(...args)\n      .then((zip) => {\n        this._zip = zip;\n        this._close = new Promise((resolve) => {\n          zip.once('close', resolve);\n        });\n      });\n  }\n\n  /**\n   * Close the zip file and wait fd to release.\n   */\n  close() {\n    this._zip.close();\n    return this._close;\n  }\n\n  /*\n   * After open(), readEach(onRead) will return a promise that resolves\n   * when all entries have been read.\n   *\n   * The onRead callback receives a single argument, a yauzl Entry object.\n   */\n  readEach(onRead: Function): Promise<void> {\n    return new Promise((resolve, reject) => {\n\n      if (!this._zip) {\n        throw new Error(\n          'Cannot operate on a falsey zip file. Call open() first.');\n      }\n\n      this._zip.on('entry', (entry) => {\n        onRead(entry);\n      });\n\n      this._zip.once('error', (error) => {\n        reject(error);\n      });\n\n      this._zip.once('end', () => {\n        resolve();\n      });\n    });\n  }\n\n  /*\n   * Resolve a promise with an array of all file names in the zip archive.\n   */\n  extractFilenames(): Promise<Array<String>> {\n    return new Promise((resolve, reject) => {\n      var fileNames = [];\n      this.readEach(\n        (entry) => {\n          fileNames.push(entry.fileName);\n        })\n        .then(() => {\n          resolve(fileNames);\n        })\n        .catch((error) => {\n          reject(error);\n        });\n    });\n  }\n}\n\n\n/*\n * Returns a path to a test fixture file. Invoke it the same as path.join().\n */\nexport function fixturePath(...pathParts: Array<string>): string {\n  return path.join(__dirname, '..', 'fixtures', ...pathParts);\n}\n\n\n/*\n * Test helper to make sure a promise chain really fails.\n *\n * Usage:\n *\n *  Promise.resolve()\n *    .then(makeSureItFails())\n *    .catch((error) => {\n *      // Safely make assertions about the error...\n *    });\n */\nexport function makeSureItFails(): Function {\n  return () => {\n    throw new Error('This test unexpectedly succeeded without an error');\n  };\n}\n\n\n/*\n * Return a fake version of an object for testing.\n *\n * The fake object will contain stub implementations of\n * all original methods. Each method will be wrapped in\n * a sinon.spy() for inspection.\n *\n * You can optionally provide implementations for one or\n * more methods.\n *\n * Unlike similar sinon helpers, this *does not* touch the\n * original object so there is no need to tear down any\n * patches afterwards.\n *\n * Usage:\n *\n * let fakeProcess = fake(process, {\n *   cwd: () => '/some/directory',\n * });\n *\n * // Use the object in real code:\n * fakeProcess.cwd();\n *\n * // Make assertions about methods that\n * // were on the original object:\n * assert.equal(fakeProcess.exit.called, true);\n *\n */\n // $FLOW_IGNORE: fake can return any kind of object and fake a defined set of methods for testing.\nexport function fake<T>(original: Object, methods: Object = {}): T {\n  var stub = {};\n\n  // Provide stubs for all original members:\n  var props = [];\n  var obj = original;\n  while (obj) {\n    props = props.concat(Object.getOwnPropertyNames(obj));\n    obj = Object.getPrototypeOf(obj);\n  }\n\n  var proto = Object.getPrototypeOf(original);\n  for (const key of props) {\n    if (!original.hasOwnProperty(key) && !proto.hasOwnProperty(key)) {\n      continue;\n    }\n    const definition = original[key] || proto[key];\n    if (typeof definition === 'function') {\n      stub[key] = () => {\n        log.warn(`Running stubbed function ${key} (default implementation)`);\n      };\n    }\n  }\n\n  // Provide custom implementations, if necessary.\n  Object.keys(methods).forEach((key) => {\n    if (!original[key]) {\n      throw new Error(\n        `Cannot define method \"${key}\"; it does not exist on the original`);\n    }\n    stub[key] = methods[key];\n  });\n\n  // Wrap all implementations in spies.\n  Object.keys(stub).forEach((key) => {\n    stub[key] = sinon.spy(stub[key]);\n  });\n\n  return stub;\n}\n\n\n/*\n * Returns a fake Firefox client as would be returned by\n * connect() of 'node-firefox-connect'\n */\n\ntype FakeFirefoxClientParams = {|\n  requestResult?: Object,\n  requestError?: Object,\n  makeRequestResult?: Object,\n  makeRequestError?: Object,\n|}\nexport function fakeFirefoxClient({\n  requestResult = {}, requestError,\n  makeRequestResult = {}, makeRequestError,\n}: FakeFirefoxClientParams= {}) {\n  return {\n    disconnect: sinon.spy(() => {}),\n    request: sinon.spy(\n      (request, callback) => callback(requestError, requestResult)),\n    // This is client.client, the actual underlying connection.\n    client: {\n      on: () => {},\n      makeRequest: sinon.spy((request, callback) => {\n        //\n        // The real function returns a response object that you\n        // use like this:\n        // if (response.error) {\n        //   ...\n        // } else {\n        //   response.something; // ...\n        // }\n        //\n        if (makeRequestError) {\n          let error;\n          if (typeof makeRequestError === 'object') {\n            error = makeRequestError;\n          } else {\n            error = {error: makeRequestError};\n          }\n          callback(error);\n        } else {\n          callback(makeRequestResult);\n        }\n      }),\n    },\n  };\n}\n\n\n/*\n * A simulated TCP connection error.\n *\n * By default, the error code will be ECONNREFUSED.\n */\nexport class TCPConnectError extends ExtendableError {\n  code: string;\n  constructor(msg: string = 'simulated connection error') {\n    super(msg);\n    this.code = 'ECONNREFUSED';\n  }\n}\n\nexport class ErrorWithCode extends Error {\n  code: string;\n  constructor(code: ?string, message: ?string) {\n    super(message || 'pretend this is a system error');\n    this.code = code || 'SOME_CODE';\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/helpers.js","module.exports = require(\"yauzl\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"yauzl\"\n// module id = 139\n// module chunks = 0","/* @flow */\nimport path from 'path';\n\nimport {describe, it} from 'mocha';\nimport {assert} from 'chai';\nimport deepcopy from 'deepcopy';\nimport {fs} from 'mz';\n\nimport {onlyInstancesOf, InvalidManifest} from '../../../src/errors';\nimport getValidatedManifest, {getManifestId} from '../../../src/util/manifest';\nimport {withTempDir} from '../../../src/util/temp-dir';\nimport {makeSureItFails} from '../helpers';\n\n\nexport const basicManifest = {\n  name: 'the extension',\n  version: '0.0.1',\n  applications: {\n    gecko: {\n      id: 'basic-manifest@web-ext-test-suite',\n    },\n  },\n};\n\nexport const manifestWithoutApps = deepcopy(basicManifest);\ndelete manifestWithoutApps.applications;\n\n\ndescribe('util/manifest', () => {\n\n  describe('getValidatedManifest', () => {\n\n    it('returns a valid manifest', () => withTempDir(\n      (tmpDir) =>\n        writeManifest(tmpDir.path(), basicManifest)\n          .then(() => getValidatedManifest(tmpDir.path()))\n          .then((manifestData) => {\n            assert.deepEqual(manifestData, basicManifest);\n          })\n    ));\n\n    it('allows manifests without an applications property', () => withTempDir(\n      (tmpDir) =>\n        writeManifest(tmpDir.path(), manifestWithoutApps)\n          .then(() => getValidatedManifest(tmpDir.path()))\n          .then((manifestData) => {\n            assert.deepEqual(manifestData, manifestWithoutApps);\n          })\n    ));\n\n    it('reports an error for a missing manifest file', () => {\n      const nonExistentDir = path.join('dev', 'null', 'nowhere');\n      return getValidatedManifest(nonExistentDir)\n        .then(makeSureItFails())\n        .catch(onlyInstancesOf(InvalidManifest, (error) => {\n          assert.match(error.message, /Could not read manifest\\.json/);\n          // Make sure the filename is included in the exception message.\n          // This is actually done by default in file system error messages.\n          assert.include(error.message, nonExistentDir);\n        }));\n    });\n\n    it('reports an error for invalid manifest JSON', () => withTempDir(\n      (tmpDir) => {\n        const badManifest = `{\n          \"name\": \"I'm an invalid JSON Manifest\n          \"version\": \"0.0.0\"\n        }`;\n        const manifestFile = path.join(tmpDir.path(), 'manifest.json');\n        return fs.writeFile(manifestFile, badManifest)\n          .then(() => getValidatedManifest(tmpDir.path()))\n          .then(makeSureItFails())\n          .catch(onlyInstancesOf(InvalidManifest, (error) => {\n            assert.match(error.message, /Error parsing manifest\\.json at /);\n            assert.include(error.message, 'Unexpected token \\' \\' at 2:49');\n            assert.include(error.message, manifestFile);\n          }));\n      }\n    ));\n\n    it('reports an error when missing a name', () => withTempDir(\n      (tmpDir) => {\n        const noNameManifest = deepcopy(basicManifest);\n        delete noNameManifest.name;\n\n        return writeManifest(tmpDir.path(), noNameManifest)\n          .then((manifestFile) => {\n            return getValidatedManifest(tmpDir.path())\n              .then(makeSureItFails())\n              .catch(onlyInstancesOf(InvalidManifest, (error) => {\n                assert.match(\n                  error.message,\n                  /Manifest at .* is invalid: missing \"name\" property/);\n                assert.include(error.message, manifestFile);\n              }));\n          });\n      }\n    ));\n\n    it('reports an error when missing version', () => withTempDir(\n      (tmpDir) => {\n        const noVersionManifest = deepcopy(basicManifest);\n        delete noVersionManifest.version;\n\n        return writeManifest(tmpDir.path(), noVersionManifest)\n          .then((manifestFile) => {\n            return getValidatedManifest(tmpDir.path())\n              .then(makeSureItFails())\n              .catch(onlyInstancesOf(InvalidManifest, (error) => {\n                assert.match(\n                  error.message,\n                  /Manifest at .* is invalid: missing \"version\" property/);\n                assert.include(error.message, manifestFile);\n              }));\n          });\n      }\n    ));\n\n    it('reports an error when missing applications.gecko', () => withTempDir(\n      (tmpDir) => {\n        const incompleteManifest = deepcopy(basicManifest);\n        delete incompleteManifest.applications.gecko;\n\n        return writeManifest(tmpDir.path(), incompleteManifest)\n          .then((manifestFile) => {\n            return getValidatedManifest(tmpDir.path())\n              .then(makeSureItFails())\n              .catch(onlyInstancesOf(InvalidManifest, (error) => {\n                assert.match(\n                  error.message,\n                  /Manifest at .* is invalid: missing \"applications.gecko\".*/);\n                assert.include(error.message, manifestFile);\n              }));\n          });\n      }\n    ));\n\n    it('allows a missing applications.gecko.id', () => withTempDir(\n      (tmpDir) => {\n        const incompleteManifest = deepcopy(basicManifest);\n        delete incompleteManifest.applications.gecko.id;\n\n        return writeManifest(tmpDir.path(), incompleteManifest)\n          .then(() => getValidatedManifest(tmpDir.path()))\n          .then((manifestData) => {\n            assert.strictEqual(getManifestId(manifestData), undefined);\n          });\n      }\n    ));\n\n    it('concatenates errors in error message', () => withTempDir(\n      (tmpDir) => {\n        const manifestWithErrors = deepcopy(basicManifest);\n        delete manifestWithErrors.name;\n        delete manifestWithErrors.version;\n\n        return writeManifest(tmpDir.path(), manifestWithErrors)\n          .then(() => {\n            return getValidatedManifest(tmpDir.path())\n              .then(makeSureItFails())\n              .catch(onlyInstancesOf(InvalidManifest, (error) => {\n                assert.match(\n                  error.message,\n                  /missing \"name\" property; missing \"version\" property/);\n              }));\n          });\n      }\n    ));\n\n  });\n\n  describe('getManifestId', () => {\n\n    it('returns a gecko ID', () => {\n      assert.equal(getManifestId(basicManifest),\n                   'basic-manifest@web-ext-test-suite');\n    });\n\n    it('returns undefined when ID is not specified', () => {\n      assert.strictEqual(getManifestId(manifestWithoutApps), undefined);\n    });\n\n  });\n\n});\n\n\nfunction writeManifest(destDir, manifestData) {\n  const manifestFile = path.join(destDir, 'manifest.json');\n  return fs.writeFile(manifestFile, JSON.stringify(manifestData))\n    .then(() => manifestFile);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-util/test.manifest.js","module.exports = require(\"deepcopy\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"deepcopy\"\n// module id = 141\n// module chunks = 0","/* @flow */\nimport {it, describe} from 'mocha';\nimport sinon from 'sinon';\nimport {assert} from 'chai';\n\nimport {makeSureItFails} from '../helpers';\nimport defaultDocsCommand, {url} from '../../../src/cmd/docs';\n\ndescribe('docs', () => {\n  it('passes the correct url to docs', () => {\n    const openUrl = sinon.spy((urlToOpen, callback) => callback(null));\n    return defaultDocsCommand({}, {openUrl}).then(() => {\n      assert.ok(openUrl.called);\n      assert.equal(openUrl.firstCall.args[0], url);\n    });\n  });\n\n  it('throws an error when open fails', () => {\n    const openUrl = sinon.spy((urlToOpen, callback) => callback(\n      new Error('pretends this is an error from open()')\n    ));\n    return defaultDocsCommand({}, {openUrl})\n      .then(makeSureItFails()).catch((error) => {\n        assert.match(error.message, /error from open()/);\n      });\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-cmd/test.docs.js","/* @flow */\nimport defaultUrlOpener from 'open';\n\nimport {createLogger} from '../util/logger';\n\nconst log = createLogger(__filename);\n\ntype DocsOptions = {\n  openUrl?: typeof defaultUrlOpener,\n}\n\nexport const url = 'https://developer.mozilla.org/en-US/Add-ons' +\n  '/WebExtensions/Getting_started_with_web-ext';\n\nexport default function docs(\n  params: Object, {openUrl = defaultUrlOpener}: DocsOptions = {}\n) {\n  return new Promise((resolve, reject) => {\n    openUrl(url, (error) => {\n      if (error) {\n        log.debug(`Encountered an error while opening URL ${url}`, error);\n        reject(error);\n      } else {\n        resolve();\n      }\n    });\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/cmd/docs.js","module.exports = require(\"open\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"open\"\n// module id = 144\n// module chunks = 0","/* @flow */\nimport {it, describe} from 'mocha';\nimport {assert} from 'chai';\nimport sinon from 'sinon';\n\nimport defaultLintCommand from '../../../src/cmd/lint';\nimport {makeSureItFails} from '../helpers';\n\ntype setUpParams = {|\n  createLinter?: Function,\n  createFileFilter?: Function,\n|}\n\ndescribe('lint', () => {\n\n  function setUp({createLinter, createFileFilter}: setUpParams = {}) {\n    const lintResult = '<lint.run() result placeholder>';\n    const runLinter = sinon.spy(() => Promise.resolve(lintResult));\n    if (!createLinter) {\n      createLinter = sinon.spy(() => {\n        return {run: runLinter};\n      });\n    }\n    return {\n      lintResult,\n      createLinter,\n      runLinter,\n      lint: (params = {}) => {\n        return defaultLintCommand({\n          sourceDir: '/fake/source/dir',\n          ...params,\n        }, {\n          createLinter,\n          createFileFilter,\n        });\n      },\n    };\n  }\n\n  it('creates and runs a linter', () => {\n    const {lint, createLinter, runLinter, lintResult} = setUp();\n    return lint().then((actualLintResult) => {\n      assert.equal(actualLintResult, lintResult);\n      assert.equal(createLinter.called, true);\n      assert.equal(runLinter.called, true);\n    });\n  });\n\n  it('fails when the linter fails', () => {\n    const createLinter = () => {\n      return {\n        run: () => Promise.reject(new Error('some error from the linter')),\n      };\n    };\n    const {lint} = setUp({createLinter});\n    return lint().then(makeSureItFails(), (error) => {\n      assert.match(error.message, /error from the linter/);\n    });\n  });\n\n  it('runs as a binary', () => {\n    const {lint, createLinter} = setUp();\n    return lint().then(() => {\n      const args = createLinter.firstCall.args[0];\n      assert.equal(args.runAsBinary, true);\n    });\n  });\n\n  it('passes sourceDir to the linter', () => {\n    const {lint, createLinter} = setUp();\n    return lint({sourceDir: '/some/path'}).then(() => {\n      const config = createLinter.firstCall.args[0].config;\n      assert.equal(config._[0], '/some/path');\n    });\n  });\n\n  it('passes warningsAsErrors to the linter', () => {\n    const {lint, createLinter} = setUp();\n    return lint({warningsAsErrors: true}).then(() => {\n      const config = createLinter.firstCall.args[0].config;\n      assert.equal(config.warningsAsErrors, true);\n    });\n  });\n\n  it('passes warningsAsErrors undefined to the linter', () => {\n    const {lint, createLinter} = setUp();\n    return lint().then(() => {\n      const config = createLinter.firstCall.args[0].config;\n      assert.equal(config.warningsAsErrors, undefined);\n    });\n  });\n\n  it('configures the linter when verbose', () => {\n    const {lint, createLinter} = setUp();\n    return lint({verbose: true}).then(() => {\n      const config = createLinter.firstCall.args[0].config;\n      assert.equal(config.logLevel, 'debug');\n      assert.equal(config.stack, true);\n    });\n  });\n\n  it('configures the linter when not verbose', () => {\n    const {lint, createLinter} = setUp();\n    return lint({verbose: false}).then(() => {\n      const config = createLinter.firstCall.args[0].config;\n      assert.equal(config.logLevel, 'fatal');\n      assert.equal(config.stack, false);\n    });\n  });\n\n  it('passes through linter configuration', () => {\n    const {lint, createLinter} = setUp();\n    return lint({\n      pretty: true,\n      metadata: true,\n      output: 'json',\n      boring: true,\n      selfHosted: true,\n    }).then(() => {\n      const config = createLinter.firstCall.args[0].config;\n      assert.strictEqual(config.pretty, true);\n      assert.strictEqual(config.metadata, true);\n      assert.strictEqual(config.output, 'json');\n      assert.strictEqual(config.boring, true);\n      assert.strictEqual(config.selfHosted, true);\n    });\n  });\n\n  it('configures a lint command with the expected fileFilter', () => {\n    const fileFilter = {wantFile: sinon.spy(() => true)};\n    const createFileFilter = sinon.spy(() => fileFilter);\n    const {lint, createLinter} = setUp({createFileFilter});\n    const params = {\n      sourceDir: '.',\n      artifactsDir: 'artifacts',\n      ignoreFiles: ['file1', '**/file2'],\n    };\n    return lint(params).then(() => {\n      assert.ok(createFileFilter.called);\n      assert.deepEqual(createFileFilter.firstCall.args[0], params);\n\n      assert.ok(createLinter.called);\n      const {shouldScanFile} = createLinter.firstCall.args[0].config;\n      shouldScanFile('path/to/file');\n      assert.ok(fileFilter.wantFile.called);\n      assert.equal(fileFilter.wantFile.firstCall.args[0], 'path/to/file');\n    });\n  });\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-cmd/test.lint.js","\"use strict\";\n\nexports.__esModule = true;\n\nvar _assign = require(\"../core-js/object/assign\");\n\nvar _assign2 = _interopRequireDefault(_assign);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _assign2.default || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/extends.js\n// module id = 146\n// module chunks = 0","module.exports = { \"default\": require(\"core-js/library/fn/object/assign\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/assign.js\n// module id = 147\n// module chunks = 0","require('../../modules/es6.object.assign');\nmodule.exports = require('../../modules/_core').Object.assign;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/object/assign.js\n// module id = 148\n// module chunks = 0","// 19.1.3.1 Object.assign(target, source)\nvar $export = require('./_export');\n\n$export($export.S + $export.F, 'Object', {assign: require('./_object-assign')});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es6.object.assign.js\n// module id = 149\n// module chunks = 0","'use strict';\n// 19.1.2.1 Object.assign(target, source, ...)\nvar getKeys  = require('./_object-keys')\n  , gOPS     = require('./_object-gops')\n  , pIE      = require('./_object-pie')\n  , toObject = require('./_to-object')\n  , IObject  = require('./_iobject')\n  , $assign  = Object.assign;\n\n// should work with symbols and should have deterministic property order (V8 bug)\nmodule.exports = !$assign || require('./_fails')(function(){\n  var A = {}\n    , B = {}\n    , S = Symbol()\n    , K = 'abcdefghijklmnopqrst';\n  A[S] = 7;\n  K.split('').forEach(function(k){ B[k] = k; });\n  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;\n}) ? function assign(target, source){ // eslint-disable-line no-unused-vars\n  var T     = toObject(target)\n    , aLen  = arguments.length\n    , index = 1\n    , getSymbols = gOPS.f\n    , isEnum     = pIE.f;\n  while(aLen > index){\n    var S      = IObject(arguments[index++])\n      , keys   = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S)\n      , length = keys.length\n      , j      = 0\n      , key;\n    while(length > j)if(isEnum.call(S, key = keys[j++]))T[key] = S[key];\n  } return T;\n} : $assign;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-assign.js\n// module id = 150\n// module chunks = 0","/* @flow */\nimport {createInstance as defaultLinterCreator} from 'addons-linter';\n\nimport {createLogger} from '../util/logger';\nimport {\n  createFileFilter as defaultFileFilterCreator,\n} from '../util/file-filter';\n// import flow types\nimport type {FileFilterCreatorFn} from '../util/file-filter';\n\nconst log = createLogger(__filename);\n\n\n// Define the needed 'addons-linter' module flow types.\n\nexport type LinterOutputType = 'text' | 'json';\n\nexport type LinterCreatorParams = {|\n  config: {|\n    logLevel: 'debug' | 'fatal',\n    stack: boolean,\n    pretty?: boolean,\n    warningsAsErrors?: boolean,\n    metadata?: boolean,\n    output?: LinterOutputType,\n    boring?: boolean,\n    selfHosted?: boolean,\n    shouldScanFile: (fileName: string) => boolean,\n    _: Array<string>,\n  |},\n  runAsBinary: boolean,\n|};\n\nexport type Linter = {|\n  run: () => Promise<void>,\n|};\n\nexport type LinterCreatorFn = (params: LinterCreatorParams) => Linter;\n\n\n// Lint command types and implementation.\n\nexport type LintCmdParams = {|\n  sourceDir: string,\n  verbose?: boolean,\n  selfHosted?: boolean,\n  boring?: boolean,\n  output?: LinterOutputType,\n  metadata?: boolean,\n  pretty?: boolean,\n  warningsAsErrors?: boolean,\n  ignoreFiles?: Array<string>,\n  artifactsDir?: string,\n|};\n\nexport type LintCmdOptions = {|\n  createLinter?: LinterCreatorFn,\n  createFileFilter?: FileFilterCreatorFn,\n|};\n\nexport default function lint(\n  {\n    verbose, sourceDir, selfHosted, boring, output,\n    metadata, pretty, warningsAsErrors, ignoreFiles, artifactsDir,\n  }: LintCmdParams,\n  {\n    createLinter = defaultLinterCreator,\n    createFileFilter = defaultFileFilterCreator,\n  }: LintCmdOptions = {}\n): Promise<void> {\n  const fileFilter = createFileFilter({sourceDir, ignoreFiles, artifactsDir});\n\n  log.debug(`Running addons-linter on ${sourceDir}`);\n  const linter = createLinter({\n    config: {\n      logLevel: verbose ? 'debug' : 'fatal',\n      stack: Boolean(verbose),\n      pretty,\n      warningsAsErrors,\n      metadata,\n      output,\n      boring,\n      selfHosted,\n      shouldScanFile: (fileName) => fileFilter.wantFile(fileName),\n      // This mimics the first command line argument from yargs,\n      // which should be the directory to the extension.\n      _: [sourceDir],\n    },\n    runAsBinary: true,\n  });\n  return linter.run();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/cmd/lint.js","module.exports = require(\"addons-linter\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"addons-linter\"\n// module id = 152\n// module chunks = 0","/* @flow */\nimport path from 'path';\nimport EventEmitter from 'events';\n\nimport {describe, it} from 'mocha';\nimport {assert} from 'chai';\nimport sinon from 'sinon';\n\nimport {onlyInstancesOf, WebExtError, RemoteTempInstallNotSupported}\n  from '../../../src/errors';\nimport run, {\n  defaultFirefoxClient, defaultWatcherCreator, defaultReloadStrategy,\n} from '../../../src/cmd/run';\nimport * as defaultFirefoxApp from '../../../src/firefox';\nimport {RemoteFirefox} from '../../../src/firefox/remote';\nimport {TCPConnectError, fakeFirefoxClient, makeSureItFails, fake, fixturePath}\n  from '../helpers';\nimport {createLogger} from '../../../src/util/logger';\n\nconst log = createLogger(__filename);\n// Fake result for client.installTemporaryAddon().then(installResult => ...)\nconst tempInstallResult = {\n  addon: {id: 'some-addon@test-suite'},\n};\n// Fake missing addon id result for client.installTemporaryAddon\nconst tempInstallResultMissingAddonId = {\n  addon: {id: null},\n};\n\n\ndescribe('run', () => {\n\n  function prepareRun(fakeInstallResult) {\n    const sourceDir = fixturePath('minimal-web-ext');\n    const argv = {\n      artifactsDir: path.join(sourceDir, 'web-ext-artifacts'),\n      sourceDir,\n      noReload: true,\n      keepProfileChanges: false,\n    };\n    const options = {\n      firefoxApp: getFakeFirefox(),\n      firefoxClient: sinon.spy(() => {\n        return Promise.resolve(fake(RemoteFirefox.prototype, {\n          installTemporaryAddon: () =>\n            Promise.resolve(\n              fakeInstallResult || tempInstallResult\n            ),\n        }));\n      }),\n      reloadStrategy: sinon.spy(() => {\n        log.debug('fake: reloadStrategy()');\n      }),\n    };\n\n    return {\n      argv,\n      options,\n      run: (customArgv = {}, customOpt = {}) => run(\n        {...argv, ...customArgv},\n        {...options, ...customOpt}\n      ),\n    };\n  }\n\n  function getFakeFirefox(implementations = {}) {\n    const profile = {}; // empty object just to avoid errors.\n    const allImplementations = {\n      createProfile: () => Promise.resolve(profile),\n      copyProfile: () => Promise.resolve(profile),\n      useProfile: () => Promise.resolve(profile),\n      installExtension: () => Promise.resolve(),\n      run: () => Promise.resolve(),\n      ...implementations,\n    };\n    return fake(defaultFirefoxApp, allImplementations);\n  }\n\n  it('installs and runs the extension', () => {\n\n    const profile = {};\n\n    const cmd = prepareRun();\n    const {firefoxApp} = cmd.options;\n    const firefoxClient = fake(RemoteFirefox.prototype, {\n      installTemporaryAddon: () => Promise.resolve(tempInstallResult),\n    });\n\n    return cmd.run({}, {\n      firefoxClient: sinon.spy(() => {\n        return Promise.resolve(firefoxClient);\n      }),\n    }).then(() => {\n      const install = firefoxClient.installTemporaryAddon;\n      assert.equal(install.called, true);\n      assert.equal(install.firstCall.args[0], cmd.argv.sourceDir);\n\n      assert.equal(firefoxApp.run.called, true);\n      assert.deepEqual(firefoxApp.run.firstCall.args[0], profile);\n    });\n  });\n\n  it('suggests --pre-install when remote install not supported', () => {\n    const cmd = prepareRun();\n    const firefoxClient = fake(RemoteFirefox.prototype, {\n      // Simulate an older Firefox that will throw this error.\n      installTemporaryAddon:\n        () => Promise.reject(new RemoteTempInstallNotSupported('')),\n    });\n\n    return cmd.run(\n      {}, {firefoxClient: () => Promise.resolve(firefoxClient)})\n      .then(makeSureItFails())\n      .catch(onlyInstancesOf(WebExtError, (error) => {\n        assert.equal(firefoxClient.installTemporaryAddon.called, true);\n        assert.match(error.message, /use --pre-install/);\n      }));\n  });\n\n  it('passes a custom Firefox binary when specified', () => {\n    const firefox = '/pretend/path/to/Firefox/firefox-bin';\n    const cmd = prepareRun();\n    const {firefoxApp} = cmd.options;\n\n    return cmd.run({firefox}).then(() => {\n      assert.equal(firefoxApp.run.called, true);\n      assert.equal(firefoxApp.run.firstCall.args[1].firefoxBinary,\n                   firefox);\n    });\n  });\n\n  it('passes single url parameter to Firefox when specified', () => {\n    const cmd = prepareRun();\n    const {firefoxApp} = cmd.options;\n    const expectedBinaryArgs = ['--url', 'www.example.com'];\n\n    return cmd.run({startUrl: 'www.example.com'}).then(() => {\n      assert.ok(firefoxApp.run.called);\n      assert.deepEqual(firefoxApp.run.firstCall.args[1].binaryArgs,\n                       expectedBinaryArgs);\n    });\n  });\n\n  it('passes multiple url parameters to Firefox when specified', () => {\n    const cmd = prepareRun();\n    const {firefoxApp} = cmd.options;\n    const expectedBinaryArgs = [\n      '--url', 'www.one.com', '--url', 'www.two.com', '--url', 'www.three.com',\n    ];\n\n    return cmd.run({startUrl: [\n      'www.one.com', 'www.two.com', 'www.three.com',\n    ]}).then(() => {\n      assert.ok(firefoxApp.run.called);\n      assert.deepEqual(firefoxApp.run.firstCall.args[1].binaryArgs,\n                       expectedBinaryArgs);\n    });\n  });\n\n  it('passes -jsconsole when --browser-console is specified', () => {\n    const cmd = prepareRun();\n    const {firefoxApp} = cmd.options;\n\n    return cmd.run({browserConsole: true}).then(() => {\n      assert.ok(firefoxApp.run.called);\n      assert.equal(firefoxApp.run.firstCall.args[1].binaryArgs,\n                   '-jsconsole');\n    });\n  });\n\n  it('passes --marionette when --marionette is specified', () => {\n    const cmd = prepareRun();\n    const {firefoxApp} = cmd.options;\n\n    return cmd.run({marionette: true}).then(() => {\n      assert.ok(firefoxApp.run.called);\n      assert.equal(firefoxApp.run.firstCall.args[1].binaryArgs,\n                   '--marionette');\n    });\n  });\n\n  it('passes a custom Firefox profile when specified', () => {\n    const firefoxProfile = '/pretend/path/to/firefox/profile';\n    const cmd = prepareRun();\n    const {firefoxApp} = cmd.options;\n\n    return cmd.run({firefoxProfile}).then(() => {\n      assert.equal(firefoxApp.createProfile.called, false);\n      assert.equal(firefoxApp.copyProfile.called, true);\n      assert.equal(firefoxApp.copyProfile.firstCall.args[0],\n                   firefoxProfile);\n    });\n  });\n\n  it('keeps changes in custom profile when specified', () => {\n    const firefoxProfile = '/pretend/path/to/firefox/profile';\n    const cmd = prepareRun();\n    const {firefoxApp} = cmd.options;\n\n    return cmd.run({firefoxProfile, keepProfileChanges: true}).then(() => {\n      assert.equal(firefoxApp.useProfile.called, true);\n      assert.equal(firefoxApp.useProfile.firstCall.args[0],\n                   firefoxProfile);\n    });\n  });\n\n  it('can pre-install into the profile before startup', () => {\n    const cmd = prepareRun();\n    const firefoxClient = fake(RemoteFirefox.prototype, {\n      installTemporaryAddon: () => Promise.resolve(tempInstallResult),\n    });\n    const fakeProfile = {};\n    const firefoxApp = getFakeFirefox({\n      copyProfile: () => fakeProfile,\n    });\n    const {sourceDir} = cmd.argv;\n\n    return cmd.run({preInstall: true}, {\n      firefoxApp,\n      firefoxClient: sinon.spy(() => Promise.resolve(firefoxClient)),\n    }).then(() => {\n      assert.equal(firefoxApp.installExtension.called, true);\n      assert.equal(firefoxClient.installTemporaryAddon.called, false);\n\n      const install = firefoxApp.installExtension.firstCall.args[0];\n      assert.equal(install.asProxy, true);\n      assert.equal(install.manifestData.applications.gecko.id,\n                   'minimal-example@web-ext-test-suite');\n      assert.deepEqual(install.profile, fakeProfile);\n      // This needs to be the source of the extension.\n      assert.equal(install.extensionPath, sourceDir);\n    });\n  });\n\n  it('can watch and reload the extension', () => {\n    const cmd = prepareRun();\n    const {sourceDir, artifactsDir} = cmd.argv;\n    const {reloadStrategy} = cmd.options;\n\n    return cmd.run({noReload: false}).then(() => {\n      assert.equal(reloadStrategy.called, true);\n      const args = reloadStrategy.firstCall.args[0];\n      assert.equal(args.sourceDir, sourceDir);\n      assert.equal(args.artifactsDir, artifactsDir);\n      assert.equal(args.addonId, tempInstallResult.addon.id);\n    });\n  });\n\n  it('raise an error on addonId missing from installTemporaryAddon result',\n    () => {\n      const cmd = prepareRun(tempInstallResultMissingAddonId);\n\n      return cmd.run({noReload: false})\n        .catch((error) => error)\n        .then((error) => {\n          assert.equal(\n            error instanceof WebExtError,\n            true\n          );\n          assert.equal(\n            error.message,\n            'Unexpected missing addonId in the installAsTemporaryAddon result'\n          );\n        });\n    }\n  );\n\n  it('will not reload when using --pre-install', () => {\n    const cmd = prepareRun();\n    const {reloadStrategy} = cmd.options;\n\n    // --pre-install should imply --no-reload\n    return cmd.run({noReload: false, preInstall: true}).then(() => {\n      assert.equal(reloadStrategy.called, false);\n    });\n  });\n\n  it('will not connect to the debugger when using --pre-install', () => {\n    const cmd = prepareRun();\n    const {firefoxClient} = cmd.options;\n\n    return cmd.run({preInstall: true}).then(() => {\n      assert.equal(firefoxClient.called, false);\n    });\n  });\n\n  it('allows you to opt out of extension reloading', () => {\n    const cmd = prepareRun();\n    const {reloadStrategy} = cmd.options;\n\n    return cmd.run({noReload: true}).then(() => {\n      assert.equal(reloadStrategy.called, false);\n    });\n  });\n\n  describe('defaultWatcherCreator', () => {\n\n    function prepare() {\n      const config = {\n        addonId: 'some-addon@test-suite',\n        client: fake(RemoteFirefox.prototype, {\n          reloadAddon: () => Promise.resolve(),\n        }),\n        sourceDir: '/path/to/extension/source/',\n        artifactsDir: '/path/to/web-ext-artifacts',\n        onSourceChange: sinon.spy(() => {}),\n        desktopNotifications: sinon.spy(() => Promise.resolve()),\n        ignoreFiles: ['path/to/file', 'path/to/file2'],\n      };\n      return {\n        config,\n        createWatcher: (customConfig = {}) => {\n          return defaultWatcherCreator({...config, ...customConfig});\n        },\n      };\n    }\n\n    it('configures a source watcher', () => {\n      const {config, createWatcher} = prepare();\n      createWatcher();\n      assert.equal(config.onSourceChange.called, true);\n      const callArgs = config.onSourceChange.firstCall.args[0];\n      assert.equal(callArgs.sourceDir, config.sourceDir);\n      assert.equal(callArgs.artifactsDir, config.artifactsDir);\n      assert.typeOf(callArgs.onChange, 'function');\n    });\n\n    it('configures a run command with the expected fileFilter', () => {\n      const fileFilter = {wantFile: sinon.spy()};\n      const createFileFilter = sinon.spy(() => fileFilter);\n      const {config, createWatcher} = prepare();\n      createWatcher({createFileFilter});\n      assert.ok(createFileFilter.called);\n      assert.deepEqual(createFileFilter.firstCall.args[0], {\n        sourceDir: config.sourceDir,\n        artifactsDir: config.artifactsDir,\n        ignoreFiles: config.ignoreFiles,\n      });\n      const {shouldWatchFile} = config.onSourceChange.firstCall.args[0];\n      shouldWatchFile('path/to/file');\n      assert.ok(fileFilter.wantFile.called);\n      assert.equal(fileFilter.wantFile.firstCall.args[0], 'path/to/file');\n    });\n\n    it('returns a watcher', () => {\n      const watcher = {};\n      const onSourceChange = sinon.spy(() => watcher);\n      const createdWatcher = prepare().createWatcher({onSourceChange});\n      assert.equal(createdWatcher, watcher);\n    });\n\n    it('reloads the extension', () => {\n      const {config, createWatcher} = prepare();\n      createWatcher();\n\n      const callArgs = config.onSourceChange.firstCall.args[0];\n      assert.typeOf(callArgs.onChange, 'function');\n      // Simulate executing the handler when a source file changes.\n      return callArgs.onChange()\n        .then(() => {\n          assert.equal(config.client.reloadAddon.called, true);\n          const reloadArgs = config.client.reloadAddon.firstCall.args;\n          assert.ok(config.addonId);\n          assert.equal(reloadArgs[0], config.addonId);\n        });\n    });\n\n    it('notifies user on error from source change handler', () => {\n      const {config, createWatcher} = prepare();\n      config.client.reloadAddon = () => Promise.reject(new Error('an error'));\n      createWatcher();\n\n      assert.equal(config.onSourceChange.called, true);\n      // Simulate executing the handler when a source file changes.\n      return config.onSourceChange.firstCall.args[0].onChange()\n        .then(makeSureItFails())\n        .catch((error) => {\n          assert.equal(config.desktopNotifications.called, true);\n          assert.equal(\n            config.desktopNotifications.lastCall.args[0].message,\n            error.message\n          );\n        });\n    });\n\n    it('throws errors from source change handler', () => {\n      const {createWatcher, config} = prepare();\n      config.client.reloadAddon = () => Promise.reject(new Error('an error'));\n      createWatcher();\n\n      assert.equal(config.onSourceChange.called, true);\n      // Simulate executing the handler when a source file changes.\n      return config.onSourceChange.firstCall.args[0].onChange()\n        .then(makeSureItFails())\n        .catch((error) => {\n          assert.equal(error.message, 'an error');\n        });\n    });\n\n  });\n\n  describe('defaultReloadStrategy', () => {\n\n    class StubChildProcess extends EventEmitter {\n      stderr = new EventEmitter();\n      stdout = new EventEmitter();\n    }\n\n    function prepare() {\n      const client = new RemoteFirefox(fakeFirefoxClient());\n      const watcher = {\n        close: sinon.spy(() => {}),\n      };\n      const args = {\n        addonId: 'some-addon@test-suite',\n        client,\n        firefoxProcess: new StubChildProcess(),\n        profile: {},\n        sourceDir: '/path/to/extension/source',\n        artifactsDir: '/path/to/web-ext-artifacts/',\n        ignoreFiles: ['first/file', 'second/file'],\n      };\n      const options = {\n        createWatcher: sinon.spy(() => watcher),\n      };\n      return {\n        ...args,\n        ...options,\n        client,\n        watcher,\n        reloadStrategy: (argOverride = {}, optOverride = {}) => {\n          return defaultReloadStrategy(\n            {...args, ...argOverride},\n            {...options, ...optOverride});\n        },\n      };\n    }\n\n    it('cleans up connections when firefox closes', () => {\n      const {firefoxProcess, client, watcher, reloadStrategy} = prepare();\n      reloadStrategy();\n      firefoxProcess.emit('close');\n      assert.equal(client.client.disconnect.called, true);\n      assert.equal(watcher.close.called, true);\n    });\n\n    it('configures a watcher', () => {\n      const {\n        createWatcher, reloadStrategy,\n        ...sentArgs\n      } = prepare();\n\n      reloadStrategy();\n      assert.equal(createWatcher.called, true);\n      const receivedArgs = createWatcher.firstCall.args[0];\n      assert.equal(receivedArgs.client, sentArgs.client);\n      assert.equal(receivedArgs.sourceDir, sentArgs.sourceDir);\n      assert.equal(receivedArgs.artifactsDir, sentArgs.artifactsDir);\n      assert.equal(receivedArgs.addonId, sentArgs.addonId);\n      assert.deepEqual(receivedArgs.ignoreFiles, sentArgs.ignoreFiles);\n    });\n\n  });\n\n  describe('firefoxClient', () => {\n\n    function firefoxClient(opt = {}) {\n      return defaultFirefoxClient({maxRetries: 0, retryInterval: 1, ...opt});\n    }\n\n    it('retries after a connection error', () => {\n      const client = new RemoteFirefox(fakeFirefoxClient());\n      var tryCount = 0;\n      const connectToFirefox = sinon.spy(() => new Promise(\n        (resolve, reject) => {\n          tryCount ++;\n          if (tryCount === 1) {\n            reject(new TCPConnectError('first connection fails'));\n          } else {\n            // The second connection succeeds.\n            resolve(client);\n          }\n        }));\n\n      return firefoxClient({connectToFirefox, maxRetries: 3})\n        .then(() => {\n          assert.equal(connectToFirefox.callCount, 2);\n        });\n    });\n\n    it('only retries connection errors', () => {\n      const connectToFirefox = sinon.spy(\n        () => Promise.reject(new Error('not a connection error')));\n\n      return firefoxClient({connectToFirefox, maxRetries: 2})\n        .then(makeSureItFails())\n        .catch((error) => {\n          assert.equal(connectToFirefox.callCount, 1);\n          assert.equal(error.message, 'not a connection error');\n        });\n    });\n\n    it('gives up connecting after too many retries', () => {\n      const connectToFirefox = sinon.spy(\n        () => Promise.reject(new TCPConnectError('failure')));\n\n      return firefoxClient({connectToFirefox, maxRetries: 2})\n        .then(makeSureItFails())\n        .catch((error) => {\n          assert.equal(connectToFirefox.callCount, 3);\n          assert.equal(error.message, 'failure');\n        });\n    });\n\n  });\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-cmd/test.run.js","\"use strict\";\n\nexports.__esModule = true;\n\nexports.default = function (obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/objectWithoutProperties.js\n// module id = 154\n// module chunks = 0","module.exports = require(\"events\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"events\"\n// module id = 155\n// module chunks = 0","/* @flow */\nimport type FirefoxProfile from 'firefox-profile';\nimport type Watchpack from 'watchpack';\n\nimport {\n  showDesktopNotification as defaultDesktopNotifications,\n} from '../util/desktop-notifier';\nimport * as defaultFirefoxApp from '../firefox';\nimport defaultFirefoxConnector from '../firefox/remote';\nimport {\n  isErrorWithCode,\n  RemoteTempInstallNotSupported,\n  WebExtError,\n} from '../errors';\nimport {createLogger} from '../util/logger';\nimport getValidatedManifest, {getManifestId} from '../util/manifest';\nimport defaultSourceWatcher from '../watcher';\nimport {\n  createFileFilter as defaultFileFilterCreator,\n} from '../util/file-filter';\n// Import objects that are only used as Flow types.\nimport type {FirefoxPreferences} from '../firefox/preferences';\nimport type {OnSourceChangeFn} from '../watcher';\nimport type {\n  FirefoxProcess, // eslint-disable-line import/named\n} from '../firefox/index';\nimport type {\n  FirefoxConnectorFn, RemoteFirefox,\n  FirefoxRDPResponseAddon,\n} from '../firefox/remote';\nimport type {ExtensionManifest} from '../util/manifest';\nimport type {FileFilterCreatorFn} from '../util/file-filter';\n\nconst log = createLogger(__filename);\n\n// defaultWatcherCreator types and implementation.\n\nexport type WatcherCreatorParams = {|\n  addonId: string,\n  client: RemoteFirefox,\n  sourceDir: string,\n  artifactsDir: string,\n  onSourceChange?: OnSourceChangeFn,\n  desktopNotifications?: typeof defaultDesktopNotifications,\n  ignoreFiles?: Array<string>,\n  createFileFilter?: FileFilterCreatorFn,\n|};\n\nexport type WatcherCreatorFn = (params: WatcherCreatorParams) => Watchpack;\n\nexport function defaultWatcherCreator(\n  {\n    addonId, client, sourceDir, artifactsDir, ignoreFiles,\n    onSourceChange = defaultSourceWatcher,\n    desktopNotifications = defaultDesktopNotifications,\n    createFileFilter = defaultFileFilterCreator,\n  }: WatcherCreatorParams\n ): Watchpack {\n  const fileFilter = createFileFilter(\n    {sourceDir, artifactsDir, ignoreFiles}\n  );\n  return onSourceChange({\n    sourceDir,\n    artifactsDir,\n    onChange: () => {\n      log.debug(`Reloading add-on ID ${addonId}`);\n\n      return client.reloadAddon(addonId)\n        .catch((error) => {\n          log.error('\\n');\n          log.error(error.stack);\n          desktopNotifications({\n            title: 'web-ext run: error occurred',\n            message: error.message,\n          });\n          throw error;\n        });\n    },\n    shouldWatchFile: (file) => fileFilter.wantFile(file),\n  });\n}\n\n\n// defaultReloadStrategy types and implementation.\n\nexport type ReloadStrategyParams = {|\n  addonId: string,\n  firefoxProcess: FirefoxProcess,\n  client: RemoteFirefox,\n  profile: FirefoxProfile,\n  sourceDir: string,\n  artifactsDir: string,\n  ignoreFiles?: Array<string>,\n|};\n\nexport type ReloadStrategyOptions = {|\n  createWatcher?: WatcherCreatorFn,\n  createFileFilter?: FileFilterCreatorFn,\n|};\n\nexport function defaultReloadStrategy(\n  {\n    addonId, firefoxProcess, client, profile,\n    sourceDir, artifactsDir, ignoreFiles,\n  }: ReloadStrategyParams,\n  {\n    createWatcher = defaultWatcherCreator,\n  }: ReloadStrategyOptions = {}\n): void {\n  const watcher: Watchpack = (\n    createWatcher({addonId, client, sourceDir, artifactsDir, ignoreFiles})\n  );\n\n  firefoxProcess.on('close', () => {\n    client.disconnect();\n    watcher.close();\n  });\n\n}\n\n\n// defaultFirefoxClient types and implementation.\n\nexport type CreateFirefoxClientParams = {|\n  connectToFirefox?: FirefoxConnectorFn,\n  maxRetries: number,\n  retryInterval: number,\n|};\n\nexport function defaultFirefoxClient(\n  {\n    connectToFirefox = defaultFirefoxConnector,\n    // A max of 250 will try connecting for 30 seconds.\n    maxRetries = 250, retryInterval = 120,\n  }: CreateFirefoxClientParams = {}\n): Promise<RemoteFirefox> {\n  async function establishConnection() {\n    var lastError;\n\n    for (let retries = 0; retries <= maxRetries; retries++) {\n      try {\n        return await connectToFirefox();\n      } catch (error) {\n        if (isErrorWithCode('ECONNREFUSED', error)) {\n          // Wait for `retryInterval` ms.\n          await new Promise((resolve) => {\n            setTimeout(resolve, retryInterval);\n          });\n\n          lastError = error;\n          log.debug(\n            `Retrying Firefox (${retries}); connection error: ${error}`);\n        } else {\n          log.error(error.stack);\n          throw error;\n        }\n      }\n    }\n\n    log.debug('Connect to Firefox debugger: too many retries');\n    throw lastError;\n  }\n\n  log.debug('Connecting to the remote Firefox debugger');\n  return establishConnection();\n}\n\n\n// Run command types and implementation.\n\nexport type CmdRunParams = {|\n  sourceDir: string,\n  artifactsDir: string,\n  firefox: string,\n  firefoxProfile: string,\n  keepProfileChanges: boolean,\n  preInstall: boolean,\n  marionette: boolean,\n  noReload: boolean,\n  browserConsole: boolean,\n  customPrefs?: FirefoxPreferences,\n  startUrl?: string | Array<string>,\n  ignoreFiles?: Array<string>,\n|};\n\nexport type CmdRunOptions = {|\n  firefoxApp: typeof defaultFirefoxApp,\n  firefoxClient: typeof defaultFirefoxClient,\n  reloadStrategy: typeof defaultReloadStrategy,\n|};\n\nexport default async function run(\n  {\n    sourceDir, artifactsDir, firefox, firefoxProfile,\n    keepProfileChanges = false, preInstall = false, marionette = false,\n    noReload = false, browserConsole = false, customPrefs, startUrl,\n    ignoreFiles,\n  }: CmdRunParams,\n  {\n    firefoxApp = defaultFirefoxApp,\n    firefoxClient = defaultFirefoxClient,\n    reloadStrategy = defaultReloadStrategy,\n  }: CmdRunOptions = {}): Promise<Object> {\n\n  log.info(`Running web extension from ${sourceDir}`);\n  if (preInstall) {\n    log.info('Disabled auto-reloading because it\\'s not possible with ' +\n             '--pre-install');\n    noReload = true;\n  }\n  // When not pre-installing the extension, we require a remote\n  // connection to Firefox.\n  const requiresRemote = !preInstall;\n  let installed = false;\n\n  let client;\n  let addonId;\n\n  const manifestData = await getValidatedManifest(sourceDir);\n\n  const runner = new ExtensionRunner({\n    sourceDir,\n    firefoxApp,\n    firefox,\n    keepProfileChanges,\n    browserConsole,\n    manifestData,\n    marionette,\n    profilePath: firefoxProfile,\n    customPrefs,\n    startUrl,\n  });\n\n  const profile = await runner.getProfile();\n\n  if (!preInstall) {\n    log.debug('Deferring extension installation until after ' +\n              'connecting to the remote debugger');\n  } else {\n    log.debug('Pre-installing extension as a proxy file');\n    addonId = await runner.installAsProxy(profile);\n    installed = true;\n  }\n\n  const runningFirefox = await runner.run(profile);\n\n  if (installed) {\n    log.debug('Not installing as temporary add-on because the ' +\n              'add-on was already installed');\n  } else if (requiresRemote) {\n    client = await firefoxClient();\n\n    try {\n      addonId = await runner.installAsTemporaryAddon(client).then(\n        (installResult: FirefoxRDPResponseAddon) => installResult.addon.id\n      );\n    } catch (error) {\n      if (error instanceof RemoteTempInstallNotSupported) {\n        log.debug(`Caught: ${error}`);\n        throw new WebExtError(\n          'Temporary add-on installation is not supported in this version ' +\n          'of Firefox (you need Firefox 49 or higher). For older Firefox ' +\n          'versions, use --pre-install');\n      } else {\n        throw error;\n      }\n    }\n\n    if (noReload) {\n      log.info('Automatic extension reloading has been disabled');\n    } else {\n      if (!addonId) {\n        throw new WebExtError(\n          'Unexpected missing addonId in the installAsTemporaryAddon result'\n        );\n      }\n\n      log.info('The extension will reload if any source file changes');\n      reloadStrategy({\n        firefoxProcess: runningFirefox,\n        profile,\n        client,\n        sourceDir,\n        artifactsDir,\n        addonId,\n        ignoreFiles,\n      });\n    }\n  }\n\n  return firefoxApp;\n}\n\n\n// ExtensionRunner types and implementation.\n\nexport type ExtensionRunnerParams = {|\n  sourceDir: string,\n  manifestData: ExtensionManifest,\n  profilePath: string,\n  keepProfileChanges: boolean,\n  firefoxApp: typeof defaultFirefoxApp,\n  firefox: string,\n  browserConsole: boolean,\n  marionette: boolean,\n  customPrefs?: FirefoxPreferences,\n  startUrl?: string | Array<string>,\n|};\n\nexport class ExtensionRunner {\n  sourceDir: string;\n  manifestData: ExtensionManifest;\n  profilePath: string;\n  keepProfileChanges: boolean;\n  firefoxApp: typeof defaultFirefoxApp;\n  firefox: string;\n  browserConsole: boolean;\n  marionette: boolean;\n  customPrefs: FirefoxPreferences;\n  startUrl: ?string | ?Array<string>;\n\n  constructor(\n    {\n      firefoxApp, sourceDir, manifestData,\n      profilePath, keepProfileChanges, firefox, browserConsole, marionette,\n      startUrl, customPrefs = {},\n    }: ExtensionRunnerParams\n  ) {\n    this.sourceDir = sourceDir;\n    this.manifestData = manifestData;\n    this.profilePath = profilePath;\n    this.keepProfileChanges = keepProfileChanges;\n    this.firefoxApp = firefoxApp;\n    this.firefox = firefox;\n    this.browserConsole = browserConsole;\n    this.marionette = marionette;\n    this.customPrefs = customPrefs;\n    this.startUrl = startUrl;\n  }\n\n  getProfile(): Promise<FirefoxProfile> {\n    const {firefoxApp, profilePath, customPrefs, keepProfileChanges} = this;\n    return new Promise((resolve) => {\n      if (profilePath) {\n        if (keepProfileChanges) {\n          log.debug(`Using Firefox profile from ${profilePath}`);\n          resolve(firefoxApp.useProfile(profilePath, {customPrefs}));\n        } else {\n          log.debug(`Copying Firefox profile from ${profilePath}`);\n          resolve(firefoxApp.copyProfile(profilePath, {customPrefs}));\n        }\n      } else {\n        log.debug('Creating new Firefox profile');\n        resolve(firefoxApp.createProfile({customPrefs}));\n      }\n    });\n  }\n\n  installAsTemporaryAddon(\n    client: RemoteFirefox\n  ): Promise<FirefoxRDPResponseAddon> {\n    return client.installTemporaryAddon(this.sourceDir);\n  }\n\n  installAsProxy(profile: FirefoxProfile): Promise<string | void> {\n    const {firefoxApp, sourceDir, manifestData} = this;\n    return firefoxApp.installExtension(\n      {\n        manifestData,\n        asProxy: true,\n        extensionPath: sourceDir,\n        profile,\n      })\n      .then(() => getManifestId(manifestData));\n  }\n\n  run(profile: FirefoxProfile): Promise<FirefoxProcess> {\n    const binaryArgs = [];\n    const {firefoxApp, firefox, startUrl} = this;\n    if (this.browserConsole) {\n      binaryArgs.push('-jsconsole');\n    }\n    if (this.marionette) {\n      binaryArgs.push('--marionette');\n    }\n    if (startUrl) {\n      const urls = Array.isArray(startUrl) ? startUrl : [startUrl];\n      for (const url of urls) {\n        binaryArgs.push('--url', url);\n      }\n    }\n    return firefoxApp.run(profile, {\n      firefoxBinary: firefox, binaryArgs,\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/cmd/run.js","/* @flow */\nimport defaultNotifier from 'node-notifier';\n\nimport {createLogger} from './logger';\nimport type {Logger} from './logger';\n\nconst defaultLog = createLogger(__filename);\n\ntype desktopNotificationsParams = {|\n  title: string,\n  message: string,\n  icon?: string,\n|};\n\nexport type desktopNotificationsOptions = {|\n  notifier?: typeof defaultNotifier,\n  log?: Logger,\n|};\n\nexport function showDesktopNotification(\n  {\n    title, message, icon,\n  }: desktopNotificationsParams,\n  {\n    notifier = defaultNotifier,\n    log = defaultLog,\n  }: desktopNotificationsOptions = {}\n): Promise<void> {\n\n  return new Promise((resolve, reject) => {\n    notifier.notify({title, message, icon}, (err, res) => {\n      if (err) {\n        log.debug(`Desktop notifier error: ${err.message},` +\n                 ` response: ${res}`);\n        reject(err);\n      } else {\n        resolve();\n      }\n    });\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/desktop-notifier.js","module.exports = require(\"node-notifier\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"node-notifier\"\n// module id = 158\n// module chunks = 0","/* @flow */\nimport nodeFs from 'fs';\nimport path from 'path';\n\nimport {default as defaultFxRunner} from 'fx-runner';\nimport FirefoxProfile, {copyFromUserProfile as defaultUserProfileCopier}\n  from 'firefox-profile';\nimport {fs} from 'mz';\nimport promisify from 'es6-promisify';\nimport eventToPromise from 'event-to-promise';\n\nimport isDirectory from '../util/is-directory';\nimport {isErrorWithCode, UsageError, WebExtError} from '../errors';\nimport {getPrefs as defaultPrefGetter} from './preferences';\nimport {getManifestId} from '../util/manifest';\nimport {createLogger} from '../util/logger';\nimport {default as defaultFirefoxConnector, REMOTE_PORT} from './remote';\n// Import flow types\nimport type {FirefoxConnectorFn} from './remote';\nimport type {\n  PreferencesAppName,\n  PreferencesGetterFn,\n  FirefoxPreferences,\n} from './preferences';\nimport type {ExtensionManifest} from '../util/manifest';\n\n\nconst log = createLogger(__filename);\n\nexport const defaultFirefoxEnv = {\n  XPCOM_DEBUG_BREAK: 'stack',\n  NS_TRACE_MALLOC_DISABLE_STACKS: '1',\n};\n\n// defaultRemotePortFinder types and implementation.\n\nexport type RemotePortFinderParams = {|\n  portToTry?: number,\n  retriesLeft?: number,\n  connectToFirefox?: FirefoxConnectorFn,\n|};\n\nexport type RemotePortFinderFn =\n  (params?: RemotePortFinderParams) => Promise<number>;\n\nexport async function defaultRemotePortFinder(\n  {\n    portToTry = REMOTE_PORT,\n    retriesLeft = 10,\n    connectToFirefox = defaultFirefoxConnector,\n  }: RemotePortFinderParams = {}\n): Promise<number> {\n  log.debug(`Checking if remote Firefox port ${portToTry} is available`);\n\n  let client;\n\n  while (retriesLeft >= 0) {\n    try {\n      client = await connectToFirefox(portToTry);\n      log.debug(`Remote Firefox port ${portToTry} is in use ` +\n                `(retries remaining: ${retriesLeft})`);\n    } catch (error) {\n      if (isErrorWithCode('ECONNREFUSED', error)) {\n        // The connection was refused so this port is good to use.\n        return portToTry;\n      }\n\n      throw error;\n    }\n\n    client.disconnect();\n    portToTry++;\n    retriesLeft--;\n  }\n\n  throw new WebExtError('Too many retries on port search');\n}\n\n\n// Declare the needed 'fx-runner' module flow types.\n\nexport type FirefoxRunnerParams = {|\n  binary: ?string,\n  profile?: string,\n  'new-instance'?: boolean,\n  'no-remote'?: boolean,\n  'foreground'?: boolean,\n  'listen': number,\n  'binary-args'?: Array<string> | string,\n  'env'?: {\n    [key: string]: string\n  },\n  'verbose'?: boolean,\n|};\n\nexport interface FirefoxProcess extends events$EventEmitter {\n  stderr: events$EventEmitter;\n  stdout: events$EventEmitter;\n}\n\nexport type FirefoxRunnerResults = {|\n  process: FirefoxProcess,\n  binary: string,\n  args: Array<string>,\n|}\n\nexport type FirefoxRunnerFn =\n  (params: FirefoxRunnerParams) => Promise<FirefoxRunnerResults>;\n\n\n// Run command types and implementaion.\n\nexport type FirefoxRunOptions = {|\n  fxRunner?: FirefoxRunnerFn,\n  findRemotePort?: RemotePortFinderFn,\n  firefoxBinary?: string,\n  binaryArgs?: Array<string>,\n  args?: Array<any>,\n|};\n\n/*\n * Runs Firefox with the given profile object and resolves a promise on exit.\n */\nexport async function run(\n  profile: FirefoxProfile,\n  {\n    fxRunner = defaultFxRunner,\n    findRemotePort = defaultRemotePortFinder,\n    firefoxBinary, binaryArgs,\n  }: FirefoxRunOptions = {}\n): Promise<FirefoxProcess> {\n\n  log.debug(`Running Firefox with profile at ${profile.path()}`);\n\n  const remotePort = await findRemotePort();\n\n  const results = await fxRunner({\n    // if this is falsey, fxRunner tries to find the default one.\n    'binary': firefoxBinary,\n    'binary-args': binaryArgs,\n    // This ensures a new instance of Firefox is created. It has nothing\n    // to do with the devtools remote debugger.\n    'no-remote': true,\n    'listen': remotePort,\n    'foreground': true,\n    'profile': profile.path(),\n    'env': {\n      ...process.env,\n      ...defaultFirefoxEnv,\n    },\n    'verbose': true,\n  });\n\n  const firefox = results.process;\n\n  log.debug(`Executing Firefox binary: ${results.binary}`);\n  log.debug(`Firefox args: ${results.args.join(' ')}`);\n\n  firefox.on('error', (error) => {\n    // TODO: show a nice error when it can't find Firefox.\n    // if (/No such file/.test(err) || err.code === 'ENOENT') {\n    log.error(`Firefox error: ${error}`);\n    throw error;\n  });\n\n  log.info(\n    'Use --verbose or open Tools > Web Developer > Browser Console ' +\n    'to see logging');\n\n  firefox.stderr.on('data', (data) => {\n    log.debug(`Firefox stderr: ${data.toString().trim()}`);\n  });\n\n  firefox.stdout.on('data', (data) => {\n    log.debug(`Firefox stdout: ${data.toString().trim()}`);\n  });\n\n  firefox.on('close', () => {\n    log.debug('Firefox closed');\n  });\n\n  return firefox;\n}\n\n\n// configureProfile types and implementation.\n\nexport type ConfigureProfileOptions = {|\n  app?: PreferencesAppName,\n  getPrefs?: PreferencesGetterFn,\n  customPrefs?: FirefoxPreferences,\n|};\n\nexport type ConfigureProfileFn = (\n  profile: FirefoxProfile,\n  options?: ConfigureProfileOptions\n) => Promise<FirefoxProfile>;\n\n/*\n * Configures a profile with common preferences that are required to\n * activate extension development.\n *\n * Returns a promise that resolves with the original profile object.\n */\nexport function configureProfile(\n  profile: FirefoxProfile,\n  {\n    app = 'firefox',\n    getPrefs = defaultPrefGetter,\n    customPrefs = {},\n  }: ConfigureProfileOptions = {},\n): Promise<FirefoxProfile> {\n  // Set default preferences. Some of these are required for the add-on to\n  // operate, such as disabling signatures.\n  const prefs = getPrefs(app);\n  Object.keys(prefs).forEach((pref) => {\n    profile.setPreference(pref, prefs[pref]);\n  });\n  if (Object.keys(customPrefs).length > 0) {\n    const customPrefsStr = JSON.stringify(customPrefs, null, 2);\n    log.info(`Setting custom Firefox preferences: ${customPrefsStr}`);\n    Object.keys(customPrefs).forEach((custom) => {\n      profile.setPreference(custom, customPrefs[custom]);\n    });\n  }\n  profile.updatePreferences();\n  return Promise.resolve(profile);\n}\n\n// useProfile types and implementation.\n\nexport type UseProfileParams = {\n  app?: PreferencesAppName,\n  configureThisProfile?: ConfigureProfileFn,\n  customPrefs?: FirefoxPreferences,\n};\n\n// Use the target path as a Firefox profile without cloning it\n\nexport async function useProfile(\n  profilePath: string,\n  {\n    app,\n    configureThisProfile = configureProfile,\n    customPrefs = {},\n  }: UseProfileParams = {},\n): Promise<FirefoxProfile> {\n  const profile = new FirefoxProfile({destinationDirectory: profilePath});\n  return await configureThisProfile(profile, {app, customPrefs});\n}\n\n\n// createProfile types and implementation.\n\nexport type CreateProfileParams = {\n  app?: PreferencesAppName,\n  configureThisProfile?: ConfigureProfileFn,\n  customPrefs?: FirefoxPreferences,\n};\n\n/*\n * Creates a new temporary profile and resolves with the profile object.\n *\n * The profile will be deleted when the system process exits.\n */\nexport async function createProfile(\n  {\n    app,\n    configureThisProfile = configureProfile,\n    customPrefs = {},\n  }: CreateProfileParams = {},\n): Promise<FirefoxProfile> {\n  const profile = new FirefoxProfile();\n  return await configureThisProfile(profile, {app, customPrefs});\n}\n\n\n// copyProfile types and implementation.\n\nexport type CopyProfileOptions = {|\n  app?: PreferencesAppName,\n  configureThisProfile?: ConfigureProfileFn,\n  copyFromUserProfile?: Function,\n  customPrefs?: FirefoxPreferences,\n|};\n\n/*\n * Copies an existing Firefox profile and creates a new temporary profile.\n * The new profile will be configured with some preferences required to\n * activate extension development.\n *\n * It resolves with the new profile object.\n *\n * The temporary profile will be deleted when the system process exits.\n *\n * The existing profile can be specified as a directory path or a name of\n * one that exists in the current user's Firefox directory.\n */\nexport async function copyProfile(\n  profileDirectory: string,\n  {\n    app,\n    configureThisProfile = configureProfile,\n    copyFromUserProfile = defaultUserProfileCopier,\n    customPrefs = {},\n  }: CopyProfileOptions = {},\n): Promise<FirefoxProfile> {\n\n  const copy = promisify(FirefoxProfile.copy);\n  const copyByName = promisify(copyFromUserProfile);\n\n  try {\n    const dirExists = await isDirectory(profileDirectory);\n\n    let profile;\n\n    if (dirExists) {\n      log.debug(`Copying profile directory from \"${profileDirectory}\"`);\n      profile = await copy({profileDirectory});\n    } else {\n      log.debug(`Assuming ${profileDirectory} is a named profile`);\n      profile = await copyByName({name: profileDirectory});\n    }\n\n    return configureThisProfile(profile, {app, customPrefs});\n  } catch (error) {\n    throw new WebExtError(\n      `Could not copy Firefox profile from ${profileDirectory}: ${error}`);\n  }\n}\n\n\n// installExtension types and implementation.\n\nexport type InstallExtensionParams = {|\n  asProxy?: boolean,\n  manifestData: ExtensionManifest,\n  profile: FirefoxProfile,\n  extensionPath: string,\n|};\n\n/*\n * Installs an extension into the given Firefox profile object.\n * Resolves when complete.\n *\n * The extension is copied into a special location and you need to turn\n * on some preferences to allow this. See extensions.autoDisableScopes in\n * ./preferences.js.\n *\n * When asProxy is true, a special proxy file will be installed. This is a\n * text file that contains the path to the extension source.\n */\nexport async function installExtension(\n  {\n    asProxy = false,\n    manifestData,\n    profile,\n    extensionPath,\n  }: InstallExtensionParams): Promise<any> {\n  // This more or less follows\n  // https://github.com/saadtazi/firefox-profile-js/blob/master/lib/firefox_profile.js#L531\n  // (which is broken for web extensions).\n  // TODO: maybe uplift a patch that supports web extensions instead?\n\n  if (!profile.extensionsDir) {\n    throw new WebExtError('profile.extensionsDir was unexpectedly empty');\n  }\n\n  try {\n    await fs.stat(profile.extensionsDir);\n  } catch (error) {\n    if (isErrorWithCode('ENOENT', error)) {\n      log.debug(`Creating extensions directory: ${profile.extensionsDir}`);\n      await fs.mkdir(profile.extensionsDir);\n    } else {\n      throw error;\n    }\n  }\n\n  const id = getManifestId(manifestData);\n  if (!id) {\n    throw new UsageError(\n      'An explicit extension ID is required when installing to ' +\n      'a profile (applications.gecko.id not found in manifest.json)');\n  }\n\n  if (asProxy) {\n    log.debug(`Installing as an extension proxy; source: ${extensionPath}`);\n\n    const isDir = await isDirectory(extensionPath);\n    if (!isDir) {\n      throw new WebExtError(\n        'proxy install: extensionPath must be the extension source ' +\n        `directory; got: ${extensionPath}`);\n    }\n\n    // Write a special extension proxy file containing the source\n    // directory. See:\n    // https://developer.mozilla.org/en-US/Add-ons/Setting_up_extension_development_environment#Firefox_extension_proxy_file\n    const destPath = path.join(profile.extensionsDir, `${id}`);\n    const writeStream = nodeFs.createWriteStream(destPath);\n    writeStream.write(extensionPath);\n    writeStream.end();\n    return await eventToPromise(writeStream, 'close');\n  } else {\n    // Write the XPI file to the profile.\n    const readStream = nodeFs.createReadStream(extensionPath);\n    const destPath = path.join(profile.extensionsDir, `${id}.xpi`);\n    const writeStream = nodeFs.createWriteStream(destPath);\n\n    log.debug(`Installing extension from ${extensionPath} to ${destPath}`);\n    readStream.pipe(writeStream);\n\n    return await Promise.all([\n      eventToPromise(readStream, 'close'),\n      eventToPromise(writeStream, 'close'),\n    ]);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/firefox/index.js","module.exports = require(\"fx-runner\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fx-runner\"\n// module id = 160\n// module chunks = 0","module.exports = require(\"firefox-profile\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"firefox-profile\"\n// module id = 161\n// module chunks = 0","/* @flow */\nimport {fs} from 'mz';\n\nimport {onlyErrorsWithCode} from '../errors';\n\n/*\n * Resolves true if the path is a readable directory.\n *\n * Usage:\n *\n * isDirectory('/some/path')\n *  .then((dirExists) => {\n *    // dirExists will be true or false.\n *  });\n *\n * */\nexport default function isDirectory(path: string): Promise<boolean> {\n  return fs.stat(path)\n    .then((stats) => stats.isDirectory())\n    .catch(onlyErrorsWithCode(['ENOENT', 'ENOTDIR'], () => {\n      return false;\n    }));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/is-directory.js","/* @flow */\nimport {WebExtError, UsageError} from '../errors';\nimport {createLogger} from '../util/logger';\n\nconst log = createLogger(__filename);\nexport const nonOverridablePreferences = [\n  'devtools.debugger.remote-enabled', 'devtools.debugger.prompt-connection',\n  'xpinstall.signatures.required',\n];\n\n// Flow Types\n\nexport type FirefoxPreferences = {\n  [key: string]: boolean | string | number,\n};\n\nexport type PreferencesAppName = 'firefox' | 'fennec';\n\n\n// Preferences Maps\n\nconst prefsCommon: FirefoxPreferences = {\n  // Allow debug output via dump to be printed to the system console\n  'browser.dom.window.dump.enabled': true,\n  // Warn about possibly incorrect code.\n  'javascript.options.strict': true,\n  'javascript.options.showInConsole': true,\n\n  // Allow remote connections to the debugger.\n  'devtools.debugger.remote-enabled': true,\n  // Disable the prompt for allowing connections.\n  'devtools.debugger.prompt-connection': false,\n\n  // Turn off platform logging because it is a lot of info.\n  'extensions.logging.enabled': false,\n\n  // Disable extension updates and notifications.\n  'extensions.checkCompatibility.nightly': false,\n  'extensions.update.enabled': false,\n  'extensions.update.notifyUser': false,\n\n  // From:\n  // http://hg.mozilla.org/mozilla-central/file/1dd81c324ac7/build/automation.py.in//l372\n  // Only load extensions from the application and user profile.\n  // AddonManager.SCOPE_PROFILE + AddonManager.SCOPE_APPLICATION\n  'extensions.enabledScopes': 5,\n  // Disable metadata caching for installed add-ons by default.\n  'extensions.getAddons.cache.enabled': false,\n  // Disable intalling any distribution add-ons.\n  'extensions.installDistroAddons': false,\n  // Allow installing extensions dropped into the profile folder.\n  'extensions.autoDisableScopes': 10,\n\n  // Disable app update.\n  'app.update.enabled': false,\n\n  // Point update checks to a nonexistent local URL for fast failures.\n  'extensions.update.url': 'http://localhost/extensions-dummy/updateURL',\n  'extensions.blocklist.url':\n    'http://localhost/extensions-dummy/blocklistURL',\n\n  // Make sure opening about:addons won't hit the network.\n  'extensions.webservice.discoverURL':\n    'http://localhost/extensions-dummy/discoveryURL',\n\n  // Allow unsigned add-ons.\n  'xpinstall.signatures.required': false,\n};\n\n// Prefs specific to Firefox for Android.\nconst prefsFennec: FirefoxPreferences = {\n  'browser.console.showInPanel': true,\n  'browser.firstrun.show.uidiscovery': false,\n};\n\n// Prefs specific to Firefox for desktop.\nconst prefsFirefox: FirefoxPreferences = {\n  'browser.startup.homepage': 'about:blank',\n  'startup.homepage_welcome_url': 'about:blank',\n  'startup.homepage_welcome_url.additional': '',\n  'devtools.errorconsole.enabled': true,\n  'devtools.chrome.enabled': true,\n\n  // From:\n  // http://hg.mozilla.org/mozilla-central/file/1dd81c324ac7/build/automation.py.in//l388\n  // Make url-classifier updates so rare that they won't affect tests.\n  'urlclassifier.updateinterval': 172800,\n  // Point the url-classifier to a nonexistent local URL for fast failures.\n  'browser.safebrowsing.provider.0.gethashURL':\n    'http://localhost/safebrowsing-dummy/gethash',\n  'browser.safebrowsing.provider.0.keyURL':\n    'http://localhost/safebrowsing-dummy/newkey',\n  'browser.safebrowsing.provider.0.updateURL':\n    'http://localhost/safebrowsing-dummy/update',\n\n  // Disable self repair/SHIELD\n  'browser.selfsupport.url': 'https://localhost/selfrepair',\n  // Disable Reader Mode UI tour\n  'browser.reader.detectedFirstArticle': true,\n};\n\nconst prefs = {\n  common: prefsCommon,\n  fennec: prefsFennec,\n  firefox: prefsFirefox,\n};\n\n\n// Module exports\n\nexport type PreferencesGetterFn =\n  (appName: PreferencesAppName) => FirefoxPreferences;\n\nexport function getPrefs(\n  app: PreferencesAppName = 'firefox'\n): FirefoxPreferences {\n  const appPrefs = prefs[app];\n  if (!appPrefs) {\n    throw new WebExtError(`Unsupported application: ${app}`);\n  }\n  return {\n    ...prefsCommon,\n    ...appPrefs,\n  };\n}\n\nexport function coerceCLICustomPreference(\n  cliPrefs: string | Array<string>\n): FirefoxPreferences {\n  const customPrefs = {};\n\n  if (!Array.isArray(cliPrefs)) {\n    cliPrefs = [cliPrefs];\n  }\n\n\n  for (const pref of cliPrefs) {\n    const prefsAry = pref.split('=');\n\n    if (prefsAry.length < 2) {\n      throw new UsageError(\n        `Incomplete custom preference: \"${pref}\". ` +\n        'Syntax expected: \"prefname=prefvalue\".'\n      );\n    }\n\n    const key = prefsAry[0];\n    let value = prefsAry.slice(1).join('=');\n\n    if (/[^\\w{@}.-]/.test(key)) {\n      throw new UsageError(`Invalid custom preference name: ${key}`);\n    }\n\n    if (value === `${parseInt(value)}`) {\n      value = parseInt(value, 10);\n    } else if (value === 'true' || value === 'false') {\n      value = (value === 'true');\n    }\n\n    if (nonOverridablePreferences.includes(key)) {\n      log.warn(`'${key}' preference cannot be customized.`);\n      continue;\n    }\n    customPrefs[`${key}`] = value;\n  }\n\n  return customPrefs;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/firefox/preferences.js","/* @flow */\nimport defaultFirefoxConnector from 'node-firefox-connect';\n// RemoteFirefox types and implementation\nimport type FirefoxClient from 'firefox-client'; //eslint-disable-line import/no-extraneous-dependencies\n\nimport {createLogger} from '../util/logger';\nimport {\n  RemoteTempInstallNotSupported,\n  UsageError,\n  WebExtError,\n} from '../errors';\n\nconst log = createLogger(__filename);\n\n// The default port that Firefox's remote debugger will listen on and the\n// client will connect to.\nexport const REMOTE_PORT = 6005;\n\nexport type FirefoxConnectorFn =\n  (port?: number) => Promise<FirefoxClient>;\n\nexport type FirefoxRDPAddonActor = {|\n  id: string,\n  actor: string,\n|};\n\nexport type FirefoxRDPResponseError = {|\n  error: {\n    message: string,\n  },\n|};\n\nexport type FirefoxRDPResponseAddon = {|\n  addon: FirefoxRDPAddonActor,\n|};\n\nexport type FirefoxRDPResponseRequestTypes = {|\n  requestTypes: Array<string>,\n|};\n\n// NOTE: this type aliases Object to catch any other possible response.\nexport type FirefoxRDPResponseAny = Object;\n\nexport type FirefoxRDPResponseMaybe =\n  FirefoxRDPResponseRequestTypes | FirefoxRDPResponseAny;\n\nexport class RemoteFirefox {\n  client: Object;\n  checkedForAddonReloading: boolean;\n\n  constructor(client: FirefoxClient) {\n    this.client = client;\n    this.checkedForAddonReloading = false;\n\n    client.client.on('disconnect', () => {\n      log.debug('Received \"disconnect\" from Firefox client');\n    });\n    client.client.on('end', () => {\n      log.debug('Received \"end\" from Firefox client');\n    });\n    client.client.on('message', (info) => {\n      // These are arbitrary messages that the client library ignores.\n      log.debug(`Received message from client: ${JSON.stringify(info)}`);\n    });\n  }\n\n  disconnect() {\n    this.client.disconnect();\n  }\n\n  addonRequest(\n    addon: FirefoxRDPAddonActor,\n    request: string\n  ): Promise<FirefoxRDPResponseMaybe> {\n    return new Promise((resolve, reject) => {\n      this.client.client.makeRequest(\n        {to: addon.actor, type: request}, (response) => {\n          if (response.error) {\n            const error = `${response.error}: ${response.message}`;\n            log.debug(\n              `Client responded to '${request}' request with error:`, error);\n            reject(new WebExtError(error));\n          } else {\n            resolve(response);\n          }\n        });\n    });\n  }\n\n  installTemporaryAddon(\n    addonPath: string\n  ): Promise<FirefoxRDPResponseAddon> {\n    return new Promise((resolve, reject) => {\n      this.client.request('listTabs', (error, tabsResponse) => {\n        if (error) {\n          return reject(new WebExtError(\n            `Remote Firefox: listTabs() error: ${error}`));\n        }\n        if (!tabsResponse.addonsActor) {\n          log.debug(\n            'listTabs returned a falsey addonsActor: ' +\n            `${tabsResponse.addonsActor}`);\n          return reject(new RemoteTempInstallNotSupported(\n            'This is an older version of Firefox that does not provide an ' +\n            'add-ons actor for remote installation. Try Firefox 49 or ' +\n            'higher.'));\n        }\n\n        this.client.client.makeRequest({\n          to: tabsResponse.addonsActor,\n          type: 'installTemporaryAddon',\n          addonPath,\n        }, (installResponse) => {\n          if (installResponse.error) {\n            return reject(new WebExtError(\n              'installTemporaryAddon: Error: ' +\n              `${installResponse.error}: ${installResponse.message}`));\n          }\n          log.debug(\n            `installTemporaryAddon: ${JSON.stringify(installResponse)}`);\n          log.info(`Installed ${addonPath} as a temporary add-on`);\n          resolve(installResponse);\n        });\n      });\n    });\n  }\n\n  getInstalledAddon(addonId: string): Promise<FirefoxRDPAddonActor> {\n    return new Promise(\n      (resolve, reject) => {\n        this.client.request('listAddons', (error, response) => {\n          if (error) {\n            reject(new WebExtError(\n              `Remote Firefox: listAddons() error: ${error}`));\n          } else {\n            resolve(response.addons);\n          }\n        });\n      })\n      .then((addons) => {\n        for (const addon of addons) {\n          if (addon.id === addonId) {\n            return addon;\n          }\n        }\n        log.debug(\n          `Remote Firefox has these addons: ${addons.map((a) => a.id)}`);\n        throw new WebExtError(\n          'The remote Firefox does not have your extension installed');\n      });\n  }\n\n  async checkForAddonReloading(\n    addon: FirefoxRDPAddonActor\n  ): Promise<FirefoxRDPAddonActor> {\n    if (this.checkedForAddonReloading) {\n      // We only need to check once if reload() is supported.\n      return addon;\n    } else {\n      const response = await this.addonRequest(addon, 'requestTypes');\n\n      if (response.requestTypes.indexOf('reload') === -1) {\n        const supportedRequestTypes = JSON.stringify(response.requestTypes);\n        log.debug(\n          `Remote Firefox only supports: ${supportedRequestTypes}`);\n        throw new UsageError(\n          'This Firefox version does not support add-on reloading. ' +\n          'Re-run with --no-reload');\n      } else {\n        this.checkedForAddonReloading = true;\n        return addon;\n      }\n    }\n  }\n\n  async reloadAddon(addonId: string): Promise<void> {\n    const addon = await this.getInstalledAddon(addonId);\n    await this.checkForAddonReloading(addon);\n    await this.addonRequest(addon, 'reload');\n    process.stdout.write(\n      `\\rLast extension reload: ${(new Date()).toTimeString()}`);\n    log.debug('\\n');\n  }\n}\n\n\n// Connect types and implementation\n\nexport type ConnectOptions = {|\n  connectToFirefox: FirefoxConnectorFn,\n|};\n\n// NOTE: this fixes an issue with flow and default exports (which currently\n// lose their type signatures) by explicitly declaring the default export\n// signature. Reference: https://github.com/facebook/flow/issues/449\n// eslint-disable-next-line no-shadow\ndeclare function exports(\n  port: number, options?: ConnectOptions\n): Promise<RemoteFirefox>;\n\nexport default async function connect(\n  port: number = REMOTE_PORT,\n  {connectToFirefox = defaultFirefoxConnector}: ConnectOptions = {}\n): Promise<RemoteFirefox> {\n  log.debug(`Connecting to Firefox on port ${port}`);\n  const client = await connectToFirefox(port);\n  log.debug('Connected to the remote Firefox debugger');\n  return new RemoteFirefox(client);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/firefox/remote.js","module.exports = require(\"node-firefox-connect\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"node-firefox-connect\"\n// module id = 165\n// module chunks = 0","/* @flow */\nimport path from 'path';\n\nimport copyDir from 'copy-dir';\nimport {fs} from 'mz';\nimport {describe, it} from 'mocha';\nimport {assert} from 'chai';\nimport sinon from 'sinon';\nimport promisify from 'es6-promisify';\n\nimport {onlyInstancesOf, UsageError, WebExtError} from '../../../src/errors';\nimport {getManifestId} from '../../../src/util/manifest';\nimport {withTempDir} from '../../../src/util/temp-dir';\nimport {basicManifest, manifestWithoutApps} from '../test-util/test.manifest';\nimport completeSignCommand, {\n  extensionIdFile, getIdFromSourceDir, saveIdToSourceDir,\n} from '../../../src/cmd/sign';\nimport {makeSureItFails, fixturePath} from '../helpers';\n// Import flow type\nimport type {ExtensionManifestApplications} from '../../../src/util/manifest';\n\ndescribe('sign', () => {\n\n  function getStubs() {\n    const signingConfig = {\n      apiKey: 'AMO JWT issuer',\n      apiSecret: 'AMO JWT secret',\n      apiUrlPrefix: 'http://not-the-real-amo.com/api/v3',\n      apiProxy: 'http://yourproxy:6000',\n      timeout: 999,\n    };\n\n    const buildResult = {\n      extensionPath: '/tmp/built-web-extension.xpi',\n    };\n    const build = sinon.spy(() => Promise.resolve(buildResult));\n\n    const signingResult = {\n      id: 'some-addon-id',\n      success: true,\n      downloadedFiles: [],\n    };\n    const signAddon = sinon.spy(() => Promise.resolve(signingResult));\n\n    return {\n      signingConfig,\n      build,\n      buildResult,\n      signAddon,\n      signingResult,\n      preValidatedManifest: basicManifest,\n    };\n  }\n\n  /*\n   * Run the sign command with stubs for all dependencies.\n   */\n  function sign(\n    tmpDir: Object, stubs: Object,\n    {extraArgs = {}, extraOptions = {}}: Object = {}\n  ): Promise<*> {\n    return completeSignCommand({\n      verbose: false,\n      artifactsDir: path.join(tmpDir.path(), 'artifacts-dir'),\n      sourceDir: tmpDir.path(),\n      ...stubs.signingConfig,\n      ...extraArgs,\n    }, {\n      ...stubs,\n      ...extraOptions,\n    });\n  }\n\n  it('builds and signs an extension', () => withTempDir(\n    // This test only stubs out the signer in an effort to integrate\n    // all other parts of the process.\n    (tmpDir) => {\n      const stubs = getStubs();\n      const sourceDir = path.join(tmpDir.path(), 'source-dir');\n      const copyDirAsPromised = promisify(copyDir);\n      return copyDirAsPromised(fixturePath('minimal-web-ext'), sourceDir)\n        .then(() => completeSignCommand({\n          sourceDir,\n          artifactsDir: path.join(tmpDir.path(), 'artifacts'),\n          ...stubs.signingConfig,\n        }, {\n          signAddon: stubs.signAddon,\n        }))\n        .then((result) => {\n          assert.equal(result.success, true);\n          // Do a sanity check that a built extension was passed to the\n          // signer.\n          assert.include(stubs.signAddon.firstCall.args[0].xpiPath,\n                         'minimal_extension-1.0.zip');\n        });\n    }\n  ));\n\n  it('allows an empty application ID when signing', () => withTempDir(\n    (tmpDir) => {\n      const stubs = getStubs();\n      return sign(tmpDir, stubs,\n        {\n          extraOptions: {\n            preValidatedManifest: manifestWithoutApps,\n          },\n        })\n        .then(() => {\n          assert.equal(stubs.signAddon.called, true);\n          assert.strictEqual(\n            stubs.signAddon.firstCall.args[0].id,\n            getManifestId(manifestWithoutApps));\n        });\n    }\n  ));\n\n  it('allows a custom ID when no ID in manifest.json', () => withTempDir(\n    (tmpDir) => {\n      const customId = 'some-custom-id';\n      const stubs = getStubs();\n      return sign(tmpDir, stubs,\n        {\n          extraArgs: {\n            id: customId,\n          },\n          extraOptions: {\n            preValidatedManifest: manifestWithoutApps,\n          },\n        })\n        .then(() => {\n          assert.equal(stubs.signAddon.called, true);\n          assert.equal(stubs.signAddon.firstCall.args[0].id,\n                       customId);\n        });\n    }\n  ));\n\n  it('prefers a custom ID over an ID file', () => withTempDir(\n    (tmpDir) => {\n      const sourceDir = path.join(tmpDir.path(), 'source-dir');\n      const customId = 'some-custom-id';\n      const stubs = getStubs();\n      // First, save an extension ID like a previous signing call.\n      return fs.mkdir(sourceDir)\n        .then(() => saveIdToSourceDir(sourceDir, 'some-other-id'))\n        // Now, make a signing call with a custom ID.\n        .then(() => sign(tmpDir, stubs, {\n          extraArgs: {\n            sourceDir,\n            id: customId,\n          },\n          extraOptions: {\n            preValidatedManifest: manifestWithoutApps,\n          },\n        }))\n        .then(() => {\n          assert.equal(stubs.signAddon.called, true);\n          assert.equal(stubs.signAddon.firstCall.args[0].id,\n                       customId);\n        });\n    }\n  ));\n\n  it('disallows a custom ID when manifest.json has ID', () => withTempDir(\n    (tmpDir) => {\n      const customId = 'some-custom-id';\n      const stubs = getStubs();\n      return sign(tmpDir, stubs,\n        {\n          extraArgs: {\n            id: customId,\n          },\n          extraOptions: {\n            // This manifest has an ID in it.\n            preValidatedManifest: basicManifest,\n          },\n        })\n        .then(makeSureItFails())\n        .catch(onlyInstancesOf(UsageError, (error) => {\n          assert.match(error.message, /Cannot set custom ID some-custom-id/);\n          assert.match(\n            error.message,\n            /manifest\\.json declares ID basic-manifest@web-ext-test-suite/);\n        }));\n    }\n  ));\n\n  it('remembers auto-generated IDs for successive signing', () => withTempDir(\n    (tmpDir) => {\n\n      function _sign() {\n        const signAddon = sinon.spy(() => Promise.resolve({\n          ...stubs.signingResult,\n          id: 'auto-generated-id',\n        }));\n\n        return sign(tmpDir,\n          {\n            ...stubs,\n            signAddon,\n          }, {\n            extraOptions: {\n              preValidatedManifest: manifestWithoutApps,\n            },\n          })\n          .then((signingResult) => {\n            return {signingResult, signAddon};\n          });\n      }\n\n      const stubs = getStubs();\n\n      // Run an initial sign command which will yield a server generated ID.\n      return _sign()\n        .then(({signAddon, signingResult}) => {\n          assert.equal(signAddon.called, true);\n          assert.strictEqual(signAddon.firstCall.args[0].id,\n                             undefined);\n          assert.equal(signingResult.id, 'auto-generated-id');\n\n          // Re-run the sign command again.\n          return _sign();\n        })\n        .then(({signAddon}) => {\n          assert.equal(signAddon.called, true);\n          // This should call signAddon() with the server generated\n          // ID that was saved to the source directory from the previous\n          // signing result.\n          assert.equal(signAddon.firstCall.args[0].id,\n                       'auto-generated-id');\n        });\n    }\n  ));\n\n  it('returns a signing result', () => withTempDir(\n    (tmpDir) => {\n      const stubs = getStubs();\n      return sign(tmpDir, stubs)\n        .then((realResult) => {\n          assert.deepEqual(realResult, stubs.signingResult);\n        });\n    }\n  ));\n\n  it('might fail', () => withTempDir(\n    (tmpDir) => {\n      return sign(\n        tmpDir, {\n          ...getStubs(),\n          signAddon: () => Promise.resolve({\n            success: false,\n          }),\n        })\n        .then(makeSureItFails())\n        .catch((error) => {\n          assert.instanceOf(error, WebExtError);\n          assert.match(error.message,\n            /The WebExtension could not be signed/);\n        });\n    }\n  ));\n\n  it('calls the add-on signer', () => withTempDir(\n    (tmpDir) => {\n      const stubs = getStubs();\n      const artifactsDir = path.join(tmpDir.path(), 'some-artifacts-dir');\n      return sign(tmpDir, stubs, {extraArgs: {artifactsDir}})\n        .then(() => {\n          assert.equal(stubs.signAddon.called, true);\n          const signedAddonCall = stubs.signAddon.firstCall.args[0];\n          assert.equal(signedAddonCall.apiKey,\n                       stubs.signingConfig.apiKey);\n          assert.equal(signedAddonCall.apiSecret,\n                       stubs.signingConfig.apiSecret);\n          assert.equal(signedAddonCall.apiUrlPrefix,\n                       stubs.signingConfig.apiUrlPrefix);\n          assert.equal(signedAddonCall.apiProxy,\n                       stubs.signingConfig.apiProxy);\n          assert.equal(signedAddonCall.timeout,\n                       stubs.signingConfig.timeout);\n          assert.equal(signedAddonCall.xpiPath,\n                       stubs.buildResult.extensionPath);\n\n          const applications: ExtensionManifestApplications =\n            stubs.preValidatedManifest.applications || {gecko: {}};\n          assert.equal(signedAddonCall.id, applications.gecko.id);\n\n          assert.equal(signedAddonCall.version,\n                       stubs.preValidatedManifest.version);\n          assert.equal(signedAddonCall.downloadDir, artifactsDir);\n        });\n    }\n  ));\n\n  it('passes the verbose flag to the signer', () => withTempDir(\n    (tmpDir) => {\n      const stubs = getStubs();\n      return sign(tmpDir, stubs, {extraArgs: {verbose: true}})\n        .then(() => {\n          assert.equal(stubs.signAddon.called, true);\n          assert.equal(stubs.signAddon.firstCall.args[0].verbose, true);\n        });\n    }\n  ));\n\n  it('passes the ignoreFiles flag to the builder', () => withTempDir(\n    (tmpDir) => {\n      const stubs = getStubs();\n      const ignoreFiles = ['*'];\n      return sign(tmpDir, stubs, {extraArgs: {ignoreFiles}})\n        .then(() => {\n          assert.equal(stubs.signAddon.called, true);\n          assert.equal(stubs.build.firstCall.args[0].ignoreFiles, ignoreFiles);\n        });\n    }\n  ));\n\n  it('passes through a signing exception', () => withTempDir(\n    (tmpDir) => {\n      const stubs = getStubs();\n      stubs.signAddon = () => Promise.reject(new Error('some signing error'));\n\n      return sign(tmpDir, stubs)\n        .then(makeSureItFails())\n        .catch((error) => {\n          assert.match(error.message, /signing error/);\n        });\n    }\n  ));\n\n  describe('saveIdToSourceDir', () => {\n\n    it('saves an extension ID to file', () => withTempDir(\n      (tmpDir) => {\n        const sourceDir = tmpDir.path();\n        return saveIdToSourceDir(sourceDir, 'some-id')\n          .then(() => fs.readFile(path.join(sourceDir, extensionIdFile)))\n          .then((content) => {\n            assert.include(content.toString(), 'some-id');\n          });\n      }\n    ));\n\n    it('will overwrite an existing file', () => withTempDir(\n      (tmpDir) => {\n        const sourceDir = tmpDir.path();\n        return saveIdToSourceDir(sourceDir, 'first-id')\n          .then(() => saveIdToSourceDir(sourceDir, 'second-id'))\n          .then(() => getIdFromSourceDir(sourceDir))\n          .then((savedId) => {\n            assert.equal(savedId, 'second-id');\n          });\n      }\n    ));\n\n  });\n\n  describe('getIdFromSourceDir', () => {\n\n    it('gets a saved extension ID', () => withTempDir(\n      (tmpDir) => {\n        const sourceDir = tmpDir.path();\n        return saveIdToSourceDir(sourceDir, 'some-id')\n          .then(() => getIdFromSourceDir(sourceDir))\n          .then((extensionId) => {\n            assert.equal(extensionId, 'some-id');\n          });\n      }\n    ));\n\n    it('throws an error for empty files', () => withTempDir(\n      (tmpDir) => {\n        const sourceDir = tmpDir.path();\n        return fs.writeFile(path.join(sourceDir, extensionIdFile), '')\n          .then(() => getIdFromSourceDir(sourceDir))\n          .then(makeSureItFails())\n          .catch(onlyInstancesOf(UsageError, (error) => {\n            assert.match(error.message, /No ID found in extension ID file/);\n          }));\n      }\n    ));\n\n    it('returns empty ID when extension file does not exist', () => withTempDir(\n      (tmpDir) => {\n        const sourceDir = tmpDir.path();\n        return getIdFromSourceDir(sourceDir)\n          .then((savedId) => {\n            assert.strictEqual(savedId, undefined);\n          });\n      }\n    ));\n\n  });\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-cmd/test.sign.js","module.exports = require(\"copy-dir\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"copy-dir\"\n// module id = 167\n// module chunks = 0","/* @flow */\nimport path from 'path';\n\nimport {fs} from 'mz';\nimport defaultAddonSigner from 'sign-addon';\n\nimport defaultBuilder from './build';\nimport getValidatedManifest, {getManifestId} from '../util/manifest';\nimport {withTempDir} from '../util/temp-dir';\nimport {isErrorWithCode, UsageError, WebExtError} from '../errors';\nimport {prepareArtifactsDir} from '../util/artifacts';\nimport {createLogger} from '../util/logger';\nimport type {ExtensionManifest} from '../util/manifest';\n\n\nconst log = createLogger(__filename);\n\nexport const extensionIdFile = '.web-extension-id';\n\n// Sign command types and implementation.\n\nexport type SignParams = {|\n  id?: string,\n  verbose?: boolean,\n  sourceDir: string,\n  artifactsDir: string,\n  ignoreFiles?: Array<string>,\n  apiKey: string,\n  apiSecret: string,\n  apiUrlPrefix: string,\n  apiProxy: string,\n  timeout: number,\n|};\n\nexport type SignOptions = {\n  build?: typeof defaultBuilder,\n  signAddon?: typeof defaultAddonSigner,\n  preValidatedManifest?: ExtensionManifest,\n};\n\nexport type SignResult = {|\n  success: boolean,\n  id: string,\n  downloadedFiles: Array<string>,\n|};\n\nexport default function sign(\n  {\n    verbose, sourceDir, artifactsDir, ignoreFiles = [],\n    apiKey, apiSecret, apiUrlPrefix, apiProxy, id, timeout,\n  }: SignParams,\n  {\n    build = defaultBuilder, signAddon = defaultAddonSigner,\n    preValidatedManifest,\n  }: SignOptions = {}\n): Promise<SignResult> {\n  return withTempDir(\n    async function(tmpDir) {\n      await prepareArtifactsDir(artifactsDir);\n\n      let manifestData;\n\n      if (preValidatedManifest) {\n        manifestData = preValidatedManifest;\n      } else {\n        manifestData = await getValidatedManifest(sourceDir);\n      }\n\n      const [buildResult, idFromSourceDir] = await Promise.all([\n        build({sourceDir, ignoreFiles, artifactsDir: tmpDir.path()},\n              {manifestData, showReadyMessage: false}),\n        getIdFromSourceDir(sourceDir),\n      ]);\n\n      const manifestId = getManifestId(manifestData);\n\n      if (id && manifestId) {\n        throw new UsageError(\n          `Cannot set custom ID ${id} because manifest.json ` +\n          `declares ID ${manifestId}`);\n      }\n      if (id) {\n        log.debug(`Using custom ID declared as --id=${id}`);\n      }\n\n      if (manifestId) {\n        id = manifestId;\n      }\n\n      if (!id && idFromSourceDir) {\n        log.info(\n          `Using previously auto-generated extension ID: ${idFromSourceDir}`);\n        id = idFromSourceDir;\n      }\n\n      if (!id) {\n        log.warn('No extension ID specified (it will be auto-generated)');\n      }\n\n      const signingResult = await signAddon({\n        apiKey,\n        apiSecret,\n        apiUrlPrefix,\n        apiProxy,\n        timeout,\n        verbose,\n        id,\n        xpiPath: buildResult.extensionPath,\n        version: manifestData.version,\n        downloadDir: artifactsDir,\n      });\n\n      if (signingResult.id) {\n        await saveIdToSourceDir(sourceDir, signingResult.id);\n      }\n\n      // All information about the downloaded files would have\n      // already been logged by signAddon().\n      if (signingResult.success) {\n        log.info(`Extension ID: ${signingResult.id}`);\n        log.info('SUCCESS');\n      } else {\n        log.info('FAIL');\n        throw new WebExtError(\n          'The WebExtension could not be signed');\n      }\n\n      return signingResult;\n    }\n  );\n}\n\n\nexport async function getIdFromSourceDir(\n  sourceDir: string\n): Promise<string | void> {\n  const filePath = path.join(sourceDir, extensionIdFile);\n\n  let content;\n\n  try {\n    content = await fs.readFile(filePath);\n  } catch (error) {\n    if (isErrorWithCode('ENOENT', error)) {\n      log.debug(`No ID file found at: ${filePath}`);\n      return;\n    }\n    throw error;\n  }\n\n  let lines = content.toString().split('\\n');\n  lines = lines.filter((line) => {\n    line = line.trim();\n    if (line && !line.startsWith('#')) {\n      return line;\n    }\n  });\n\n  const id = lines[0];\n  log.debug(`Found extension ID ${id} in ${filePath}`);\n\n  if (!id) {\n    throw new UsageError(`No ID found in extension ID file ${filePath}`);\n  }\n\n  return id;\n}\n\n\nexport async function saveIdToSourceDir(\n  sourceDir: string, id: string\n): Promise<void> {\n  const filePath = path.join(sourceDir, extensionIdFile);\n  await fs.writeFile(filePath, [\n    '# This file was created by https://github.com/mozilla/web-ext',\n    '# Your auto-generated extension ID for addons.mozilla.org is:',\n    id.toString(),\n  ].join('\\n'));\n\n  log.debug(`Saved auto-generated ID ${id} to ${filePath}`);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/cmd/sign.js","module.exports = require(\"sign-addon\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sign-addon\"\n// module id = 169\n// module chunks = 0","/* @flow */\nimport path from 'path';\n\nimport deepcopy from 'deepcopy';\nimport sinon from 'sinon';\nimport FirefoxProfile from 'firefox-profile';\nimport {describe, it} from 'mocha';\nimport {assert} from 'chai';\nimport {fs} from 'mz';\n\nimport * as firefox from '../../../src/firefox';\nimport {onlyInstancesOf, UsageError, WebExtError} from '../../../src/errors';\nimport {withTempDir} from '../../../src/util/temp-dir';\nimport {TCPConnectError, fixturePath, fake, makeSureItFails} from '../helpers';\nimport {basicManifest, manifestWithoutApps} from '../test-util/test.manifest';\nimport {RemoteFirefox} from '../../../src/firefox/remote';\nimport type {RemotePortFinderParams} from '../../../src/firefox/index';\n\nconst {defaultFirefoxEnv} = firefox;\n\nfunction withBaseProfile(callback) {\n  return withTempDir(\n    (tmpDir) => {\n      const baseProfile = new FirefoxProfile({\n        destinationDirectory: tmpDir.path(),\n      });\n      return callback(baseProfile);\n    }\n  );\n}\n\ndescribe('firefox', () => {\n\n  describe('run', () => {\n\n    const fakeProfile = {\n      path: () => '/dev/null/some-profile-path',\n    };\n\n    const fakeFirefoxProcess = {\n      on: (eventName, callback) => {\n        if (eventName === 'close') {\n          // Immediately \"emit\" a close event to complete the test.\n          callback();\n        }\n      },\n      stdout: {on: () => {}},\n      stderr: {on: () => {}},\n    };\n\n    function createFakeFxRunner(firefoxOverrides = {}) {\n      const fxProcess = {\n        ...deepcopy(fakeFirefoxProcess),\n        ...firefoxOverrides,\n      };\n      return sinon.spy(() => Promise.resolve({args: [], process: fxProcess}));\n    }\n\n    // TODO: This object should accept dynamic properties since those are passed to firefox.run()\n\n    type RunFirefoxOptions = {\n      profile?: typeof FirefoxProfile,\n    }\n\n    function runFirefox(\n      {\n        profile = fakeProfile,\n        ...args\n      }: RunFirefoxOptions = {},\n    ) {\n      return firefox.run(profile, {\n        fxRunner: createFakeFxRunner(),\n        findRemotePort: () => Promise.resolve(6000),\n        ...args,\n      });\n    }\n\n    it('executes the Firefox runner with a given profile', () => {\n      const runner = createFakeFxRunner();\n      const profile = fakeProfile;\n      return runFirefox({fxRunner: runner, profile})\n        .then(() => {\n          assert.equal(runner.called, true);\n          assert.equal(runner.firstCall.args[0].profile,\n                       profile.path());\n        });\n    });\n\n    it('starts the remote debugger on a discovered port', () => {\n      const port = 6001;\n      const runner = createFakeFxRunner();\n      const findRemotePort = sinon.spy(() => Promise.resolve(port));\n      return runFirefox({fxRunner: runner, findRemotePort})\n        .then(() => {\n          assert.equal(runner.called, true);\n          assert.equal(runner.firstCall.args[0].listen, port);\n        });\n    });\n\n    it('passes binary args to Firefox', () => {\n      const fxRunner = createFakeFxRunner();\n      const binaryArgs = '--safe-mode';\n      return runFirefox({fxRunner, binaryArgs})\n        .then(() => {\n          assert.equal(fxRunner.called, true);\n          assert.equal(fxRunner.firstCall.args[0]['binary-args'],\n                       binaryArgs);\n        });\n    });\n\n    it('sets up a Firefox process environment', () => {\n      const runner = createFakeFxRunner();\n      // Make sure it passes through process environment variables.\n      process.env._WEB_EXT_FIREFOX_ENV_TEST = 'thing';\n      return runFirefox({fxRunner: runner})\n        .then(() => {\n          const declaredEnv = runner.firstCall.args[0].env;\n          for (const key in defaultFirefoxEnv) {\n            assert.equal(declaredEnv[key], defaultFirefoxEnv[key]);\n          }\n          assert.equal(declaredEnv._WEB_EXT_FIREFOX_ENV_TEST, 'thing');\n        });\n    });\n\n    it('fails on a firefox error', () => {\n      const someError = new Error('some internal firefox error');\n      const runner = createFakeFxRunner({\n        on: (eventName, callback) => {\n          if (eventName === 'error') {\n            // Immediately \"emit\" an error event.\n            callback(someError);\n          }\n        },\n      });\n\n      return runFirefox({fxRunner: runner})\n        .then(makeSureItFails())\n        .catch((error) => {\n          assert.equal(error.message, someError.message);\n        });\n    });\n\n    it('passes a custom Firefox binary when specified', () => {\n      const runner = createFakeFxRunner();\n      const firefoxBinary = '/pretend/path/to/firefox-bin';\n      return runFirefox({fxRunner: runner, firefoxBinary})\n        .then(() => {\n          assert.equal(runner.called, true);\n          assert.equal(runner.firstCall.args[0].binary,\n                       firefoxBinary);\n        });\n    });\n\n    it('logs stdout and stderr without errors', () => {\n      // Store a registry of handlers that we can execute directly.\n      const firefoxApp = {};\n      const runner = createFakeFxRunner({\n        stdout: {\n          on: (event, handler) => {\n            firefoxApp.writeStdout = handler;\n          },\n        },\n        stderr: {\n          on: (event, handler) => {\n            firefoxApp.writeStderr = handler;\n          },\n        },\n      });\n\n      return runFirefox({fxRunner: runner})\n        .then(() => {\n          // This makes sure that when each handler writes to the\n          // logger they don't raise any exceptions.\n          firefoxApp.writeStdout('example of stdout');\n          firefoxApp.writeStderr('example of stderr');\n        });\n    });\n\n  });\n\n  describe('copyProfile', () => {\n\n    it('copies a profile', () => withBaseProfile(\n      (baseProfile) => {\n        baseProfile.setPreference('webext.customSetting', true);\n        baseProfile.updatePreferences();\n\n        return firefox.copyProfile(baseProfile.path(),\n          {configureThisProfile: (profile) => Promise.resolve(profile)})\n          .then((profile) => fs.readFile(profile.userPrefs))\n          .then((userPrefs) => {\n            assert.include(userPrefs.toString(), 'webext.customSetting');\n          });\n      }\n    ));\n\n    it('requires a valid profile directory', () => {\n      // This stubs out the code that looks for a named\n      // profile because on Travis CI there will not be a Firefox\n      // user directory.\n      const copyFromUserProfile = sinon.spy(\n        (config, cb) => cb(new Error('simulated: could not find profile')));\n\n      return firefox.copyProfile('/dev/null/non_existent_path',\n        {\n          copyFromUserProfile,\n          configureThisProfile: (profile) => Promise.resolve(profile),\n        })\n        .then(makeSureItFails())\n        .catch(onlyInstancesOf(WebExtError, (error) => {\n          assert.equal(copyFromUserProfile.called, true);\n          assert.match(\n            error.message,\n            /Could not copy Firefox profile from .*non_existent_path/);\n        }));\n    });\n\n    it('can copy a profile by name', () => {\n      const name = 'some-fake-firefox-profile-name';\n      // Fake profile object:\n      const profileToCopy = {\n        defaultPreferences: {\n          thing: 'value',\n        },\n      };\n      const copyFromUserProfile = sinon.spy(\n        (config, callback) => callback(null, profileToCopy));\n\n      return firefox.copyProfile(name,\n        {\n          copyFromUserProfile,\n          configureThisProfile: (profile) => Promise.resolve(profile),\n        })\n        .then((profile) => {\n          assert.equal(copyFromUserProfile.called, true);\n          assert.equal(copyFromUserProfile.firstCall.args[0].name, name);\n          assert.equal(profile.defaultPreferences.thing,\n                       profileToCopy.defaultPreferences.thing);\n        });\n    });\n\n    it('configures the copied profile', () => withBaseProfile(\n      (baseProfile) => {\n        const app = 'fennec';\n        const configureThisProfile =\n          sinon.spy((profile) => Promise.resolve(profile));\n\n        return firefox.copyProfile(baseProfile.path(),\n          {app, configureThisProfile})\n          .then((profile) => {\n            assert.equal(configureThisProfile.called, true);\n            assert.equal(configureThisProfile.firstCall.args[0], profile);\n            assert.equal(configureThisProfile.firstCall.args[1].app, app);\n          });\n      }\n    ));\n\n  });\n\n  describe('createProfile', () => {\n\n    it('resolves with a profile object', () => {\n      return firefox.createProfile(\n        {configureThisProfile: (profile) => Promise.resolve(profile)})\n        .then((profile) => {\n          assert.instanceOf(profile, FirefoxProfile);\n        });\n    });\n\n    it('creates a Firefox profile', () => {\n      // This is a quick and paranoid sanity check that the FirefoxProfile\n      // object is real and has some preferences.\n      return firefox.createProfile(\n        {configureThisProfile: (profile) => Promise.resolve(profile)})\n        .then((profile) => {\n          profile.updatePreferences();\n          return fs.readFile(path.join(profile.path(), 'user.js'));\n        })\n        .then((prefFile) => {\n          // Check for some default pref set by FirefoxProfile.\n          assert.include(prefFile.toString(),\n                         '\"startup.homepage_welcome_url\", \"about:blank\"');\n        });\n    });\n\n    it('configures a profile', () => {\n      const configureThisProfile =\n        sinon.spy((profile) => Promise.resolve(profile));\n      const app = 'fennec';\n      return firefox.createProfile({app, configureThisProfile})\n        .then((profile) => {\n          assert.equal(configureThisProfile.called, true);\n          assert.equal(configureThisProfile.firstCall.args[0], profile);\n          assert.equal(configureThisProfile.firstCall.args[1].app, app);\n        });\n    });\n\n  });\n\n  describe('useProfile', () => {\n\n    it('resolves to a FirefoxProfile instance', () => withBaseProfile(\n      (baseProfile) => {\n        const configureThisProfile = (profile) => Promise.resolve(profile);\n        return firefox.useProfile(baseProfile.path(), {configureThisProfile})\n          .then((profile) => {\n            assert.instanceOf(profile, FirefoxProfile);\n          });\n      }\n    ));\n\n    it('configures a profile', () => withBaseProfile(\n      (baseProfile) => {\n        const configureThisProfile =\n          sinon.spy((profile) => Promise.resolve(profile));\n        const app = 'fennec';\n        const profilePath = baseProfile.path();\n        return firefox.useProfile(profilePath, {app, configureThisProfile})\n          .then((profile) => {\n            assert.equal(configureThisProfile.called, true);\n            assert.equal(configureThisProfile.firstCall.args[0], profile);\n            assert.equal(configureThisProfile.firstCall.args[1].app, app);\n          });\n      }\n    ));\n\n  });\n\n  describe('configureProfile', () => {\n\n    function withTempProfile(callback) {\n      return withTempDir((tmpDir) => {\n        const profile = new FirefoxProfile({\n          destinationDirectory: tmpDir.path(),\n        });\n        return callback(profile);\n      });\n    }\n\n    it('resolves with a profile', () => withTempProfile(\n      (profile) => {\n        const fakePrefGetter = sinon.stub().returns({});\n        return firefox.configureProfile(profile, {getPrefs: fakePrefGetter})\n          .then((configuredProfile) => {\n            assert.instanceOf(configuredProfile, FirefoxProfile);\n          });\n      }\n    ));\n\n    it('sets Firefox preferences', () => withTempProfile(\n      (profile) => {\n        const fakePrefGetter = sinon.stub().returns({});\n        return firefox.configureProfile(profile, {getPrefs: fakePrefGetter})\n          .then(() => {\n            assert.equal(fakePrefGetter.firstCall.args[0], 'firefox');\n          });\n      }\n    ));\n\n    it('sets Fennec preferences', () => withTempProfile(\n      (profile) => {\n        const fakePrefGetter = sinon.stub().returns({});\n        return firefox.configureProfile(\n          profile, {\n            getPrefs: fakePrefGetter,\n            app: 'fennec',\n          })\n          .then(() => {\n            assert.equal(fakePrefGetter.firstCall.args[0], 'fennec');\n          });\n      }\n    ));\n\n    it('writes new preferences', () => withTempProfile(\n      (profile) => {\n        // This is a quick sanity check that real preferences were\n        // written to disk.\n        return firefox.configureProfile(profile)\n          .then((configuredProfile) => {\n            return fs.readFile(path.join(configuredProfile.path(), 'user.js'));\n          })\n          .then((prefFile) => {\n            // Check for some pref set by configureProfile().\n            assert.include(prefFile.toString(),\n                           '\"devtools.debugger.remote-enabled\", true');\n          });\n      }\n    ));\n\n    it('writes custom preferences', () => withTempProfile(\n      (profile) => {\n        const customPrefs = {'extensions.checkCompatibility.nightly': true};\n        return firefox.configureProfile(profile, {customPrefs})\n          .then((configuredProfile) => {\n            return fs.readFile(path.join(configuredProfile.path(), 'user.js'));\n          })\n          .then((prefFile) => {\n            // Check for custom pref set by configureProfile().\n            assert.include(prefFile.toString(),\n                           '\"extensions.checkCompatibility.nightly\", true');\n            // Check that one of the default preferences is set as well\n            assert.include(prefFile.toString(),\n                           '\"devtools.debugger.remote-enabled\", true');\n          });\n      }\n    ));\n\n  });\n\n  describe('installExtension', () => {\n\n    function setUp(testPromise: Function) {\n      return withTempDir(\n        (tmpDir) => {\n          const data = {\n            extensionPath: fixturePath('minimal_extension-1.0.zip'),\n            profile: undefined,\n            profileDir: path.join(tmpDir.path(), 'profile'),\n          };\n          return fs.mkdir(data.profileDir)\n            .then(() => {\n              data.profile = new FirefoxProfile({\n                destinationDirectory: data.profileDir,\n              });\n            })\n            .then(() => testPromise(data));\n        });\n    }\n\n    function installBasicExt(data) {\n      return firefox.installExtension({\n        manifestData: basicManifest,\n        profile: data.profile,\n        extensionPath: data.extensionPath,\n      });\n    }\n\n    it('installs an extension file into a profile', () => setUp(\n      (data) => {\n        return installBasicExt(data)\n          .then(() => fs.readdir(data.profile.extensionsDir))\n          .then((files) => {\n            assert.deepEqual(\n              files, ['basic-manifest@web-ext-test-suite.xpi']);\n          });\n      }\n    ));\n\n    it('requires a manifest ID', () => setUp(\n      (data) => {\n        return firefox.installExtension(\n          {\n            manifestData: manifestWithoutApps,\n            profile: data.profile,\n            extensionPath: data.extensionPath,\n          })\n          .then(makeSureItFails())\n          .catch(onlyInstancesOf(UsageError, (error) => {\n            assert.match(error.message,\n                         /explicit extension ID is required/);\n          }));\n      }\n    ));\n\n    it('can install the extension as a proxy', () => setUp(\n      (data) => {\n        const sourceDir = fixturePath('minimal-web-ext');\n        return firefox.installExtension(\n          {\n            manifestData: basicManifest,\n            profile: data.profile,\n            extensionPath: sourceDir,\n            asProxy: true,\n          })\n          .then(() => {\n            const proxyFile = path.join(data.profile.extensionsDir,\n                                        'basic-manifest@web-ext-test-suite');\n            return fs.readFile(proxyFile);\n          })\n          .then((proxyData) => {\n            // The proxy file should contain the path to the extension.\n            assert.equal(proxyData.toString(), sourceDir);\n          });\n      }\n    ));\n\n    it('requires a directory path for proxy installs', () => setUp(\n      (data) => {\n        const extensionPath = fixturePath('minimal_extension-1.0.zip');\n        return firefox.installExtension(\n          {\n            manifestData: basicManifest,\n            profile: data.profile,\n            extensionPath,\n            asProxy: true,\n          })\n          .then(makeSureItFails())\n          .catch(onlyInstancesOf(WebExtError, (error) => {\n            assert.match(error.message,\n                         /must be the extension source directory/);\n            assert.include(error.message, extensionPath);\n          }));\n      }\n    ));\n\n    it('re-uses an existing extension directory', () => setUp(\n      (data) => {\n        return fs.mkdir(path.join(data.profile.extensionsDir))\n          .then(() => installBasicExt(data))\n          .then(() => fs.stat(data.profile.extensionsDir));\n      }\n    ));\n\n    it('checks for an empty extensionsDir', () => setUp(\n      (data) => {\n        data.profile.extensionsDir = undefined;\n        return installBasicExt(data)\n          .then(makeSureItFails())\n          .catch(onlyInstancesOf(WebExtError, (error) => {\n            assert.match(error.message, /unexpectedly empty/);\n          }));\n      }\n    ));\n\n  });\n\n  describe('defaultRemotePortFinder', () => {\n\n    function findRemotePort({...args}: RemotePortFinderParams = {}) {\n      return firefox.defaultRemotePortFinder({...args});\n    }\n\n    it('resolves to an open port', () => {\n      const connectToFirefox = sinon.spy(\n        () => Promise.reject(new TCPConnectError()));\n      return findRemotePort({connectToFirefox})\n        .then((port) => {\n          assert.isNumber(port);\n        });\n    });\n\n    it('returns a port on first try', () => {\n      const connectToFirefox = sinon.spy(() => new Promise(\n        (resolve, reject) => {\n          reject(\n            new TCPConnectError('first call connection fails - port is free')\n          );\n        }));\n      return findRemotePort({connectToFirefox, retriesLeft: 2})\n        .then((port) => {\n          assert.equal(connectToFirefox.callCount, 1);\n          assert.isNumber(port);\n        });\n    });\n\n    it('cancels search after too many fails', () => {\n      const client = fake(RemoteFirefox.prototype);\n      const connectToFirefox = sinon.spy(() => new Promise(\n        (resolve) => resolve(client)));\n      return findRemotePort({connectToFirefox, retriesLeft: 2})\n        .catch((err) => {\n          assert.equal(err, 'WebExtError: Too many retries on port search');\n          assert.equal(connectToFirefox.callCount, 3);\n        });\n    });\n\n    it('retries port discovery after first failure', () => {\n      const client = fake(RemoteFirefox.prototype);\n      let callCount = 0;\n      const connectToFirefox = sinon.spy(() => {\n        callCount++;\n        return new Promise((resolve, reject) => {\n          if (callCount === 2) {\n            reject(new TCPConnectError('port is free'));\n          } else {\n            resolve(client);\n          }\n        });\n      });\n      return findRemotePort({connectToFirefox, retriesLeft: 2})\n        .then((port) => {\n          assert.isNumber(port);\n          assert.equal(connectToFirefox.callCount, 2);\n        });\n    });\n\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-firefox/test.firefox.js","/* @flow */\nimport {describe, it} from 'mocha';\nimport {assert} from 'chai';\n\nimport {WebExtError, UsageError} from '../../../src/errors';\nimport {\n  getPrefs, coerceCLICustomPreference, nonOverridablePreferences,\n} from '../../../src/firefox/preferences';\n\n\ndescribe('firefox/preferences', () => {\n\n  describe('getPrefs', () => {\n\n    it('gets Firefox prefs with some defaults', () => {\n      const prefs = getPrefs();\n      // This is a commonly shared pref.\n      assert.equal(prefs['devtools.debugger.remote-enabled'], true);\n      // This is a Firefox only pref.\n      assert.equal(prefs['devtools.chrome.enabled'], true);\n    });\n\n    it('gets Fennec prefs with some defaults', () => {\n      const prefs = getPrefs('fennec');\n      // This is a commonly shared pref.\n      assert.equal(prefs['devtools.debugger.remote-enabled'], true);\n      // This is a Fennec only pref.\n      assert.equal(prefs['browser.console.showInPanel'], true);\n    });\n\n    it('throws an error for unsupported apps', () => {\n      // $FLOW_IGNORE: ignore type errors on testing nonexistent 'thunderbird' prefs\n      assert.throws(() => getPrefs('thunderbird'),\n                    WebExtError, /Unsupported application: thunderbird/);\n    });\n\n  });\n\n  describe('coerceCLICustomPreference', () => {\n\n    it('converts a single --pref cli option from string to object', () => {\n      const prefs = coerceCLICustomPreference('valid.preference=true');\n      assert.isObject(prefs);\n      assert.equal(prefs['valid.preference'], true);\n    });\n\n    it('converts array of --pref cli option values into object', () => {\n      const prefs = coerceCLICustomPreference([\n        'valid.preference=true', 'valid.preference2=false',\n      ]);\n      assert.isObject(prefs);\n      assert.equal(prefs['valid.preference'], true);\n      assert.equal(prefs['valid.preference2'], false);\n    });\n\n    it('converts boolean values', () => {\n      const prefs = coerceCLICustomPreference('valid.preference=true');\n      assert.equal(prefs['valid.preference'], true);\n    });\n\n    it('converts number values', () => {\n      const prefs = coerceCLICustomPreference('valid.preference=455');\n      assert.equal(prefs['valid.preference'], 455);\n    });\n\n    it('converts float values', () => {\n      const prefs = coerceCLICustomPreference('valid.preference=4.55');\n      assert.equal(prefs['valid.preference'], '4.55');\n    });\n\n    it('supports string values with \"=\" chars', () => {\n      const prefs = coerceCLICustomPreference(\n        'valid.preference=value=withequals=chars'\n      );\n      assert.equal(prefs['valid.preference'], 'value=withequals=chars');\n    });\n\n    it('does not allow certain default preferences to be customized', () => {\n      const nonChangeablePrefs = nonOverridablePreferences.map((prop) => {\n        return prop += '=true';\n      });\n      const prefs = coerceCLICustomPreference(nonChangeablePrefs);\n      for (const pref of nonChangeablePrefs) {\n        assert.isUndefined(prefs[pref], `${pref} should be undefined`);\n      }\n    });\n\n    it('throws an error for invalid or incomplete preferences', () => {\n      assert.throws(\n        () => coerceCLICustomPreference('test.invalid.prop'),\n        UsageError,\n        'UsageError: Incomplete custom preference: \"test.invalid.prop\". ' +\n        'Syntax expected: \"prefname=prefvalue\".'\n      );\n\n      assert.throws(() => coerceCLICustomPreference('*&%£=true'),\n                    UsageError,\n                    'UsageError: Invalid custom preference name: *&%£');\n    });\n\n  });\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-firefox/test.preferences.js","/* @flow */\nimport {describe, it} from 'mocha';\nimport {assert} from 'chai';\nimport sinon from 'sinon';\n\nimport {RemoteTempInstallNotSupported, UsageError, WebExtError, onlyInstancesOf}\n  from '../../../src/errors';\nimport {fakeFirefoxClient, makeSureItFails} from '../helpers';\nimport {default as defaultConnector, RemoteFirefox}\n  from '../../../src/firefox/remote';\n\n\ndescribe('firefox.remote', () => {\n\n  describe('connect', () => {\n\n    function prepareConnection(port = undefined, options = {}) {\n      options = {\n        connectToFirefox:\n          sinon.spy(() => Promise.resolve(fakeFirefoxClient())),\n        ...options,\n      };\n      const connect = defaultConnector(port, options);\n      return {options, connect};\n    }\n\n    it('resolves with a RemoteFirefox instance', () => {\n      return prepareConnection().connect.then((client) => {\n        assert.instanceOf(client, RemoteFirefox);\n      });\n    });\n\n    it('connects on the default port', () => {\n      const {connect, options} = prepareConnection();\n      return connect.then(() => {\n        assert.equal(options.connectToFirefox.firstCall.args[0], 6005);\n      });\n    });\n\n    it('lets you configure the port', () => {\n      const {connect, options} = prepareConnection(7000);\n      return connect.then(() => {\n        assert.equal(options.connectToFirefox.args[0], 7000);\n      });\n    });\n\n  });\n\n  describe('RemoteFirefox', () => {\n\n    function fakeAddon() {\n      return {id: 'some-id', actor: 'serv1.localhost'};\n    }\n\n    function makeInstance(client = fakeFirefoxClient()) {\n      return new RemoteFirefox(client);\n    }\n\n    it('listens to client events', () => {\n      const client = fakeFirefoxClient();\n      const listener = sinon.spy(() => {});\n      client.client.on = listener;\n      makeInstance(client); // this will register listeners\n      // Make sure no errors are thrown when the client emits\n      // events and calls each handler.\n      listener.firstCall.args[1](); // disconnect\n      listener.secondCall.args[1](); // end\n      listener.thirdCall.args[1]({}); // message\n    });\n\n    describe('disconnect', () => {\n      it('lets you disconnect', () => {\n        const client = fakeFirefoxClient();\n        const conn = makeInstance(client);\n        conn.disconnect();\n        assert.equal(client.disconnect.called, true);\n      });\n    });\n\n    describe('addonRequest', () => {\n\n      it('makes requests to an add-on actor', () => {\n        const addon = fakeAddon();\n        const stubResponse = {requestTypes: ['reload']};\n        const client = fakeFirefoxClient({\n          makeRequestResult: stubResponse,\n        });\n\n        const conn = makeInstance(client);\n        return conn.addonRequest(addon, 'requestTypes')\n          .then((response) => {\n\n            assert.equal(client.client.makeRequest.called, true);\n            const args = client.client.makeRequest.firstCall.args;\n            assert.equal(args[0].type, 'requestTypes');\n            assert.equal(args[0].to, 'serv1.localhost');\n\n            assert.deepEqual(response, stubResponse);\n          });\n      });\n\n      it('throws when add-on actor requests fail', () => {\n        const addon = fakeAddon();\n        const client = fakeFirefoxClient({\n          makeRequestError: {\n            error: 'unknownError',\n            message: 'some actor failure',\n          },\n        });\n\n        const conn = makeInstance(client);\n        return conn.addonRequest(addon, 'requestTypes')\n          .then(makeSureItFails())\n          .catch(onlyInstancesOf(WebExtError, (error) => {\n            assert.equal(\n              error.message,\n              'unknownError: some actor failure');\n          }));\n      });\n    });\n\n    describe('getInstalledAddon', () => {\n\n      it('gets an installed add-on by ID', () => {\n        const someAddonId = 'some-id';\n        const client = fakeFirefoxClient({\n          requestResult: {\n            addons: [{id: 'another-id'}, {id: someAddonId}, {id: 'bazinga'}],\n          },\n        });\n        const conn = makeInstance(client);\n        return conn.getInstalledAddon(someAddonId)\n          .then((addon) => {\n            assert.equal(addon.id, someAddonId);\n          });\n      });\n\n      it('throws an error when the add-on is not installed', () => {\n        const client = fakeFirefoxClient({\n          requestResult: {\n            addons: [{id: 'one-id'}, {id: 'other-id'}],\n          },\n        });\n        const conn = makeInstance(client);\n        return conn.getInstalledAddon('missing-id')\n          .then(makeSureItFails())\n          .catch(onlyInstancesOf(WebExtError, (error) => {\n            assert.match(error.message,\n                         /does not have your extension installed/);\n          }));\n      });\n\n      it('throws an error when listAddons() fails', () => {\n        const client = fakeFirefoxClient({\n          requestError: new Error('some internal error'),\n        });\n        const conn = makeInstance(client);\n        return conn.getInstalledAddon('some-id')\n          .then(makeSureItFails())\n          .catch(onlyInstancesOf(WebExtError, (error) => {\n            assert.equal(\n              error.message,\n              'Remote Firefox: listAddons() error: Error: some internal error');\n          }));\n      });\n    });\n\n    describe('checkForAddonReloading', () => {\n\n      it('checks for reload requestType in remote debugger', () => {\n        const addon = fakeAddon();\n        const stubResponse = {requestTypes: ['reload']};\n\n        const conn = makeInstance();\n        // $FLOW_IGNORE: override class method for testing reasons.\n        conn.addonRequest = sinon.spy(() => Promise.resolve(stubResponse));\n\n        return conn.checkForAddonReloading(addon)\n          .then((returnedAddon) => {\n            assert.equal(conn.addonRequest.called, true);\n            const args = conn.addonRequest.firstCall.args;\n\n            assert.equal(args[0].id, addon.id);\n            assert.equal(args[1], 'requestTypes');\n\n            assert.deepEqual(returnedAddon, addon);\n          });\n      });\n\n      it('throws an error if reload is not supported', () => {\n        const addon = fakeAddon();\n        const stubResponse = {requestTypes: ['install']};\n        const conn = makeInstance();\n        // $FLOW_IGNORE: override class method for testing reasons.\n        conn.addonRequest = () => Promise.resolve(stubResponse);\n\n        return conn.checkForAddonReloading(addon)\n          .then(makeSureItFails())\n          .catch(onlyInstancesOf(UsageError, (error) => {\n            assert.match(error.message, /does not support add-on reloading/);\n          }));\n      });\n\n      it('only checks for reloading once', () => {\n        const addon = fakeAddon();\n        const conn = makeInstance();\n        // $FLOW_IGNORE: override class method for testing reasons.\n        conn.addonRequest =\n          sinon.spy(() => Promise.resolve({requestTypes: ['reload']}));\n        return conn.checkForAddonReloading(addon)\n          .then((checkedAddon) => conn.checkForAddonReloading(checkedAddon))\n          .then((finalAddon) => {\n            // This should remember not to check a second time.\n            assert.equal(conn.addonRequest.callCount, 1);\n            assert.deepEqual(finalAddon, addon);\n          });\n      });\n    });\n\n    describe('installTemporaryAddon', () => {\n\n      it('throws listTabs errors', () => {\n        const client = fakeFirefoxClient({\n          // listTabs response:\n          requestError: new Error('some listTabs error'),\n        });\n        const conn = makeInstance(client);\n        return conn.installTemporaryAddon('/path/to/addon')\n          .then(makeSureItFails())\n          .catch(onlyInstancesOf(WebExtError, (error) => {\n            assert.match(error.message, /some listTabs error/);\n          }));\n      });\n\n      it('fails when there is no add-ons actor', () => {\n        const client = fakeFirefoxClient({\n          // A listTabs response that does not contain addonsActor.\n          requestResult: {},\n        });\n        const conn = makeInstance(client);\n        return conn.installTemporaryAddon('/path/to/addon')\n          .then(makeSureItFails())\n          .catch(onlyInstancesOf(RemoteTempInstallNotSupported, (error) => {\n            assert.match(error.message, /does not provide an add-ons actor/);\n          }));\n      });\n\n      it('lets you install an add-on temporarily', () => {\n        const client = fakeFirefoxClient({\n          // listTabs response:\n          requestResult: {\n            addonsActor: 'addons1.actor.conn',\n          },\n          // installTemporaryAddon response:\n          makeRequestResult: {\n            addon: {id: 'abc123@temporary-addon'},\n          },\n        });\n        const conn = makeInstance(client);\n        return conn.installTemporaryAddon('/path/to/addon')\n          .then((response) => {\n            assert.equal(response.addon.id, 'abc123@temporary-addon');\n          });\n      });\n\n      it('throws install errors', () => {\n        const client = fakeFirefoxClient({\n          // listTabs response:\n          requestResult: {\n            addonsActor: 'addons1.actor.conn',\n          },\n          // installTemporaryAddon response:\n          makeRequestError: {\n            error: 'install error',\n            message: 'error message',\n          },\n        });\n        const conn = makeInstance(client);\n        return conn.installTemporaryAddon('/path/to/addon')\n          .then(makeSureItFails())\n          .catch(onlyInstancesOf(WebExtError, (error) => {\n            assert.match(error.message, /install error: error message/);\n          }));\n      });\n\n    });\n\n    describe('reloadAddon', () => {\n\n      it('asks the actor to reload the add-on', () => {\n        const addon = fakeAddon();\n        const conn = makeInstance();\n        // $FLOW_IGNORE: override class method for testing reasons.\n        conn.getInstalledAddon = sinon.spy(() => Promise.resolve(addon));\n        // $FLOW_IGNORE: override class method for testing reasons.\n        conn.checkForAddonReloading =\n          (addonToCheck) => Promise.resolve(addonToCheck);\n        // $FLOW_IGNORE: override class method for testing reasons.\n        conn.addonRequest = sinon.spy(() => Promise.resolve({}));\n\n        return conn.reloadAddon('some-id')\n          .then(() => {\n            assert.equal(conn.getInstalledAddon.called, true);\n            assert.equal(conn.getInstalledAddon.firstCall.args[0], 'some-id');\n\n            assert.equal(conn.addonRequest.called, true);\n            const requestArgs = conn.addonRequest.firstCall.args;\n            assert.deepEqual(requestArgs[0], addon);\n            assert.equal(requestArgs[1], 'reload');\n          });\n      });\n\n      it('makes sure the addon can be reloaded', () => {\n        const addon = fakeAddon();\n        const conn = makeInstance();\n        // $FLOW_IGNORE: override class method for testing reasons.\n        conn.getInstalledAddon = () => Promise.resolve(addon);\n        // $FLOW_IGNORE: override class method for testing reasons.\n        conn.checkForAddonReloading =\n          sinon.spy((addonToCheck) => Promise.resolve(addonToCheck));\n\n        return conn.reloadAddon(addon.id)\n          .then(() => {\n            assert.equal(conn.checkForAddonReloading.called, true);\n            assert.deepEqual(conn.checkForAddonReloading.firstCall.args[0],\n                             addon);\n          });\n      });\n\n    });\n\n  });\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-firefox/test.remote.js","/* @flow */\nimport path from 'path';\n\nimport {it, describe} from 'mocha';\nimport {assert} from 'chai';\nimport sinon from 'sinon';\nimport {fs} from 'mz';\n\n\nimport {onlyInstancesOf, UsageError} from '../../../src/errors';\nimport {withTempDir} from '../../../src/util/temp-dir';\nimport {prepareArtifactsDir} from '../../../src/util/artifacts';\nimport {makeSureItFails, ErrorWithCode} from '../helpers';\n\n\ndescribe('prepareArtifactsDir', () => {\n\n  it('creates an artifacts dir if needed', () => withTempDir(\n    (tmpDir) => {\n      const artifactsDir = path.join(tmpDir.path(), 'build');\n      return prepareArtifactsDir(artifactsDir)\n        .then(() => {\n          // This should not throw an error if created properly.\n          return fs.stat(artifactsDir);\n        });\n    }\n  ));\n\n  it('ignores existing artifacts dir', () => withTempDir(\n    (tmpDir) =>\n      prepareArtifactsDir(tmpDir.path())\n        .then(() => {\n          // Make sure everything is still cool with this path.\n          return fs.stat(tmpDir.path());\n        })\n  ));\n\n  it('ensures the path is really a directory', () => withTempDir(\n    (tmpDir) => {\n      const someFile = path.join(tmpDir.path(), 'some-file.txt');\n      return fs.writeFile(someFile, 'some content')\n        .then(() => prepareArtifactsDir(someFile))\n        .then(makeSureItFails())\n        .catch(onlyInstancesOf(UsageError, (error) => {\n          assert.match(error.message, /not a directory/);\n        }));\n    }\n  ));\n\n  it('resolves with the artifacts dir', () => withTempDir(\n    (tmpDir) => {\n      const artifactsDir = path.join(tmpDir.path(), 'artifacts');\n      return prepareArtifactsDir(artifactsDir)\n        .then((resolvedDir) => {\n          assert.equal(resolvedDir, artifactsDir);\n        });\n    }\n  ));\n\n  it('throws an UsageError when it lacks permissions to stat the directory',\n    function() {\n      return withTempDir(\n        (tmpDir) => {\n          if (process.platform === 'win32') {\n            this.skip();\n            return;\n          }\n          const tmpPath = path.join(tmpDir.path(), 'build');\n          return fs.mkdir(tmpPath, '0622').then(() => {\n            const artifactsDir = path.join(tmpPath, 'artifacts');\n            return prepareArtifactsDir(artifactsDir)\n              .then(makeSureItFails())\n              .catch(onlyInstancesOf(UsageError, (error) => {\n                assert.match(error.message, /Cannot access.*lacks permissions/);\n              }));\n          });\n        }\n      );\n    }\n  );\n\n  it('throws error when directory exists but lacks writing permissions',\n    function() {\n      return withTempDir(\n        (tmpDir) => {\n          if (process.platform === 'win32') {\n            this.skip();\n            return;\n          }\n          const artifactsDir = path.join(tmpDir.path(), 'dir-nowrite');\n          return fs.mkdir(artifactsDir, '0555').then(() => {\n            return prepareArtifactsDir(artifactsDir)\n              .then(makeSureItFails())\n              .catch(onlyInstancesOf(UsageError, (error) => {\n                assert.match(error.message, /exists.*lacks permissions/);\n              }));\n          });\n        }\n      );\n    }\n  );\n\n  it('throws error when creating a folder if lacks writing permissions',\n    function() {\n      return withTempDir(\n        (tmpDir) => {\n          if (process.platform === 'win32') {\n            this.skip();\n            return;\n          }\n          const parentDir = path.join(tmpDir.path(), 'dir-nowrite');\n          const artifactsDir = path.join(parentDir, 'artifacts');\n          return fs.mkdir(parentDir, '0555').then(() => {\n            return prepareArtifactsDir(artifactsDir)\n              .then(makeSureItFails())\n              .catch(onlyInstancesOf(UsageError, (error) => {\n                assert.match(error.message, /Cannot create.*lacks permissions/);\n              }));\n          });\n        }\n      );\n    }\n  );\n\n  it('creates the artifacts dir successfully if the parent dir does not exist',\n    () => withTempDir(\n    (tmpDir) => {\n      const tmpPath = path.join(tmpDir.path(), 'build', 'subdir');\n      return prepareArtifactsDir(tmpPath)\n        .then((resolvedDir) => {\n          assert.equal(resolvedDir, tmpPath);\n        });\n    }\n  ));\n\n  it('throws error when creating a folder if there is not enough space',\n    () => withTempDir(\n    (tmpDir) => {\n      const fakeAsyncMkdirp = sinon.spy(() =>\n        Promise.reject(new ErrorWithCode('ENOSPC', 'an error')));\n      const tmpPath = path.join(tmpDir.path(), 'build', 'subdir');\n      return prepareArtifactsDir(tmpPath, {asyncMkdirp: fakeAsyncMkdirp})\n        .then(makeSureItFails(), (error) => {\n          assert.ok(fakeAsyncMkdirp.called);\n          assert.equal(error.message, 'an error');\n        });\n    }\n  ));\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-util/test.artifacts.js","/* @flow */\nimport {it, describe} from 'mocha';\nimport {assert} from 'chai';\nimport sinon from 'sinon';\n\nimport {showDesktopNotification} from '../../../src/util/desktop-notifier';\nimport {createLogger} from '../../../src/util/logger';\nimport {makeSureItFails} from '../helpers';\n\ndescribe('util/desktop-notifier', () => {\n  describe('desktopNotifications()', () => {\n    const expectedNotification = {\n      title: 'web-ext run: title',\n      message: 'message',\n    };\n\n    it('is called and creates a message with correct parameters', () => {\n      const fakeNotifier = {\n        notify: sinon.spy((options, callback) => callback()),\n      };\n      return showDesktopNotification(expectedNotification, {\n        notifier: fakeNotifier,\n      })\n        .then(() => {\n          assert.ok(fakeNotifier.notify.called);\n          assert.equal(\n            fakeNotifier.notify.firstCall.args[0].title,\n            'web-ext run: title',\n          );\n          assert.equal(fakeNotifier.notify.firstCall.args[0].message,\n                      'message');\n        });\n    });\n\n    it('logs error when notifier fails', () => {\n      const expectedError = new Error('an error');\n      const fakeLog = createLogger(__filename);\n      sinon.spy(fakeLog, 'debug');\n      const fakeNotifier = {\n        notify: (obj, callback) => {\n          callback(expectedError, 'response');\n        },\n      };\n\n      return showDesktopNotification(expectedNotification, {\n        notifier: fakeNotifier,\n        log: fakeLog,\n      })\n        .then(makeSureItFails())\n        .catch(() => {\n          assert.ok(fakeLog.debug.called);\n          assert.equal(fakeLog.debug.firstCall.args[0],\n                      `Desktop notifier error: ${expectedError.message}, ` +\n                      'response: response');\n        });\n    });\n\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-util/test.desktop-notifier.js","/* @flow */\nimport {describe, it} from 'mocha';\nimport {assert} from 'chai';\n\nimport {FileFilter, isSubPath} from '../../../src/util/file-filter';\n\ndescribe('util/file-filter', () => {\n\n  const newFileFilter = (params = {}) => {\n    return new FileFilter({\n      sourceDir: '.',\n      ...params,\n    });\n  };\n\n  describe('default', () => {\n    const defaultFilter = newFileFilter();\n\n    it('ignores long XPI paths', () => {\n      assert.equal(defaultFilter.wantFile('path/to/some.xpi'), false);\n    });\n\n    it('ignores short XPI paths', () => {\n      assert.equal(defaultFilter.wantFile('some.xpi'), false);\n    });\n\n    it('ignores .git directories', () => {\n      assert.equal(defaultFilter.wantFile('.git'), false);\n    });\n\n    it('ignores nested .git directories', () => {\n      assert.equal(defaultFilter.wantFile('path/to/.git'), false);\n    });\n\n    it('ignores any hidden file', () => {\n      assert.equal(defaultFilter.wantFile('.whatever'), false);\n    });\n\n    it('ignores subdirectories within hidden folders', () => {\n      assert.equal(defaultFilter.wantFile('.git/some/other/stuff'), false);\n    });\n\n    it('ignores ZPI paths', () => {\n      assert.equal(defaultFilter.wantFile('path/to/some.zip'), false);\n    });\n\n    it('allows other files', () => {\n      assert.equal(defaultFilter.wantFile('manifest.json'), true);\n    });\n\n    it('ignores node_modules by default', () => {\n      assert.equal(defaultFilter.wantFile('path/to/node_modules'), false);\n    });\n\n    it('ignores module content within node_modules by default', () => {\n      assert.equal(defaultFilter.wantFile('node_modules/something/file.js'),\n                   false);\n    });\n\n  });\n\n  describe('options', () => {\n\n    it('override the defaults with baseIgnoredPatterns', () => {\n      const filter = newFileFilter({\n        baseIgnoredPatterns: ['manifest.json'],\n      });\n      assert.equal(filter.wantFile('some.xpi'), true);\n      assert.equal(filter.wantFile('manifest.json'), false);\n    });\n\n    it('add more files to ignore with ignoreFiles', () => {\n      const filter = newFileFilter({\n        ignoreFiles: ['*.log'],\n      });\n      assert.equal(filter.wantFile('some.xpi'), false);\n      assert.equal(filter.wantFile('some.log'), false);\n    });\n\n    it('ignore artifactsDir and its content', () => {\n      const filter = newFileFilter({\n        artifactsDir: 'artifacts',\n      });\n      assert.equal(filter.wantFile('artifacts'), false);\n      assert.equal(filter.wantFile('artifacts/some.js'), false);\n    });\n\n    it('does not ignore an artifactsDir outside of sourceDir', () => {\n      const filter = newFileFilter({\n        artifactsDir: '.',\n        sourceDir: 'dist',\n      });\n      assert.equal(filter.wantFile('file'), true);\n      assert.equal(filter.wantFile('dist/file'), true);\n    });\n\n    it('resolve relative path', () => {\n      const filter = newFileFilter({\n        sourceDir: '/src',\n        artifactsDir: 'artifacts',\n        ignoreFiles: [\n          'ignore-dir/', 'some.js', '**/some.log', 'ignore/dir/content/**/*',\n        ],\n      });\n      assert.equal(filter.wantFile('/src/artifacts'), true);\n      assert.equal(filter.wantFile('/src/ignore-dir'), false);\n      assert.equal(filter.wantFile('/src/ignore-dir/some.css'), true);\n      assert.equal(filter.wantFile('/src/some.js'), false);\n      assert.equal(filter.wantFile('/src/some.log'), false);\n      assert.equal(filter.wantFile('/src/other/some.js'), true);\n      assert.equal(filter.wantFile('/src/other/some.log'), false);\n      assert.equal(filter.wantFile('/src/ignore/dir/content'), true);\n      assert.equal(filter.wantFile('/src/ignore/dir/content/file.js'), false);\n      // This file is not ignored because it's not relative to /src:\n      assert.equal(filter.wantFile('/some.js'), true);\n    });\n\n  });\n\n  describe('isSubPath', () => {\n    it('test if target is a sub directory of src', () => {\n      assert.equal(isSubPath('dist', '.'), false);\n      assert.equal(isSubPath('.', 'artifacts'), true);\n      assert.equal(isSubPath('.', '.'), false);\n      assert.equal(isSubPath('/src/dist', '/src'), false);\n      assert.equal(isSubPath('/src', '/src/artifacts'), true);\n      assert.equal(isSubPath('/src', '/src'), false);\n      assert.equal(isSubPath('/firstroot', '/secondroot'), false);\n      assert.equal(isSubPath('/src', '/src/.dir'), true);\n      assert.equal(isSubPath('/src', '/src/..dir'), true);\n    });\n  });\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-util/test.file-filter.js","/* @flow */\nimport path from 'path';\n\nimport {fs} from 'mz';\nimport {assert} from 'chai';\nimport {describe, it} from 'mocha';\n\nimport isDirectory from '../../../src/util/is-directory';\nimport {withTempDir} from '../../../src/util/temp-dir';\n\n\ndescribe('util.isDirectory', () => {\n\n  it('resolves true for a directory', () => withTempDir(\n    (tmpDir) => {\n      return isDirectory(tmpDir.path())\n        .then((dirExists) => {\n          assert.equal(dirExists, true);\n        });\n    }\n  ));\n\n  it('resolves false for non-existent paths', () => {\n    return isDirectory('/dev/null/not-a-real-path-at-all')\n      .then((dirExists) => {\n        assert.equal(dirExists, false);\n      });\n  });\n\n  it('resolves false for non-directory paths', () => withTempDir(\n    (tmpDir) => {\n      const filePath = path.join(tmpDir.path(), 'some.txt');\n      return fs.writeFile(filePath, 'some text')\n        .then(() => isDirectory(filePath))\n        .then((dirExists) => {\n          assert.equal(dirExists, false);\n        });\n    }\n  ));\n\n  it('resolves false for incomplete directory paths', () => withTempDir(\n    (tmpDir) => {\n      return isDirectory(path.join(tmpDir.path(), 'missing-leaf'))\n        .then((dirExists) => {\n          assert.equal(dirExists, false);\n        });\n    }\n  ));\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-util/test.is-directory.js","/* @flow */\nimport {WriteStream} from 'tty';\n\nimport bunyan from 'bunyan';\nimport sinon from 'sinon';\nimport {it, describe} from 'mocha';\nimport {assert} from 'chai';\n\nimport {createLogger, ConsoleStream} from '../../../src/util/logger';\n\n\ndescribe('logger', () => {\n\n  describe('createLogger', () => {\n\n    it('makes file names less redundant', () => {\n      const createBunyanLog = sinon.spy(() => {});\n      createLogger('src/some-file.js', {createBunyanLog});\n      assert.equal(createBunyanLog.firstCall.args[0].name, 'some-file.js');\n    });\n\n  });\n\n  describe('ConsoleStream', () => {\n\n    function packet(overrides) {\n      return {\n        name: 'some name',\n        msg: 'some messge',\n        level: bunyan.INFO,\n        ...overrides,\n      };\n    }\n\n    // NOTE: create a fake process that makes flow happy.\n    function fakeProcess() {\n      class FakeWritableStream extends WriteStream {\n        write(): boolean {\n          return true;\n        }\n      }\n\n      const fakeWritableStream = new FakeWritableStream();\n      sinon.spy(fakeWritableStream, 'write');\n\n      return {\n        stdout: fakeWritableStream,\n      };\n    }\n\n    it('lets you turn on verbose logging', () => {\n      const log = new ConsoleStream({verbose: false});\n      log.makeVerbose();\n      assert.equal(log.verbose, true);\n    });\n\n    it('logs names in verbose mode', () => {\n      const log = new ConsoleStream({verbose: true});\n      assert.equal(\n        log.format(packet({\n          name: 'foo',\n          msg: 'some message',\n          level: bunyan.DEBUG,\n        })),\n        '[foo][debug] some message\\n');\n    });\n\n    it('does not log names in non-verbose mode', () => {\n      const log = new ConsoleStream({verbose: false});\n      assert.equal(\n        log.format(packet({name: 'foo', msg: 'some message'})),\n        'some message\\n');\n    });\n\n    it('does not log debug packets unless verbose', () => {\n      const log = new ConsoleStream({verbose: false});\n      const localProcess = fakeProcess();\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.write(packet({level: bunyan.DEBUG}), {localProcess});\n      assert.equal(localProcess.stdout.write.called, false);\n    });\n\n    it('does not log trace packets unless verbose', () => {\n      const log = new ConsoleStream({verbose: false});\n      const localProcess = fakeProcess();\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.write(packet({level: bunyan.TRACE}), {localProcess});\n      assert.equal(localProcess.stdout.write.called, false);\n    });\n\n    it('logs debug packets when verbose', () => {\n      const log = new ConsoleStream({verbose: true});\n      const localProcess = fakeProcess();\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.write(packet({level: bunyan.DEBUG}), {localProcess});\n      assert.equal(localProcess.stdout.write.called, true);\n    });\n\n    it('logs trace packets when verbose', () => {\n      const log = new ConsoleStream({verbose: true});\n      const localProcess = fakeProcess();\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.write(packet({level: bunyan.TRACE}), {localProcess});\n      assert.equal(localProcess.stdout.write.called, true);\n    });\n\n    it('logs info packets when verbose or not', () => {\n      const log = new ConsoleStream({verbose: false});\n      const localProcess = fakeProcess();\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.write(packet({level: bunyan.INFO}), {localProcess});\n      log.makeVerbose();\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.write(packet({level: bunyan.INFO}), {localProcess});\n      assert.equal(localProcess.stdout.write.callCount, 2);\n    });\n\n    it('lets you capture logging', () => {\n      const log = new ConsoleStream();\n      const localProcess = fakeProcess();\n\n      log.startCapturing();\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.write(packet({msg: 'message'}), {localProcess});\n      assert.equal(localProcess.stdout.write.called, false);\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.flushCapturedLogs({localProcess});\n      assert.equal(localProcess.stdout.write.called, true);\n      assert.equal(localProcess.stdout.write.firstCall.args[0],\n                   'message\\n');\n    });\n\n    it('only flushes captured messages once', () => {\n      const log = new ConsoleStream();\n      let localProcess = fakeProcess();\n\n      log.startCapturing();\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.write(packet(), {localProcess});\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.flushCapturedLogs({localProcess});\n\n      // Make sure there is nothing more to flush.\n      localProcess = fakeProcess();\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.flushCapturedLogs({localProcess});\n      assert.equal(localProcess.stdout.write.callCount, 0);\n    });\n\n    it('lets you start and stop capturing', () => {\n      const log = new ConsoleStream();\n      let localProcess = fakeProcess();\n\n      log.startCapturing();\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.write(packet(), {localProcess});\n      assert.equal(localProcess.stdout.write.callCount, 0);\n\n      log.stopCapturing();\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.write(packet(), {localProcess});\n      assert.equal(localProcess.stdout.write.callCount, 1);\n\n      // Make sure that when we start capturing again,\n      // the queue gets reset.\n      log.startCapturing();\n      log.write(packet());\n      localProcess = fakeProcess();\n      // $FLOW_IGNORE: fake process for testing reasons.\n      log.flushCapturedLogs({localProcess});\n      assert.equal(localProcess.stdout.write.callCount, 1);\n    });\n\n  });\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-util/test.logger.js","module.exports = require(\"tty\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"tty\"\n// module id = 178\n// module chunks = 0","/* @flow */\nimport {describe, it} from 'mocha';\nimport {fs} from 'mz';\nimport {assert} from 'chai';\n\nimport {withTempDir, TempDir} from '../../../src/util/temp-dir';\nimport {makeSureItFails} from '../helpers';\n\n\ndescribe('util.withTempDir', () => {\n\n  it('creates a temp directory', () => withTempDir(\n    (tmpDir) => {\n      // Make sure the directory exists.\n      return fs.stat(tmpDir.path());\n    }\n  ));\n\n  it('destroys the directory on completion', () => {\n    return withTempDir(\n      (tmpDir) => Promise.resolve(tmpDir.path()))\n      .then((tmpPath) => fs.stat(tmpPath))\n      .then(makeSureItFails())\n      .catch((error) => {\n        assert.match(error.message, /ENOENT.* stat/);\n      });\n  });\n\n  it('destroys the directory on error', () => {\n    var tmpPath;\n    var tmpPathExisted = false;\n    return withTempDir(\n      (tmpDir) => {\n        tmpPath = tmpDir.path();\n        return fs.stat(tmpPath)\n          .then(() => {\n            tmpPathExisted = true;\n            throw new Error('simulated error');\n          });\n      })\n      .then(makeSureItFails())\n      .catch(() => {\n        assert.equal(tmpPathExisted, true);\n        return fs.stat(tmpPath);\n      })\n      .catch((error) => {\n        assert.match(error.message, /ENOENT.* stat/);\n      });\n  });\n\n});\n\n\ndescribe('util.TempDir', () => {\n\n  it('requires you to create the directory before accessing path()', () => {\n    const tmp = new TempDir();\n    assert.throws(() => tmp.path(), /cannot access path.* before.* create/);\n  });\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-util/test.temp-dir.js","/* @flow */\nimport {it, describe} from 'mocha';\nimport {assert} from 'chai';\nimport sinon from 'sinon';\n\nimport {checkForUpdates} from '../../../src/util/updates';\n\ndescribe('util/updates', () => {\n  describe('checkForUpdates()', () => {\n    it('calls the notifier with the correct parameters', () => {\n      const updateNotifierStub = sinon.spy(() => {\n        return {\n          notify: sinon.spy(),\n        };\n      });\n\n      checkForUpdates({\n        version: '1.0.0',\n        updateNotifier: updateNotifierStub,\n      });\n      assert.equal(updateNotifierStub.called, true);\n      assert.equal(updateNotifierStub.firstCall.args[0].pkg.name, 'web-ext');\n      assert.equal(updateNotifierStub.firstCall.args[0].pkg.version, '1.0.0');\n      assert.isNumber(updateNotifierStub.firstCall.args[0].updateCheckInterval);\n      assert.equal(updateNotifierStub.firstCall.args[0].updateCheckInterval,\n                   1000 * 60 * 60 * 24 * 3);\n    });\n  });\n});\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test-util/test.updates.js","/* @flow */\nimport defaultUpdateNotifier from 'update-notifier';\n\ntype checkForUpdatesParams = {|\n  version: string,\n  updateNotifier?: typeof defaultUpdateNotifier,\n|};\n\nexport function checkForUpdates(\n  {\n    version,\n    updateNotifier = defaultUpdateNotifier,\n  }: checkForUpdatesParams\n) {\n  const pkg = {name: 'web-ext', version};\n\n  updateNotifier({\n    pkg,\n    updateCheckInterval: 1000 * 60 * 60 * 24 * 3, // 3 days,\n  }).notify();\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/updates.js","module.exports = require(\"update-notifier\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"update-notifier\"\n// module id = 182\n// module chunks = 0","/* @flow */\nimport path from 'path';\n\nimport {assert} from 'chai';\nimport {describe, it} from 'mocha';\nimport sinon from 'sinon';\nimport {fs} from 'mz';\n\nimport {Program} from '../../src/program';\nimport {\n  applyConfigToArgv,\n  loadJSConfigFile,\n} from '../../src/config';\nimport {withTempDir} from '../../src/util/temp-dir';\nimport {UsageError} from '../../src/errors';\n\ntype MakeArgvParams = {|\n  userCmd?: Array<string>,\n  command?: string,\n  commandDesc?: string,\n  commandExecutor?: Function,\n  commandOpt?: Object,\n  globalOpt?: Object,\n|}\n\nfunction makeArgv({\n  userCmd = ['fakecommand'],\n  command = 'fakecommand',\n  commandDesc = 'this is a fake command',\n  commandExecutor = sinon.stub(),\n  commandOpt,\n  globalOpt,\n}: MakeArgvParams) {\n  const program = new Program(userCmd);\n\n  if (globalOpt) {\n    program.setGlobalOptions(globalOpt);\n  }\n  if (commandOpt) {\n    program.command(command, commandDesc, commandExecutor, commandOpt);\n  }\n  return {\n    argv: program.yargs.exitProcess(false).argv,\n    defaultValues: program.defaultValues,\n    commandExecuted: command,\n  };\n}\n\nconst applyConf = (params) => applyConfigToArgv({\n  configFileName: 'some/path/to/config.js',\n  ...params,\n});\n\ndescribe('config', () => {\n  describe('applyConfigToArgv', () => {\n\n    it('preserves a string value on the command line over configured', () => {\n      const cmdLineSrcDir = '/user/specified/source/dir/';\n\n      const {argv, defaultValues} = makeArgv({\n        userCmd: ['fakecommand', '--source-dir', cmdLineSrcDir],\n        globalOpt: {\n          'source-dir': {\n            requiresArg: true,\n            type: 'string',\n            demand: false,\n          },\n        },\n      });\n      const configObject = {\n        sourceDir: '/configured/source/dir',\n      };\n      const newArgv = applyConf({argv, configObject, defaultValues});\n      assert.strictEqual(newArgv.sourceDir, cmdLineSrcDir);\n    });\n\n    it('preserves configured value over default', () => {\n      const {argv, defaultValues} = makeArgv({\n        globalOpt: {\n          'source-dir': {\n            requiresArg: true,\n            type: 'string',\n            demand: false,\n            default: 'default/value/option/definition',\n          },\n        },\n      });\n      const configObject = {\n        sourceDir: '/configured/source/dir',\n      };\n      const newArgv = applyConf({argv, configObject, defaultValues});\n      assert.strictEqual(newArgv.sourceDir, configObject.sourceDir);\n    });\n\n    it('preserves a string value on the command line over all others', () => {\n      const cmdLineSrcDir = '/user/specified/source/dir/';\n      const {argv, defaultValues} = makeArgv({\n        userCmd: ['fakecommand', '--sourceDir', cmdLineSrcDir],\n        globalOpt: {\n          'source-dir': {\n            requiresArg: true,\n            type: 'string',\n            demand: false,\n            default: 'default/value/option/definition',\n          },\n        },\n      });\n      const configObject = {\n        sourceDir: '/configured/source/dir',\n      };\n      const newArgv = applyConf({argv, configObject, defaultValues});\n      assert.strictEqual(newArgv.sourceDir, cmdLineSrcDir);\n    });\n\n    it('preserves default value of option if not in config', () => {\n      const {argv, defaultValues} = makeArgv({\n        globalOpt: {\n          'source-dir': {\n            requiresArg: true,\n            type: 'string',\n            demand: false,\n            default: 'default/value/option/definition',\n          },\n          'artifacts-dir': {\n            type: 'string',\n            demand: false,\n          },\n        },\n      });\n      const configObject = {\n        artifactsDir: '/configured/artifacts/dir',\n      };\n      const newArgv = applyConf({argv, configObject, defaultValues});\n      assert.strictEqual(newArgv.sourceDir, 'default/value/option/definition');\n    });\n\n    it('preserves value on the command line if not in config', () => {\n      const cmdLineSrcDir = '/user/specified/source/dir/';\n      const {argv, defaultValues} = makeArgv({\n        userCmd: ['fakecommand', '--sourceDir', cmdLineSrcDir],\n        globalOpt: {\n          'source-dir': {\n            requiresArg: true,\n            type: 'string',\n            demand: false,\n            default: 'default/value/option/definition',\n          },\n          'artifacts-dir': {\n            type: 'string',\n            demand: false,\n          },\n        },\n      });\n      const configObject = {\n        artifactsDir: '/configured/artifacts/dir',\n      };\n      const newArgv = applyConf({argv, configObject, defaultValues});\n      assert.strictEqual(newArgv.sourceDir, cmdLineSrcDir);\n    });\n\n    it('uses a configured boolean value over an implicit default', () => {\n      const {argv, defaultValues} = makeArgv({\n        globalOpt: {\n          'overwrite-files': {\n            type: 'boolean',\n            // No default is set here explicitly but yargs will set it to\n            // false implicitly.\n          },\n        },\n      });\n      const configObject = {\n        overwriteFiles: true,\n      };\n      const newArgv = applyConf({argv, configObject, defaultValues});\n      assert.strictEqual(newArgv.overwriteFiles, true);\n    });\n\n    it('uses a configured boolean value over an explicit default', () => {\n      const {argv, defaultValues} = makeArgv({\n        globalOpt: {\n          'overwrite-files': {\n            type: 'boolean',\n            default: false,\n          },\n        },\n      });\n      const configObject = {\n        overwriteFiles: true,\n      };\n      const newArgv = applyConf({argv, configObject, defaultValues});\n      assert.strictEqual(newArgv.overwriteFiles, true);\n    });\n\n    it('uses a CLI boolean value over a configured one', () => {\n      const {argv, defaultValues} = makeArgv({\n        userCmd: ['fakecommand', '--overwrite-files'],\n        globalOpt: {\n          'overwrite-files': {\n            type: 'boolean',\n          },\n        },\n      });\n      const configObject = {\n        overwriteFiles: false,\n      };\n      const newArgv = applyConf({argv, configObject, defaultValues});\n      assert.strictEqual(newArgv.overwriteFiles, true);\n    });\n\n    it('uses CLI option over undefined configured option and default', () => {\n      const cmdLineSrcDir = '/user/specified/source/dir/';\n      const {argv, defaultValues} = makeArgv({\n        userCmd: ['fakecommand', '--source-dir', cmdLineSrcDir],\n        globalOpt: {\n          'source-dir': {\n            type: 'string',\n          },\n          'verbose': {\n            type: 'boolean',\n          },\n        },\n      });\n      const configObject = {\n        verbose: true,\n      };\n      const newArgv = applyConf({argv, configObject, defaultValues});\n      assert.strictEqual(newArgv.sourceDir, cmdLineSrcDir);\n    });\n\n    it('uses a configured number value over a falsey default', () => {\n      const {argv, defaultValues} = makeArgv({\n        userCmd: ['fakecommand'],\n        globalOpt: {\n          'number-of-retries': {\n            type: 'number',\n            default: 0,\n          },\n        },\n      });\n      const configObject = {\n        numberOfRetries: 1,\n      };\n      const newArgv = applyConf({argv, configObject, defaultValues});\n      assert.strictEqual(newArgv.numberOfRetries, 1);\n    });\n\n    it('uses a falsey CLI number value over a configured one', () => {\n      const {argv, defaultValues} = makeArgv({\n        userCmd: ['fakecommand', '--number-of-retries=0'],\n        globalOpt: {\n          'number-of-retries': {\n            type: 'number',\n            default: 1,\n          },\n        },\n      });\n      const configObject = {\n        numberOfRetries: 1,\n      };\n      const newArgv = applyConf({argv, configObject, defaultValues});\n      assert.strictEqual(newArgv.numberOfRetries, 0);\n    });\n\n    it('uses configured value even when option defaults to undefined', () => {\n      const {argv, defaultValues} = makeArgv({\n        globalOpt: {\n          'source-dir': {\n            type: 'string',\n            default: undefined,\n          },\n        },\n      });\n      const configObject = {\n        sourceDir: '/configured/directory',\n      };\n      const newArgv = applyConf({argv, configObject, defaultValues});\n      assert.strictEqual(newArgv.sourceDir, '/configured/directory');\n    });\n\n    it('throws an error when an option is not camel cased', () => {\n      const {argv, defaultValues} = makeArgv({\n        globalOpt: {\n          'source-dir': {\n            type: 'string',\n            demand: false,\n          },\n        },\n      });\n      const configObject = {\n        'source-dir': 'fake/value/',\n      };\n      assert.throws(() => {\n        applyConf({argv, configObject, defaultValues});\n      }, UsageError, 'UsageError: The config option \"source-dir\" must be ' +\n        'specified in camel case: \"sourceDir\"');\n    });\n\n    it('throws an error when an option is invalid', () => {\n      const {argv, defaultValues} = makeArgv({\n        globalOpt: {\n          'source-dir': {\n            type: 'string',\n            demand: false,\n          },\n        },\n      });\n      const configFileName = 'fake/path/to/config';\n      const configObject = {\n        artifactsDir: 'fake/artifacts/dir',\n      };\n      assert.throws(() => {\n        applyConf({argv, configObject, defaultValues, configFileName});\n      }, UsageError, 'UsageError: The config file at fake/path/to/config ' +\n        'specified an unknown option: \"artifactsDir\"');\n    });\n  });\n\n  describe('sub commands', () => {\n    it('preserves configured value over default', () => {\n      const {argv, defaultValues, commandExecuted} = makeArgv({\n        userCmd: ['sign'],\n        command: 'sign',\n        commandOpt: {\n          'api-key': {\n            requiresArg: true,\n            type: 'string',\n            demand: false,\n            default: 'pretend-default-value',\n          },\n        },\n      });\n      const configObject = {\n        sign: {\n          apiKey: 'custom-configured-key',\n        },\n      };\n      const newArgv = applyConf({\n        argv,\n        configObject,\n        defaultValues,\n        commandExecuted,\n      });\n      assert.strictEqual(newArgv.apiKey, configObject.sign.apiKey);\n    });\n\n    it('preserves CLI value over default and configured', () => {\n      const cmdApiKey = 'api-key-cmd';\n      const {argv, defaultValues, commandExecuted} = makeArgv({\n        userCmd: ['sign', '--api-key', cmdApiKey],\n        command: 'sign',\n        commandOpt: {\n          'api-key': {\n            requiresArg: true,\n            type: 'string',\n            demand: false,\n            default: 'pretend-default-value',\n          },\n        },\n      });\n      const configObject = {\n        sign: {\n          apiKey: 'custom-configured-key',\n        },\n      };\n      const newArgv = applyConf({\n        argv,\n        configObject,\n        defaultValues,\n        commandExecuted,\n      });\n      assert.strictEqual(newArgv.apiKey, cmdApiKey);\n    });\n\n    it('preserves CLI value over configured', () => {\n      const cmdApiKey = 'api-key-cmd';\n      const {argv, defaultValues, commandExecuted} = makeArgv({\n        userCmd: ['sign', '--api-key', cmdApiKey],\n        command: 'sign',\n        commandOpt: {\n          'api-key': {\n            requiresArg: true,\n            type: 'string',\n            demand: false,\n          },\n        },\n      });\n      const configObject = {\n        sign: {\n          apiKey: 'custom-configured-key',\n        },\n      };\n      const newArgv = applyConf({\n        argv,\n        configObject,\n        defaultValues,\n        commandExecuted,\n      });\n      assert.strictEqual(newArgv.apiKey, cmdApiKey);\n    });\n\n    it('preserves default value if not in config', () => {\n      const {argv, defaultValues, commandExecuted} = makeArgv({\n        userCmd: ['sign'],\n        command: 'sign',\n        commandOpt: {\n          'api-key': {\n            requiresArg: true,\n            type: 'string',\n            demand: false,\n            default: 'pretend-default-value-of-apiKey',\n          },\n          'api-url': {\n            requiresArg: true,\n            type: 'string',\n            demand: false,\n            default: 'pretend-default-value-of-apiUrl',\n          },\n        },\n      });\n      const configObject = {\n        sign: {\n          apiKey: 'custom-configured-key',\n        },\n      };\n      const newArgv = applyConf({\n        argv,\n        configObject,\n        defaultValues,\n        commandExecuted,\n      });\n      assert.strictEqual(newArgv.apiUrl, 'pretend-default-value-of-apiUrl');\n    });\n\n    it('preserves CLI value if not in config', () => {\n      const cmdApiKey = 'api-key-cmd';\n      const {argv, defaultValues, commandExecuted} = makeArgv({\n        userCmd: ['sign', '--api-key', cmdApiKey],\n        command: 'sign',\n        commandOpt: {\n          'api-key': {\n            requiresArg: true,\n            type: 'string',\n            demand: false,\n            default: 'pretend-default-value-of-apiKey',\n          },\n          'api-url': {\n            requiresArg: true,\n            type: 'string',\n            demand: false,\n            default: 'pretend-default-value-of-apiUrl',\n          },\n        },\n      });\n      const configObject = {\n        sign: {\n          apiUrl: 'custom-configured-url',\n        },\n      };\n      const newArgv = applyConf({\n        argv,\n        configObject,\n        defaultValues,\n        commandExecuted,\n      });\n      assert.strictEqual(newArgv.apiKey, cmdApiKey);\n    });\n  });\n\n  describe('loadJSConfigFile', () => {\n    it('throws an error if the config file does not exist', () => {\n      return withTempDir (\n        (tmpDir) => {\n          assert.throws(() => {\n            loadJSConfigFile((path.join(tmpDir.path(),\n              'non-existant-config.js')));\n          }, UsageError, /Cannot read config file/);\n        });\n    });\n\n    it('throws an error if the config file has syntax errors', () => {\n      return withTempDir (\n        (tmpDir) => {\n          const configFilePath = path.join(tmpDir.path(), 'config.js');\n          fs.writeFileSync(configFilePath,\n            // missing = in two places\n            `module.exports {\n                sourceDir 'path/to/fake/source/dir',\n              };`);\n          assert.throws(() => {\n            loadJSConfigFile(configFilePath);\n          }, UsageError);\n        });\n    });\n\n    it('parses the configuration file correctly', () => {\n      return withTempDir(\n        (tmpDir) => {\n          const configFilePath = path.join(tmpDir.path(), 'config.js');\n          fs.writeFileSync(configFilePath,\n            `module.exports = {\n              sourceDir: 'path/to/fake/source/dir',\n            };`);\n          const configObj = loadJSConfigFile(configFilePath);\n          assert.equal(configObj.sourceDir, 'path/to/fake/source/dir');\n        });\n    });\n\n    it('does not throw an error for an empty config', () => {\n      return withTempDir(\n        (tmpDir) => {\n          const configFilePath = path.join(tmpDir.path(), 'config.js');\n          fs.writeFileSync(configFilePath, '{};');\n          loadJSConfigFile(configFilePath);\n        });\n    });\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test.config.js","/* @flow */\nimport path from 'path';\nimport {readFileSync} from 'fs';\n\nimport git from 'git-rev-sync';\nimport yargs from 'yargs';\nimport camelCase from 'camelcase';\n\nimport defaultCommands from './cmd';\nimport {UsageError} from './errors';\nimport {createLogger, consoleStream as defaultLogStream} from './util/logger';\nimport {coerceCLICustomPreference} from './firefox/preferences';\nimport {checkForUpdates as defaultUpdateChecker} from './util/updates';\n\nconst log = createLogger(__filename);\nconst envPrefix = 'WEB_EXT';\n\n\ntype ProgramOptions = {|\n  absolutePackageDir?: string,\n|}\n\n// TODO: add pipes to Flow type after https://github.com/facebook/flow/issues/2405 is fixed\n\ntype ExecuteOptions = {\n  checkForUpdates?: Function,\n  systemProcess?: typeof process,\n  logStream?: typeof defaultLogStream,\n  getVersion?: Function,\n  shouldExitProgram?: boolean,\n  globalEnv?: string,\n}\n\n\n/*\n * The command line program.\n */\nexport class Program {\n  yargs: any;\n  commands: { [key: string]: Function };\n  shouldExitProgram: boolean;\n  defaultValues: Object;\n\n  constructor(\n    argv: ?Array<string>,\n    {\n      absolutePackageDir = process.cwd(),\n    }: ProgramOptions = {}\n  ) {\n    // This allows us to override the process argv which is useful for\n    // testing.\n    // NOTE: process.argv.slice(2) removes the path to node and web-ext\n    // executables from the process.argv array.\n    argv = argv || process.argv.slice(2);\n\n    // NOTE: always initialize yargs explicitly with the package dir\n    // so that we are sure that it is going to load the 'boolean-negation: false'\n    // config (See web-ext#469 for rationale).\n    const yargsInstance = yargs(argv, absolutePackageDir);\n\n    this.shouldExitProgram = true;\n    this.yargs = yargsInstance;\n    this.yargs.strict();\n\n    this.commands = {};\n    this.defaultValues = {};\n  }\n\n  command(\n    name: string, description: string, executor: Function,\n    commandOptions: Object = {}\n  ): Program {\n    this.defaultValues[name] = setDefaultValues(commandOptions);\n    this.yargs.command(name, description, (yargsForCmd) => {\n      if (!commandOptions) {\n        return;\n      }\n      return yargsForCmd\n        // Make sure the user does not add any extra commands. For example,\n        // this would be a mistake because lint does not accept arguments:\n        // web-ext lint ./src/path/to/file.js\n        .demandCommand(0, 0, undefined,\n                       'This command does not take any arguments')\n        .strict()\n        .exitProcess(this.shouldExitProgram)\n        // Calling env() will be unnecessary after\n        // https://github.com/yargs/yargs/issues/486 is fixed\n        .env(envPrefix)\n        .options(commandOptions);\n    });\n    this.commands[name] = executor;\n    return this;\n  }\n\n  setGlobalOptions(options: Object): Program {\n    // This is a convenience for setting global options.\n    // An option is only global (i.e. available to all sub commands)\n    // with the `global` flag so this makes sure every option has it.\n    this.defaultValues = {...this.defaultValues, ...setDefaultValues(options)};\n    Object.keys(options).forEach((key) => {\n      options[key].global = true;\n      if (options[key].demand === undefined) {\n        // By default, all options should be \"demanded\" otherwise\n        // yargs.strict() will think they are missing when declared.\n        options[key].demand = true;\n      }\n    });\n    this.yargs.options(options);\n    return this;\n  }\n\n  async execute(\n    absolutePackageDir: string,\n    {\n      checkForUpdates = defaultUpdateChecker, systemProcess = process,\n      logStream = defaultLogStream, getVersion = defaultVersionGetter,\n      shouldExitProgram = true, globalEnv = WEBEXT_BUILD_ENV,\n    }: ExecuteOptions = {}\n  ): Promise<void> {\n\n    this.shouldExitProgram = shouldExitProgram;\n    this.yargs.exitProcess(this.shouldExitProgram);\n\n    const argv = this.yargs.argv;\n    const cmd = argv._[0];\n\n    // Command line option (pref) renamed for internal use (customPref).\n    argv.customPrefs = argv.pref;\n\n    const runCommand = this.commands[cmd];\n\n    if (argv.verbose) {\n      logStream.makeVerbose();\n      log.info('Version:', getVersion(absolutePackageDir));\n    }\n\n    try {\n      if (cmd === undefined) {\n        throw new UsageError('No sub-command was specified in the args');\n      }\n      if (!runCommand) {\n        throw new UsageError(`Unknown command: ${cmd}`);\n      }\n      if (globalEnv === 'production') {\n        checkForUpdates ({\n          version: getVersion(absolutePackageDir),\n        });\n      }\n\n      await runCommand(argv);\n\n    } catch (error) {\n      const prefix = cmd ? `${cmd}: ` : '';\n      if (!(error instanceof UsageError) || argv.verbose) {\n        log.error(`\\n${prefix}${error.stack}\\n`);\n      } else {\n        log.error(`\\n${prefix}${error}\\n`);\n      }\n      if (error.code) {\n        log.error(`${prefix}Error code: ${error.code}\\n`);\n      }\n\n      if (this.shouldExitProgram) {\n        systemProcess.exit(1);\n      } else {\n        throw error;\n      }\n    }\n  }\n}\n\n// A global variable generated by DefinePlugin, generated in webpack.config.js\ndeclare var WEBEXT_BUILD_ENV: string;\n\nfunction setDefaultValues(options: Object): Object {\n  const defaultValues = {};\n  Object.keys(options).forEach((key) => {\n    const camelCasedKey = camelCase(key);\n    if (options[key].type === 'boolean') {\n      defaultValues[camelCasedKey] = false;\n    }\n    if (typeof(options[key].default) !== 'undefined') {\n      defaultValues[camelCasedKey] = options[key].default;\n    }\n  });\n  return defaultValues;\n}\n\n//A defintion of type of argument for defaultVersionGetter\ntype versionGetterOptions = {\n  globalEnv?: string,\n};\n\nexport function defaultVersionGetter(\n  absolutePackageDir: string,\n  {globalEnv = WEBEXT_BUILD_ENV}: versionGetterOptions = {}\n): string {\n  if (globalEnv === 'production') {\n    log.debug('Getting the version from package.json');\n    const packageData: any = readFileSync(\n      path.join(absolutePackageDir, 'package.json'));\n    return JSON.parse(packageData).version;\n  } else {\n    log.debug('Getting version from the git revision');\n    return `${git.branch(absolutePackageDir)}-${git.long(absolutePackageDir)}`;\n  }\n}\n\n// TODO: add pipes to Flow type after https://github.com/facebook/flow/issues/2405 is fixed\n\ntype MainParams = {\n  getVersion?: Function,\n  commands?: Object,\n  argv: Array<any>,\n  runOptions?: Object,\n}\n\nexport function main(\n  absolutePackageDir: string,\n  {\n    getVersion = defaultVersionGetter, commands = defaultCommands, argv,\n    runOptions = {},\n  }: MainParams = {}\n): Promise<any> {\n\n  const program = new Program(argv, {absolutePackageDir});\n\n  // yargs uses magic camel case expansion to expose options on the\n  // final argv object. For example, the 'artifacts-dir' option is alternatively\n  // available as argv.artifactsDir.\n  program.yargs\n    .usage(`Usage: $0 [options] command\n\nOption values can also be set by declaring an environment variable prefixed\nwith $${envPrefix}_. For example: $${envPrefix}_SOURCE_DIR=/path is the same as\n--source-dir=/path.\n\nTo view specific help for any given command, add the command name.\nExample: $0 --help run.\n`)\n    .help('help')\n    .alias('h', 'help')\n    .env(envPrefix)\n    .version(() => getVersion(absolutePackageDir))\n    .demandCommand(1, 'You must specify a command')\n    .strict();\n\n  program.setGlobalOptions({\n    'source-dir': {\n      alias: 's',\n      describe: 'Web extension source directory.',\n      default: process.cwd(),\n      requiresArg: true,\n      type: 'string',\n      coerce: path.resolve,\n    },\n    'artifacts-dir': {\n      alias: 'a',\n      describe: 'Directory where artifacts will be saved.',\n      default: path.join(process.cwd(), 'web-ext-artifacts'),\n      normalize: true,\n      requiresArg: true,\n      type: 'string',\n    },\n    'verbose': {\n      alias: 'v',\n      describe: 'Show verbose output',\n      type: 'boolean',\n    },\n    'ignore-files': {\n      alias: 'i',\n      describe: 'A list of glob patterns to define which files should be ' +\n                'ignored. (Example: --ignore-files=path/to/first.js ' +\n                'path/to/second.js \"**/*.log\")',\n      demand: false,\n      requiresArg: true,\n      type: 'array',\n    },\n  });\n\n  program\n    .command(\n      'build',\n      'Create a web extension package from source',\n      commands.build, {\n        'as-needed': {\n          describe: 'Watch for file changes and re-build as needed',\n          type: 'boolean',\n        },\n      })\n    .command(\n      'sign',\n      'Sign the web extension so it can be installed in Firefox',\n      commands.sign, {\n        'api-key': {\n          describe: 'API key (JWT issuer) from addons.mozilla.org',\n          demand: true,\n          type: 'string',\n        },\n        'api-secret': {\n          describe: 'API secret (JWT secret) from addons.mozilla.org',\n          demand: true,\n          type: 'string',\n        },\n        'api-url-prefix': {\n          describe: 'Signing API URL prefix',\n          default: 'https://addons.mozilla.org/api/v3',\n          demand: true,\n          type: 'string',\n        },\n        'api-proxy': {\n          describe:\n            'Use a proxy to access the signing API. ' +\n            'Example: https://yourproxy:6000 ',\n          demand: false,\n          type: 'string',\n        },\n        'id': {\n          describe:\n            'A custom ID for the extension. This has no effect if the ' +\n            'extension already declares an explicit ID in its manifest.',\n          demand: false,\n          type: 'string',\n        },\n        'timeout': {\n          describe: 'Number of milliseconds to wait before giving up',\n          type: 'number',\n        },\n      })\n    .command('run', 'Run the web extension', commands.run, {\n      'firefox': {\n        alias: ['f', 'firefox-binary'],\n        describe: 'Path or alias to a Firefox executable such as firefox-bin ' +\n                  'or firefox.exe. ' +\n                  'If not specified, the default Firefox will be used. ' +\n                  'You can specify the following aliases in lieu of a path: ' +\n                  'firefox, beta, nightly, firefoxdeveloperedition.',\n        demand: false,\n        type: 'string',\n      },\n      'firefox-profile': {\n        alias: ['p', 'profile'],\n        describe: 'Run Firefox using a copy of this profile. The profile ' +\n                  'can be specified as a directory or a name, such as one ' +\n                  'you would see in the Profile Manager. If not specified, ' +\n                  'a new temporary profile will be created.',\n        demand: false,\n        type: 'string',\n      },\n      'keep-profile-changes': {\n        describe: 'Run Firefox directly in custom profile. Any changes to ' +\n                  'the profile will be saved.',\n        demand: false,\n        type: 'boolean',\n      },\n      'marionette': {\n        describe: 'Enable marionette after installation',\n        demand: false,\n        type: 'boolean',\n      },\n      'no-reload': {\n        describe: 'Do not reload the extension when source files change',\n        demand: false,\n        type: 'boolean',\n      },\n      'pre-install': {\n        describe: 'Pre-install the extension into the profile before ' +\n                  'startup. This is only needed to support older versions ' +\n                  'of Firefox.',\n        demand: false,\n        type: 'boolean',\n      },\n      'pref': {\n        describe: 'Launch firefox with a custom preference ' +\n                  '(example: --pref=general.useragent.locale=fr-FR). ' +\n                  'You can repeat this option to set more than one ' +\n                  'preference.',\n        demand: false,\n        requiresArg: true,\n        type: 'string',\n        coerce: coerceCLICustomPreference,\n      },\n      'start-url': {\n        alias: ['u', 'url'],\n        describe: 'Launch firefox at specified page',\n        demand: false,\n        requiresArg: true,\n        type: 'string',\n      },\n      'browser-console': {\n        alias: ['bc'],\n        describe: 'Open the DevTools Browser Console.',\n        demand: false,\n        type: 'boolean',\n      },\n    })\n    .command('lint', 'Validate the web extension source', commands.lint, {\n      'output': {\n        alias: 'o',\n        describe: 'The type of output to generate',\n        type: 'string',\n        default: 'text',\n        choices: ['json', 'text'],\n      },\n      'metadata': {\n        describe: 'Output only metadata as JSON',\n        type: 'boolean',\n        default: false,\n      },\n      'warnings-as-errors': {\n        describe: 'Treat warnings as errors by exiting non-zero for warnings',\n        alias: 'w',\n        type: 'boolean',\n        default: false,\n      },\n      'pretty': {\n        describe: 'Prettify JSON output',\n        type: 'boolean',\n        default: false,\n      },\n      'self-hosted': {\n        describe:\n          'Your extension will be self-hosted. This disables messages ' +\n          'related to hosting on addons.mozilla.org.',\n        type: 'boolean',\n        default: false,\n      },\n      'boring': {\n        describe: 'Disables colorful shell output',\n        type: 'boolean',\n        default: false,\n      },\n    })\n    .command('docs', 'Open the web-ext documentation in a browser',\n      commands.docs, {});\n\n  return program.execute(absolutePackageDir, runOptions);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/program.js","module.exports = require(\"git-rev-sync\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"git-rev-sync\"\n// module id = 185\n// module chunks = 0","module.exports = require(\"yargs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"yargs\"\n// module id = 186\n// module chunks = 0","module.exports = require(\"camelcase\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"camelcase\"\n// module id = 187\n// module chunks = 0","/* @flow */\nimport build from './build';\nimport lint from './lint';\nimport run from './run';\nimport sign from './sign';\nimport docs from './docs';\n\nexport default {build, lint, run, sign, docs};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/cmd/index.js","/* @flow */\nimport path from 'path';\n\nimport requireUncached from 'require-uncached';\nimport camelCase from 'camelcase';\nimport decamelize from 'decamelize';\n\nimport {createLogger} from './util/logger';\nimport {UsageError} from './errors';\n\nconst log = createLogger(__filename);\n\ntype ApplyConfigToArgvParams = {|\n  argv: Object,\n  configObject: Object,\n  defaultValues: Object,\n  configFileName: string,\n  commandExecuted?: string,\n|};\n\nexport function applyConfigToArgv({\n  argv,\n  configObject,\n  defaultValues,\n  configFileName,\n  commandExecuted,\n}: ApplyConfigToArgvParams): Object {\n  let newArgv = {...argv};\n  for (const option in configObject) {\n\n    if (camelCase(option) !== option) {\n      throw new UsageError(`The config option \"${option}\" must be ` +\n        `specified in camel case: \"${camelCase(option)}\"`);\n    }\n\n    if (option === commandExecuted) {\n      newArgv = applyConfigToArgv({\n        argv,\n        configObject: configObject[commandExecuted],\n        defaultValues: defaultValues[commandExecuted],\n        configFileName});\n      continue;\n    }\n\n    // we assume the value was set on the CLI if the default value is\n    // not the same as that on the argv object as there is a very rare chance\n    // of this happening\n    const wasValueSetOnCLI = typeof(argv[option]) !== 'undefined' &&\n      (argv[option] !== defaultValues[option]);\n    if (wasValueSetOnCLI) {\n      log.debug(`Favoring CLI: ${option}=${argv[option]} over ` +\n        `configuration: ${option}=${configObject[option]}`);\n      continue;\n    }\n\n    if (!argv.hasOwnProperty(decamelize(option, '-'))) {\n      throw new UsageError(`The config file at ${configFileName} specified ` +\n        `an unknown option: \"${option}\"`);\n    }\n\n    newArgv[option] = configObject[option];\n  }\n  return newArgv;\n}\n\nexport function loadJSConfigFile(filePath: string): Object {\n  const resolvedFilePath = path.resolve(filePath);\n  log.debug(\n    `Loading JS config file: \"${filePath}\" ` +\n    `(resolved to \"${resolvedFilePath}\")`);\n  let configObject;\n  try {\n    configObject = requireUncached(resolvedFilePath);\n  } catch (error) {\n    log.debug('Handling error:', error);\n    throw new UsageError(\n      `Cannot read config file: ${resolvedFilePath}\\n` +\n      `Error: ${error.message}`);\n  }\n  if (Object.keys(configObject).length === 0) {\n    log.debug(`Config file ${resolvedFilePath} did not define any options. ` +\n      'Did you set module.exports = {...}?');\n  }\n  return configObject;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","module.exports = require(\"require-uncached\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"require-uncached\"\n// module id = 190\n// module chunks = 0","module.exports = require(\"decamelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"decamelize\"\n// module id = 191\n// module chunks = 0","/* @flow */\nimport {describe, it} from 'mocha';\nimport {assert} from 'chai';\n\nimport {\n  onlyErrorsWithCode, isErrorWithCode, onlyInstancesOf,\n} from '../../src/errors';\nimport {makeSureItFails, ErrorWithCode} from './helpers';\n\n\ndescribe('errors', () => {\n\n  describe('onlyInstancesOf', () => {\n\n    it('lets you catch a certain error', () => {\n      return Promise.reject(new SyntaxError('simulated error'))\n        .catch(onlyInstancesOf(SyntaxError, (error) => {\n          assert.instanceOf(error, SyntaxError);\n        }));\n    });\n\n    it('throws instances of other errors', () => {\n      return Promise.reject(new SyntaxError('simulated error'))\n        .catch(onlyInstancesOf(TypeError, () => {\n          throw new Error('Unexpectedly caught the wrong error');\n        }))\n        .then(makeSureItFails())\n        .catch((error) => {\n          assert.match(error.message, /simulated error/);\n        });\n    });\n\n  });\n\n  describe('onlyErrorsWithCode', () => {\n\n    class ErrorWithErrno extends Error {\n      errno: number;\n      constructor() {\n        super('pretend this is a system error');\n        this.errno = 53;\n      }\n    }\n\n    it('catches errors having a code', () => {\n      return Promise.reject(new ErrorWithCode())\n        .catch(onlyErrorsWithCode('SOME_CODE', (error) => {\n          assert.equal(error.code, 'SOME_CODE');\n        }));\n    });\n\n    it('catches errors having a error no', () => {\n      return Promise.reject(new ErrorWithErrno())\n        .catch(onlyErrorsWithCode(53, (error) => {\n          assert.equal(error.errno, 53);\n        }));\n    });\n\n    it('throws errors that do not match the code', () => {\n      return Promise.reject(new SyntaxError('simulated error'))\n        .catch(onlyErrorsWithCode('SOME_CODE', () => {\n          throw new Error('Unexpectedly caught the wrong error');\n        }))\n        .then(makeSureItFails())\n        .catch((error) => {\n          assert.match(error.message, /simulated error/);\n        });\n    });\n\n    it('catches errors having one of many codes', () => {\n      return Promise.reject(new ErrorWithCode())\n        .catch(onlyErrorsWithCode(['OTHER_CODE', 'SOME_CODE'], (error) => {\n          assert.equal(error.code, 'SOME_CODE');\n        }));\n    });\n\n    it('catches errors having one of many errno', () => {\n      return Promise.reject(new ErrorWithErrno())\n        .catch(onlyErrorsWithCode([34, 53], (error) => {\n          assert.equal(error.errno, 53);\n        }));\n    });\n\n    it('throws errors that are not in an array of codes', () => {\n      return Promise.reject(new ErrorWithCode())\n        .catch(onlyErrorsWithCode(['OTHER_CODE', 'ANOTHER_CODE'], () => {\n          throw new Error('Unexpectedly caught the wrong error');\n        }))\n        .then(makeSureItFails())\n        .catch((error) => {\n          assert.equal(error.code, 'SOME_CODE');\n        });\n    });\n\n  });\n\n  describe('isErrorWithCode', () => {\n\n    it('returns true on errors that do match the code', () => {\n      assert.equal(isErrorWithCode('SOME_CODE', new ErrorWithCode()), true);\n      assert.equal(\n        isErrorWithCode(['SOME_CODE', 'OTHER_CODE'], new ErrorWithCode()), true\n      );\n    });\n\n    it('returns false on errors that do not match the code', () => {\n      assert.equal(isErrorWithCode('OTHER_CODE', new ErrorWithCode()), false);\n      assert.equal(\n        isErrorWithCode(['OTHER_CODE', 'ANOTHER_CODE'], new ErrorWithCode()),\n        false\n      );\n      assert.equal(isErrorWithCode('ANY_CODE', new Error()), false);\n    });\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test.errors.js","/* @flow */\nimport path from 'path';\n\nimport {describe, it} from 'mocha';\nimport git from 'git-rev-sync';\nimport {fs} from 'mz';\nimport sinon, {spy} from 'sinon';\nimport {assert} from 'chai';\n\nimport {defaultVersionGetter, main, Program} from '../../src/program';\nimport commands from '../../src/cmd';\nimport {onlyInstancesOf, UsageError} from '../../src/errors';\nimport {fake, makeSureItFails, ErrorWithCode} from './helpers';\nimport {ConsoleStream} from '../../src/util/logger';\n\n\ndescribe('program.Program', () => {\n\n  function execProgram(program, options = {}) {\n    const fakeProcess = fake(process);\n    const absolutePackageDir = path.join(__dirname, '..', '..');\n    return program.execute(\n      absolutePackageDir, {\n        getVersion: () => spy(),\n        checkForUpdates: spy(),\n        systemProcess: fakeProcess,\n        shouldExitProgram: false,\n        ...options,\n      });\n  }\n\n  it('executes a command callback', () => {\n    const thing = spy(() => Promise.resolve());\n    const program = new Program(['thing'])\n      .command('thing', 'does a thing', thing);\n    return execProgram(program)\n      .then(() => {\n        assert.equal(thing.called, true);\n      });\n  });\n\n  it('reports unknown commands', () => {\n    const program = new Program(['thing']);\n    return execProgram(program)\n      .then(makeSureItFails())\n      .catch(onlyInstancesOf(UsageError, (error) => {\n        assert.match(error.message, /Unknown command: thing/);\n      }));\n  });\n\n  it('reports missing command', () => {\n    const program = new Program([]);\n    return execProgram(program)\n      .then(makeSureItFails())\n      .catch(onlyInstancesOf(UsageError, (error) => {\n        assert.match(error.message, /No sub-command was specified/);\n      }));\n  });\n\n  it('exits 1 on a thrown error', () => {\n    const fakeProcess = fake(process);\n    const program = new Program(['cmd'])\n      .command('cmd', 'some command', () => {\n        throw new Error('this is an error from a command handler');\n      });\n    return execProgram(program, {\n      systemProcess: fakeProcess,\n      shouldExitProgram: true,\n    })\n      .then(() => {\n        assert.equal(fakeProcess.exit.called, true);\n        assert.equal(fakeProcess.exit.firstCall.args[0], 1);\n      });\n  });\n\n  it('throws an error if sub-command is given an argument', () => {\n    const program = new Program(['thing', 'nope'])\n      .command('thing', '', () => {});\n    return execProgram(program)\n      .then(makeSureItFails())\n      .catch((error) => {\n        assert.match(error.message, /This command does not take any arguments/);\n      });\n  });\n\n  it('handles errors that have codes', () => {\n\n    const program = new Program(['cmd'])\n      .command('cmd', 'some command', () => {\n        const error = new ErrorWithCode();\n        throw error;\n      });\n    // This is just a smoke test to make sure the error code doesn't\n    // introduce an unexpected exception.\n    return execProgram(program)\n      .then(makeSureItFails())\n      .catch((error) => {\n        assert.match(error.message, /pretend this is a system error/);\n      });\n  });\n\n  it('lets commands define options', () => {\n    const handler = spy(() => Promise.resolve());\n    const program = new Program(['cmd'])\n      .command('cmd', 'some command', handler, {\n        'some-option': {\n          default: 'default value',\n        },\n      });\n    return execProgram(program)\n      .then(() => {\n        assert.equal(handler.called, true);\n        // This ensures that the default configuration for the option has\n        // been applied.\n        assert.equal(handler.firstCall.args[0].someOption, 'default value');\n      });\n  });\n\n  it('preserves global option configuration', () => {\n    const handler = spy(() => Promise.resolve());\n    const program = new Program(['cmd'])\n      .setGlobalOptions({\n        'global-option': {\n          type: 'string',\n          default: 'the default',\n        },\n      })\n      .command('cmd', 'some command', handler, {\n        'some-option': {\n          default: 'default value',\n        },\n      });\n    return execProgram(program)\n      .then(() => {\n        assert.equal(handler.called, true);\n        // By checking the global default, it ensures that default configuration\n        // will be applied to sub commands.\n        assert.equal(handler.firstCall.args[0].globalOption, 'the default');\n        assert.equal(handler.firstCall.args[0].someOption, 'default value');\n      });\n  });\n\n  it('reads option values from env vars in sub commands', () => {\n    // Set an env var that mimics web-ext cmd --some-opt=value\n    process.env.WEB_EXT_SOME_OPT = 'value';\n    let valueReceived;\n    const program = new Program(['cmd'])\n      .command('cmd', 'some command', ({someOpt}) => {\n        valueReceived = someOpt;\n      }, {\n        'some-opt': {\n          describe: 'example option',\n        },\n      });\n    return execProgram(program, {shouldExitProgram: true})\n      .then(() => {\n        assert.equal(valueReceived, 'value');\n        delete process.env.WEB_EXT_SOME_OPT;\n      });\n  });\n\n  it('configures the logger when verbose', () => {\n    const logStream = fake(new ConsoleStream());\n\n    const program = new Program(['--verbose', 'thing']);\n    program.setGlobalOptions({\n      verbose: {\n        type: 'boolean',\n      },\n    });\n    program.command('thing', 'does a thing', () => {});\n\n    return execProgram(program, {\n      getVersion: spy(),\n      logStream,\n    })\n      .then(() => {\n        assert.equal(logStream.makeVerbose.called, true);\n      });\n  });\n\n  it('checks the version when verbose', () => {\n    const version = spy();\n    const program = new Program(['--verbose', 'thing']);\n    program.setGlobalOptions({\n      verbose: {\n        type: 'boolean',\n      },\n    });\n    program.command('thing', 'does a thing', () => {});\n    return execProgram(program, {getVersion: version})\n      .then(() => {\n        assert.equal(version.firstCall.args[0],\n                     path.join(__dirname, '..', '..'));\n      });\n  });\n\n  it('does not configure the logger unless verbose', () => {\n    const logStream = fake(new ConsoleStream());\n    const program = new Program(['thing']).command('thing', '', () => {});\n    program.setGlobalOptions({\n      verbose: {\n        type: 'boolean',\n      },\n    });\n    return execProgram(program, {logStream})\n      .then(() => {\n        assert.equal(logStream.makeVerbose.called, false);\n      });\n  });\n\n  it('throws an error about unknown commands', () => {\n    return execProgram(new Program(['nope']))\n      .then(makeSureItFails())\n      .catch((error) => {\n        assert.match(error.message, /Unknown command: nope/);\n      });\n  });\n\n  it('throws an error about unknown options', () => {\n    return execProgram(new Program(['--nope']))\n      .then(makeSureItFails())\n      .catch((error) => {\n        // Make sure that the option name is in the error message.\n        // Be careful not to rely on any text from yargs since it's localized.\n        assert.match(error.message, /nope/);\n      });\n  });\n\n  it('throws an error about unknown sub-command options', () => {\n    const program = new Program(['thing', '--nope'])\n      .command('thing', '', () => {});\n    return execProgram(program)\n      .then(makeSureItFails())\n      .catch((error) => {\n        // Make sure that the option name is in the error message.\n        // Be careful not to rely on any text from yargs since it's localized.\n        assert.match(error.message, /nope/);\n      });\n  });\n\n  it('checks for updates automatically', () => {\n    const handler = spy();\n    const getVersion = () => 'some-package-version';\n    const checkForUpdates = sinon.stub();\n    const program = new Program(['run'])\n      .command('run', 'some command', handler);\n    return execProgram(program, {\n      checkForUpdates,\n      getVersion,\n      globalEnv: 'production',\n    })\n      .then(() => {\n        assert.equal(checkForUpdates.firstCall.args[0].version,\n                    'some-package-version');\n      });\n  });\n\n  it('does not check for updates during development', () => {\n    const handler = spy();\n    const getVersion = () => 'some-package-version';\n    const checkForUpdates = sinon.stub();\n    const program = new Program(['run'])\n      .command('run', 'some command', handler);\n    return execProgram(program, {\n      checkForUpdates,\n      getVersion,\n      globalEnv: 'development',\n    })\n      .then(() => {\n        assert.equal(checkForUpdates.called, false);\n      });\n  });\n});\n\n\ndescribe('program.main', () => {\n\n  function execProgram(argv, {projectRoot = '', ...mainOptions}: Object = {}) {\n    const runOptions = {\n      getVersion: () => 'not-a-real-version',\n      checkForUpdates: spy(),\n      shouldExitProgram: false,\n      systemProcess: fake(process),\n    };\n    return main(projectRoot, {argv, runOptions, ...mainOptions});\n  }\n\n  it('executes a command handler', () => {\n    const fakeCommands = fake(commands, {\n      build: () => Promise.resolve(),\n    });\n    return execProgram(['build'], {commands: fakeCommands})\n      .then(() => {\n        // This is a smoke test mainly to make sure main() configures\n        // options with handlers. It does not extensively test the\n        // configuration of all handlers.\n        assert.equal(fakeCommands.build.called, true);\n      });\n  });\n\n  it('throws an error if no command is given', () => {\n    const fakeCommands = fake(commands, {});\n    return execProgram([], {commands: fakeCommands})\n      .then(makeSureItFails())\n      .catch((error) => {\n        assert.match(error.message, /You must specify a command/);\n      });\n  });\n\n  it('can get the program version', () => {\n    const fakeVersionGetter = sinon.spy(() => '<version>');\n    const fakeCommands = fake(commands, {\n      build: () => Promise.resolve(),\n    });\n    const projectRoot = '/pretend/project/root';\n    // For some reason, executing --version like this\n    // requires a command. In the real CLI, it does not.\n    return execProgram(['--version', 'build'],\n      {\n        projectRoot,\n        commands: fakeCommands,\n        getVersion: fakeVersionGetter,\n      })\n      .then(() => {\n        assert.equal(fakeVersionGetter.called, true);\n        assert.equal(fakeVersionGetter.firstCall.args[0], projectRoot);\n      });\n  });\n\n  it('turns sourceDir into an absolute path', () => {\n    const fakeCommands = fake(commands, {\n      build: () => Promise.resolve(),\n    });\n    return execProgram(\n      ['build', '--source-dir', '..'], {commands: fakeCommands})\n      .then(() => {\n        assert.equal(fakeCommands.build.called, true);\n        assert.equal(fakeCommands.build.firstCall.args[0].sourceDir,\n                     path.resolve(path.join(process.cwd(), '..')));\n      });\n  });\n\n  it('normalizes the artifactsDir path', () => {\n    const fakeCommands = fake(commands, {\n      build: () => Promise.resolve(),\n    });\n    return execProgram(\n      // Add a double slash to the path, which will be fixed by normalization.\n      ['build', '--artifacts-dir', process.cwd() + path.sep + path.sep],\n      {commands: fakeCommands})\n      .then(() => {\n        assert.equal(fakeCommands.build.called, true);\n        assert.equal(fakeCommands.build.firstCall.args[0].artifactsDir,\n                     process.cwd() + path.sep);\n      });\n  });\n\n  it('passes the path of a firefox binary when specified', () => {\n    const fakeCommands = fake(commands, {\n      run: () => Promise.resolve(),\n    });\n    return execProgram(\n      ['run', '--firefox-binary', '/path/to/firefox-binary'],\n      {commands: fakeCommands})\n      .then(() => {\n        assert.equal(fakeCommands.run.called, true);\n        assert.equal(fakeCommands.run.firstCall.args[0].firefox,\n                     '/path/to/firefox-binary');\n      });\n  });\n\n  it('passes the url of a firefox binary when specified', () => {\n    const fakeCommands = fake(commands, {\n      run: () => Promise.resolve(),\n    });\n    return execProgram(\n      ['run', '--start-url', 'www.example.com'],\n      {commands: fakeCommands})\n      .then(() => {\n        assert.equal(fakeCommands.run.called, true);\n        assert.equal(fakeCommands.run.firstCall.args[0].startUrl,\n                     'www.example.com');\n      });\n  });\n\n  it('opens browser console when --browser-console is specified', () => {\n    const fakeCommands = fake(commands, {\n      run: () => Promise.resolve(),\n    });\n    return execProgram(\n      ['run', '--browser-console'],\n      {commands: fakeCommands})\n      .then(() => {\n        assert.equal(fakeCommands.run.called, true);\n        assert.equal(fakeCommands.run.firstCall.args[0].browserConsole,\n                     true);\n      });\n  });\n\n  it('converts custom preferences into an object', () => {\n    const fakeCommands = fake(commands, {\n      run: () => Promise.resolve(),\n    });\n    return execProgram(\n      ['run', '--pref', 'prop=true', '--pref', 'prop2=value2'],\n      {commands: fakeCommands})\n      .then(() => {\n        const {customPrefs} = fakeCommands.run.firstCall.args[0];\n        assert.isObject(customPrefs);\n        assert.equal(customPrefs.prop, true);\n        assert.equal(customPrefs.prop2, 'value2');\n      });\n  });\n});\n\ndescribe('program.defaultVersionGetter', () => {\n  const projectRoot = path.join(__dirname, '..', '..');\n\n  it('returns the package version in production', () => {\n    const pkgFile = path.join(projectRoot, 'package.json');\n    return fs.readFile(pkgFile)\n      .then((pkgData) => {\n        const testBuildEnv = {globalEnv: 'production'};\n        assert.equal(defaultVersionGetter(projectRoot, testBuildEnv),\n                   JSON.parse(pkgData).version);\n      });\n  });\n\n  it('returns git commit information in development', function() {\n    if (process.env.APPVEYOR) {\n      // Test skipped because of $APPVEYOR' issues with git-rev-sync (mozilla/web-ext#774)\n      this.skip();\n      return;\n    }\n    const commit = `${git.branch()}-${git.long()}`;\n    const testBuildEnv = {globalEnv: 'development'};\n    assert.equal(defaultVersionGetter(projectRoot, testBuildEnv),\n                 commit);\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test.program.js","/* @flow */\nimport {beforeEach, afterEach} from 'mocha';\n\nimport {consoleStream} from '../../src/util/logger';\n\nbeforeEach(function() {\n  consoleStream.makeVerbose();\n  consoleStream.startCapturing();\n});\n\nafterEach(function() {\n  if (this.currentTest.state !== 'passed') {\n    consoleStream.flushCapturedLogs();\n  }\n  consoleStream.stopCapturing();\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test.setup.js","/* @flow */\nimport path from 'path';\n\nimport {it, describe} from 'mocha';\nimport {fs} from 'mz';\nimport sinon from 'sinon';\nimport {assert} from 'chai';\n\nimport {default as onSourceChange, proxyFileChanges} from '../../src/watcher';\nimport {withTempDir} from '../../src/util/temp-dir';\n\n\ndescribe('watcher', () => {\n\n  it('watches for file changes', () => withTempDir(\n    (tmpDir) => {\n      const artifactsDir = path.join(tmpDir.path(), 'web-ext-artifacts');\n      const someFile = path.join(tmpDir.path(), 'foo.txt');\n\n      var resolveChange;\n      const whenFilesChanged = new Promise((resolve) => {\n        resolveChange = resolve;\n      });\n      const onChange = sinon.spy(() => {\n        resolveChange();\n      });\n\n      return fs.writeFile(someFile, '<contents>')\n        .then(() => {\n          return onSourceChange({\n            sourceDir: tmpDir.path(),\n            artifactsDir,\n            onChange,\n            shouldWatchFile: () => true,\n          });\n        })\n        .then((watcher) => {\n          return fs.utimes(someFile, Date.now() / 1000, Date.now() / 1000)\n            .then(() => watcher);\n        })\n        .then((watcher) => {\n          return whenFilesChanged\n            .then(() => {\n              watcher.close();\n              assert.equal(onChange.callCount, 1);\n              // This delay seems to avoid stat errors from the watcher\n              // which can happen when the temp dir is deleted (presumably\n              // before watcher.close() has removed all listeners).\n              return new Promise((resolve) => setTimeout(resolve, 2));\n            });\n        });\n    }\n  ));\n\n  describe('proxyFileChanges', () => {\n\n    const defaults = {\n      artifactsDir: '/some/artifacts/dir/',\n      onChange: () => {},\n      shouldWatchFile: () => true,\n    };\n\n    it('proxies file changes', () => {\n      const onChange = sinon.spy(() => {});\n      proxyFileChanges({\n        ...defaults,\n        filePath: '/some/file.js',\n        onChange,\n      });\n      assert.equal(onChange.called, true);\n    });\n\n    it('ignores changes to artifacts', () => {\n      const onChange = sinon.spy(() => {});\n      proxyFileChanges({\n        ...defaults,\n        filePath: '/some/artifacts/dir/build.xpi',\n        artifactsDir: '/some/artifacts/dir/',\n        onChange,\n      });\n      assert.equal(onChange.called, false);\n    });\n\n    it('provides a callback for ignoring files', () => {\n\n      function shouldWatchFile(filePath) {\n        if (filePath === '/somewhere/freaky') {\n          return false;\n        } else {\n          return true;\n        }\n      }\n\n      const conf = {\n        ...defaults,\n        shouldWatchFile,\n        onChange: sinon.spy(() => {}),\n      };\n\n      proxyFileChanges({...conf, filePath: '/somewhere/freaky'});\n      assert.equal(conf.onChange.called, false);\n\n      proxyFileChanges({...conf, filePath: '/any/file/'});\n      assert.equal(conf.onChange.called, true);\n\n    });\n\n  });\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./tests/unit/test.watcher.js"],"sourceRoot":""}